/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var df=Object.create;var Cn=Object.defineProperty;var ff=Object.getOwnPropertyDescriptor;var pf=Object.getOwnPropertyNames;var hf=Object.getPrototypeOf,mf=Object.prototype.hasOwnProperty;var gf=(n,e,t)=>e in n?Cn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var yf=(n,e)=>()=>(n&&(e=n(n=0)),e);var V=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),da=(n,e)=>{for(var t in e)Cn(n,t,{get:e[t],enumerable:!0})},fa=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of pf(e))!mf.call(n,r)&&r!==t&&Cn(n,r,{get:()=>e[r],enumerable:!(i=ff(e,r))||i.enumerable});return n};var Yr=(n,e,t)=>(t=n!=null?df(hf(n)):{},fa(e||!n||!n.__esModule?Cn(t,"default",{value:n,enumerable:!0}):t,n)),Kr=n=>fa(Cn({},"__esModule",{value:!0}),n);var ye=(n,e,t)=>gf(n,typeof e!="symbol"?e+"":e,t);var Jr={};da(Jr,{GEMINI_MODELS:()=>ke,getDefaultModelForRole:()=>ut,getUpdatedModelSettings:()=>En,setGeminiModels:()=>Df});function Df(n){ke.length=0,ke.push(...n)}function ut(n){let e=ke.find(t=>{var i;return(i=t.defaultForRoles)==null?void 0:i.includes(n)});if(e)return e.value;if(ke.length>0)return console.warn(`No default model specified for role '${n}'. Falling back to the first model in GEMINI_MODELS: ${ke[0].label}`),ke[0].value;throw console.error("CRITICAL: GEMINI_MODELS is empty. Cannot determine a fallback model."),new Error("CRITICAL: GEMINI_MODELS array is empty. Please configure available models.")}function En(n){let e=new Set(ke.map(o=>o.value)),t=!1,i=[],r={...n},s=o=>!(!o||e.has(o));if(s(r.chatModelName)){let o=ut("chat");o&&(i.push(`Chat model: '${r.chatModelName}' -> '${o}' (legacy model update)`),r.chatModelName=o,t=!0)}if(s(r.summaryModelName)){let o=ut("summary");o&&(i.push(`Summary model: '${r.summaryModelName}' -> '${o}' (legacy model update)`),r.summaryModelName=o,t=!0)}if(s(r.completionsModelName)){let o=ut("completions");o&&(i.push(`Completions model: '${r.completionsModelName}' -> '${o}' (legacy model update)`),r.completionsModelName=o,t=!0)}return{updatedSettings:r,settingsChanged:t,changedSettingsInfo:i}}var ke,Ct=yf(()=>{ke=[{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro",defaultForRoles:["chat"]},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash",defaultForRoles:["summary"]},{value:"gemini-2.5-flash-lite-preview-06-17",label:"Gemini 2.5 Flash Lite",defaultForRoles:["completions"]}]});var De=V(Te=>{"use strict";Te.__esModule=!0;Te.extend=vu;Te.indexOf=Ug;Te.escapeExpression=Hg;Te.isEmpty=qg;Te.createFrame=Wg;Te.blockParams=$g;Te.appendContextPath=zg;var Og={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},Bg=/[&<>"'`=]/g,Vg=/[&<>"'`=]/;function Gg(n){return Og[n]}function vu(n){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&(n[t]=arguments[e][t]);return n}var Ds=Object.prototype.toString;Te.toString=Ds;var ys=function(e){return typeof e=="function"};ys(/x/)&&(Te.isFunction=ys=function(n){return typeof n=="function"&&Ds.call(n)==="[object Function]"});Te.isFunction=ys;var Cu=Array.isArray||function(n){return n&&typeof n=="object"?Ds.call(n)==="[object Array]":!1};Te.isArray=Cu;function Ug(n,e){for(var t=0,i=n.length;t<i;t++)if(n[t]===e)return t;return-1}function Hg(n){if(typeof n!="string"){if(n&&n.toHTML)return n.toHTML();if(n==null)return"";if(!n)return n+"";n=""+n}return Vg.test(n)?n.replace(Bg,Gg):n}function qg(n){return!n&&n!==0?!0:!!(Cu(n)&&n.length===0)}function Wg(n){var e=vu({},n);return e._parent=n,e}function $g(n,e){return n.path=e,n}function zg(n,e){return(n?n+".":"")+e}});var Ie=V((xi,Eu)=>{"use strict";xi.__esModule=!0;var vs=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function Cs(n,e){var t=e&&e.loc,i=void 0,r=void 0,s=void 0,o=void 0;t&&(i=t.start.line,r=t.end.line,s=t.start.column,o=t.end.column,n+=" - "+i+":"+s);for(var a=Error.prototype.constructor.call(this,n),d=0;d<vs.length;d++)this[vs[d]]=a[vs[d]];Error.captureStackTrace&&Error.captureStackTrace(this,Cs);try{t&&(this.lineNumber=i,this.endLineNumber=r,Object.defineProperty?(Object.defineProperty(this,"column",{value:s,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:o,enumerable:!0})):(this.column=s,this.endColumn=o))}catch(c){}}Cs.prototype=new Error;xi.default=Cs;Eu.exports=xi.default});var Fu=V((Pi,wu)=>{"use strict";Pi.__esModule=!0;var Es=De();Pi.default=function(n){n.registerHelper("blockHelperMissing",function(e,t){var i=t.inverse,r=t.fn;if(e===!0)return r(this);if(e===!1||e==null)return i(this);if(Es.isArray(e))return e.length>0?(t.ids&&(t.ids=[t.name]),n.helpers.each(e,t)):i(this);if(t.data&&t.ids){var s=Es.createFrame(t.data);s.contextPath=Es.appendContextPath(t.data.contextPath,t.name),t={data:s}}return r(e,t)})};wu.exports=Pi.default});var Tu=V((ki,Su)=>{"use strict";ki.__esModule=!0;function Yg(n){return n&&n.__esModule?n:{default:n}}var Sn=De(),Kg=Ie(),Jg=Yg(Kg);ki.default=function(n){n.registerHelper("each",function(e,t){if(!t)throw new Jg.default("Must pass iterator to #each");var i=t.fn,r=t.inverse,s=0,o="",a=void 0,d=void 0;t.data&&t.ids&&(d=Sn.appendContextPath(t.data.contextPath,t.ids[0])+"."),Sn.isFunction(e)&&(e=e.call(this)),t.data&&(a=Sn.createFrame(t.data));function c(v,w,S){a&&(a.key=v,a.index=w,a.first=w===0,a.last=!!S,d&&(a.contextPath=d+v)),o=o+i(e[v],{data:a,blockParams:Sn.blockParams([e[v],v],[d+v,null])})}if(e&&typeof e=="object")if(Sn.isArray(e))for(var f=e.length;s<f;s++)s in e&&c(s,s,s===e.length-1);else if(typeof Symbol=="function"&&e[Symbol.iterator]){for(var p=[],h=e[Symbol.iterator](),g=h.next();!g.done;g=h.next())p.push(g.value);e=p;for(var f=e.length;s<f;s++)c(s,s,s===e.length-1)}else(function(){var v=void 0;Object.keys(e).forEach(function(w){v!==void 0&&c(v,s-1),v=w,s++}),v!==void 0&&c(v,s-1,!0)})();return s===0&&(o=r(this)),o})};Su.exports=ki.default});var _u=V((bi,Mu)=>{"use strict";bi.__esModule=!0;function Zg(n){return n&&n.__esModule?n:{default:n}}var Qg=Ie(),Xg=Zg(Qg);bi.default=function(n){n.registerHelper("helperMissing",function(){if(arguments.length!==1)throw new Xg.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})};Mu.exports=bi.default});var bu=V((Ii,ku)=>{"use strict";Ii.__esModule=!0;function jg(n){return n&&n.__esModule?n:{default:n}}var xu=De(),ey=Ie(),Pu=jg(ey);Ii.default=function(n){n.registerHelper("if",function(e,t){if(arguments.length!=2)throw new Pu.default("#if requires exactly one argument");return xu.isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||xu.isEmpty(e)?t.inverse(this):t.fn(this)}),n.registerHelper("unless",function(e,t){if(arguments.length!=2)throw new Pu.default("#unless requires exactly one argument");return n.helpers.if.call(this,e,{fn:t.inverse,inverse:t.fn,hash:t.hash})})};ku.exports=Ii.default});var Au=V((Ai,Iu)=>{"use strict";Ai.__esModule=!0;Ai.default=function(n){n.registerHelper("log",function(){for(var e=[void 0],t=arguments[arguments.length-1],i=0;i<arguments.length-1;i++)e.push(arguments[i]);var r=1;t.hash.level!=null?r=t.hash.level:t.data&&t.data.level!=null&&(r=t.data.level),e[0]=r,n.log.apply(n,e)})};Iu.exports=Ai.default});var Ru=V((Ni,Nu)=>{"use strict";Ni.__esModule=!0;Ni.default=function(n){n.registerHelper("lookup",function(e,t,i){return e&&i.lookupProperty(e,t)})};Nu.exports=Ni.default});var Ou=V((Ri,Lu)=>{"use strict";Ri.__esModule=!0;function ty(n){return n&&n.__esModule?n:{default:n}}var Tn=De(),ny=Ie(),iy=ty(ny);Ri.default=function(n){n.registerHelper("with",function(e,t){if(arguments.length!=2)throw new iy.default("#with requires exactly one argument");Tn.isFunction(e)&&(e=e.call(this));var i=t.fn;if(Tn.isEmpty(e))return t.inverse(this);var r=t.data;return t.data&&t.ids&&(r=Tn.createFrame(t.data),r.contextPath=Tn.appendContextPath(t.data.contextPath,t.ids[0])),i(e,{data:r,blockParams:Tn.blockParams([e],[r&&r.contextPath])})})};Lu.exports=Ri.default});var ws=V(Li=>{"use strict";Li.__esModule=!0;Li.registerDefaultHelpers=Dy;Li.moveHelperToHooks=vy;function Et(n){return n&&n.__esModule?n:{default:n}}var ry=Fu(),sy=Et(ry),oy=Tu(),ay=Et(oy),uy=_u(),ly=Et(uy),cy=bu(),dy=Et(cy),fy=Au(),py=Et(fy),hy=Ru(),my=Et(hy),gy=Ou(),yy=Et(gy);function Dy(n){sy.default(n),ay.default(n),ly.default(n),dy.default(n),py.default(n),my.default(n),yy.default(n)}function vy(n,e,t){n.helpers[e]&&(n.hooks[e]=n.helpers[e],t||delete n.helpers[e])}});var Vu=V((Oi,Bu)=>{"use strict";Oi.__esModule=!0;var Cy=De();Oi.default=function(n){n.registerDecorator("inline",function(e,t,i,r){var s=e;return t.partials||(t.partials={},s=function(o,a){var d=i.partials;i.partials=Cy.extend({},d,t.partials);var c=e(o,a);return i.partials=d,c}),t.partials[r.args[0]]=r.fn,s})};Bu.exports=Oi.default});var Gu=V(Fs=>{"use strict";Fs.__esModule=!0;Fs.registerDefaultDecorators=Sy;function Ey(n){return n&&n.__esModule?n:{default:n}}var wy=Vu(),Fy=Ey(wy);function Sy(n){Fy.default(n)}});var Ss=V((Bi,Uu)=>{"use strict";Bi.__esModule=!0;var Ty=De(),Wt={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if(typeof e=="string"){var t=Ty.indexOf(Wt.methodMap,e.toLowerCase());t>=0?e=t:e=parseInt(e,10)}return e},log:function(e){if(e=Wt.lookupLevel(e),typeof console!="undefined"&&Wt.lookupLevel(Wt.level)<=e){var t=Wt.methodMap[e];console[t]||(t="log");for(var i=arguments.length,r=Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];console[t].apply(console,r)}}};Bi.default=Wt;Uu.exports=Bi.default});var Hu=V(Ts=>{"use strict";Ts.__esModule=!0;Ts.createNewLookupObject=_y;var My=De();function _y(){for(var n=arguments.length,e=Array(n),t=0;t<n;t++)e[t]=arguments[t];return My.extend.apply(void 0,[Object.create(null)].concat(e))}});var Ms=V(Mn=>{"use strict";Mn.__esModule=!0;Mn.createProtoAccessControl=by;Mn.resultIsAllowed=Iy;Mn.resetLoggedProperties=Ny;function xy(n){return n&&n.__esModule?n:{default:n}}var qu=Hu(),Py=Ss(),ky=xy(Py),Vi=Object.create(null);function by(n){var e=Object.create(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var t=Object.create(null);return t.__proto__=!1,{properties:{whitelist:qu.createNewLookupObject(t,n.allowedProtoProperties),defaultValue:n.allowProtoPropertiesByDefault},methods:{whitelist:qu.createNewLookupObject(e,n.allowedProtoMethods),defaultValue:n.allowProtoMethodsByDefault}}}function Iy(n,e,t){return Wu(typeof n=="function"?e.methods:e.properties,t)}function Wu(n,e){return n.whitelist[e]!==void 0?n.whitelist[e]===!0:n.defaultValue!==void 0?n.defaultValue:(Ay(e),!1)}function Ay(n){Vi[n]!==!0&&(Vi[n]=!0,ky.default.log("error",'Handlebars: Access has been denied to resolve the property "'+n+`" because it is not an "own property" of its parent.
You can add a runtime option to disable the check or this warning:
See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details`))}function Ny(){Object.keys(Vi).forEach(function(n){delete Vi[n]})}});var Ui=V(ze=>{"use strict";ze.__esModule=!0;ze.HandlebarsEnvironment=Ps;function $u(n){return n&&n.__esModule?n:{default:n}}var wt=De(),Ry=Ie(),_s=$u(Ry),Ly=ws(),Oy=Gu(),By=Ss(),Gi=$u(By),Vy=Ms(),Gy="4.7.8";ze.VERSION=Gy;var Uy=8;ze.COMPILER_REVISION=Uy;var Hy=7;ze.LAST_COMPATIBLE_COMPILER_REVISION=Hy;var qy={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};ze.REVISION_CHANGES=qy;var xs="[object Object]";function Ps(n,e,t){this.helpers=n||{},this.partials=e||{},this.decorators=t||{},Ly.registerDefaultHelpers(this),Oy.registerDefaultDecorators(this)}Ps.prototype={constructor:Ps,logger:Gi.default,log:Gi.default.log,registerHelper:function(e,t){if(wt.toString.call(e)===xs){if(t)throw new _s.default("Arg not supported with multiple helpers");wt.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(wt.toString.call(e)===xs)wt.extend(this.partials,e);else{if(typeof t=="undefined")throw new _s.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,t){if(wt.toString.call(e)===xs){if(t)throw new _s.default("Arg not supported with multiple decorators");wt.extend(this.decorators,e)}else this.decorators[e]=t},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){Vy.resetLoggedProperties()}};var Wy=Gi.default.log;ze.log=Wy;ze.createFrame=wt.createFrame;ze.logger=Gi.default});var Yu=V((Hi,zu)=>{"use strict";Hi.__esModule=!0;function ks(n){this.string=n}ks.prototype.toString=ks.prototype.toHTML=function(){return""+this.string};Hi.default=ks;zu.exports=Hi.default});var Ku=V(bs=>{"use strict";bs.__esModule=!0;bs.wrapHelper=$y;function $y(n,e){if(typeof n!="function")return n;var t=function(){var r=arguments[arguments.length-1];return arguments[arguments.length-1]=e(r),n.apply(this,arguments)};return t}});var ju=V(dt=>{"use strict";dt.__esModule=!0;dt.checkRevision=Qy;dt.template=Xy;dt.wrapProgram=qi;dt.resolvePartial=jy;dt.invokePartial=eD;dt.noop=Qu;function zy(n){return n&&n.__esModule?n:{default:n}}function Yy(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}var Ky=De(),tt=Yy(Ky),Jy=Ie(),nt=zy(Jy),it=Ui(),Ju=ws(),Zy=Ku(),Zu=Ms();function Qy(n){var e=n&&n[0]||1,t=it.COMPILER_REVISION;if(!(e>=it.LAST_COMPATIBLE_COMPILER_REVISION&&e<=it.COMPILER_REVISION))if(e<it.LAST_COMPATIBLE_COMPILER_REVISION){var i=it.REVISION_CHANGES[t],r=it.REVISION_CHANGES[e];throw new nt.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+r+").")}else throw new nt.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+n[1]+").")}function Xy(n,e){if(!e)throw new nt.default("No environment passed to template");if(!n||!n.main)throw new nt.default("Unknown template object: "+typeof n);n.main.decorator=n.main_d,e.VM.checkRevision(n.compiler);var t=n.compiler&&n.compiler[0]===7;function i(o,a,d){d.hash&&(a=tt.extend({},a,d.hash),d.ids&&(d.ids[0]=!0)),o=e.VM.resolvePartial.call(this,o,a,d);var c=tt.extend({},d,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),f=e.VM.invokePartial.call(this,o,a,c);if(f==null&&e.compile&&(d.partials[d.name]=e.compile(o,n.compilerOptions,e),f=d.partials[d.name](a,c)),f!=null){if(d.indent){for(var p=f.split(`
`),h=0,g=p.length;h<g&&!(!p[h]&&h+1===g);h++)p[h]=d.indent+p[h];f=p.join(`
`)}return f}else throw new nt.default("The partial "+d.name+" could not be compiled when running in runtime-only mode")}var r={strict:function(a,d,c){if(!a||!(d in a))throw new nt.default('"'+d+'" not defined in '+a,{loc:c});return r.lookupProperty(a,d)},lookupProperty:function(a,d){var c=a[d];if(c==null||Object.prototype.hasOwnProperty.call(a,d)||Zu.resultIsAllowed(c,r.protoAccessControl,d))return c},lookup:function(a,d){for(var c=a.length,f=0;f<c;f++){var p=a[f]&&r.lookupProperty(a[f],d);if(p!=null)return a[f][d]}},lambda:function(a,d){return typeof a=="function"?a.call(d):a},escapeExpression:tt.escapeExpression,invokePartial:i,fn:function(a){var d=n[a];return d.decorator=n[a+"_d"],d},programs:[],program:function(a,d,c,f,p){var h=this.programs[a],g=this.fn(a);return d||p||f||c?h=qi(this,a,g,d,c,f,p):h||(h=this.programs[a]=qi(this,a,g)),h},data:function(a,d){for(;a&&d--;)a=a._parent;return a},mergeIfNeeded:function(a,d){var c=a||d;return a&&d&&a!==d&&(c=tt.extend({},d,a)),c},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:n.compiler};function s(o){var a=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],d=a.data;s._setup(a),!a.partial&&n.useData&&(d=tD(o,d));var c=void 0,f=n.useBlockParams?[]:void 0;n.useDepths&&(a.depths?c=o!=a.depths[0]?[o].concat(a.depths):a.depths:c=[o]);function p(h){return""+n.main(r,h,r.helpers,r.partials,d,f,c)}return p=Xu(n.main,p,r,a.depths||[],d,f),p(o,a)}return s.isTop=!0,s._setup=function(o){if(o.partial)r.protoAccessControl=o.protoAccessControl,r.helpers=o.helpers,r.partials=o.partials,r.decorators=o.decorators,r.hooks=o.hooks;else{var a=tt.extend({},e.helpers,o.helpers);nD(a,r),r.helpers=a,n.usePartial&&(r.partials=r.mergeIfNeeded(o.partials,e.partials)),(n.usePartial||n.useDecorators)&&(r.decorators=tt.extend({},e.decorators,o.decorators)),r.hooks={},r.protoAccessControl=Zu.createProtoAccessControl(o);var d=o.allowCallsToHelperMissing||t;Ju.moveHelperToHooks(r,"helperMissing",d),Ju.moveHelperToHooks(r,"blockHelperMissing",d)}},s._child=function(o,a,d,c){if(n.useBlockParams&&!d)throw new nt.default("must pass block params");if(n.useDepths&&!c)throw new nt.default("must pass parent depths");return qi(r,o,n[o],a,0,d,c)},s}function qi(n,e,t,i,r,s,o){function a(d){var c=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],f=o;return o&&d!=o[0]&&!(d===n.nullContext&&o[0]===null)&&(f=[d].concat(o)),t(n,d,n.helpers,n.partials,c.data||i,s&&[c.blockParams].concat(s),f)}return a=Xu(t,a,n,o,i,s),a.program=e,a.depth=o?o.length:0,a.blockParams=r||0,a}function jy(n,e,t){return n?!n.call&&!t.name&&(t.name=n,n=t.partials[n]):t.name==="@partial-block"?n=t.data["partial-block"]:n=t.partials[t.name],n}function eD(n,e,t){var i=t.data&&t.data["partial-block"];t.partial=!0,t.ids&&(t.data.contextPath=t.ids[0]||t.data.contextPath);var r=void 0;if(t.fn&&t.fn!==Qu&&function(){t.data=it.createFrame(t.data);var s=t.fn;r=t.data["partial-block"]=function(a){var d=arguments.length<=1||arguments[1]===void 0?{}:arguments[1];return d.data=it.createFrame(d.data),d.data["partial-block"]=i,s(a,d)},s.partials&&(t.partials=tt.extend({},t.partials,s.partials))}(),n===void 0&&r&&(n=r),n===void 0)throw new nt.default("The partial "+t.name+" could not be found");if(n instanceof Function)return n(e,t)}function Qu(){return""}function tD(n,e){return(!e||!("root"in e))&&(e=e?it.createFrame(e):{},e.root=n),e}function Xu(n,e,t,i,r,s){if(n.decorator){var o={};e=n.decorator(e,o,t,i&&i[0],r,s,i),tt.extend(e,o)}return e}function nD(n,e){Object.keys(n).forEach(function(t){var i=n[t];n[t]=iD(i,e)})}function iD(n,e){var t=e.lookupProperty;return Zy.wrapHelper(n,function(i){return tt.extend({lookupProperty:t},i)})}});var Is=V((Wi,el)=>{"use strict";Wi.__esModule=!0;Wi.default=function(n){(function(){typeof globalThis!="object"&&(Object.prototype.__defineGetter__("__magic__",function(){return this}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var e=globalThis.Handlebars;n.noConflict=function(){return globalThis.Handlebars===n&&(globalThis.Handlebars=e),n}};el.exports=Wi.default});var sl=V(($i,rl)=>{"use strict";$i.__esModule=!0;function Ns(n){return n&&n.__esModule?n:{default:n}}function Rs(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}var rD=Ui(),tl=Rs(rD),sD=Yu(),oD=Ns(sD),aD=Ie(),uD=Ns(aD),lD=De(),As=Rs(lD),cD=ju(),nl=Rs(cD),dD=Is(),fD=Ns(dD);function il(){var n=new tl.HandlebarsEnvironment;return As.extend(n,tl),n.SafeString=oD.default,n.Exception=uD.default,n.Utils=As,n.escapeExpression=As.escapeExpression,n.VM=nl,n.template=function(e){return nl.template(e,n)},n}var _n=il();_n.create=il;fD.default(_n);_n.default=_n;$i.default=_n;rl.exports=$i.default});var Ls=V((zi,al)=>{"use strict";zi.__esModule=!0;var ol={helpers:{helperExpression:function(e){return e.type==="SubExpression"||(e.type==="MustacheStatement"||e.type==="BlockStatement")&&!!(e.params&&e.params.length||e.hash)},scopedId:function(e){return/^\.|this\b/.test(e.original)},simpleId:function(e){return e.parts.length===1&&!ol.helpers.scopedId(e)&&!e.depth}}};zi.default=ol;al.exports=zi.default});var ll=V((Yi,ul)=>{"use strict";Yi.__esModule=!0;var pD=function(){var n={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(r,s,o,a,d,c,f){var p=c.length-1;switch(d){case 1:return c[p-1];case 2:this.$=a.prepareProgram(c[p]);break;case 3:this.$=c[p];break;case 4:this.$=c[p];break;case 5:this.$=c[p];break;case 6:this.$=c[p];break;case 7:this.$=c[p];break;case 8:this.$=c[p];break;case 9:this.$={type:"CommentStatement",value:a.stripComment(c[p]),strip:a.stripFlags(c[p],c[p]),loc:a.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:c[p],value:c[p],loc:a.locInfo(this._$)};break;case 11:this.$=a.prepareRawBlock(c[p-2],c[p-1],c[p],this._$);break;case 12:this.$={path:c[p-3],params:c[p-2],hash:c[p-1]};break;case 13:this.$=a.prepareBlock(c[p-3],c[p-2],c[p-1],c[p],!1,this._$);break;case 14:this.$=a.prepareBlock(c[p-3],c[p-2],c[p-1],c[p],!0,this._$);break;case 15:this.$={open:c[p-5],path:c[p-4],params:c[p-3],hash:c[p-2],blockParams:c[p-1],strip:a.stripFlags(c[p-5],c[p])};break;case 16:this.$={path:c[p-4],params:c[p-3],hash:c[p-2],blockParams:c[p-1],strip:a.stripFlags(c[p-5],c[p])};break;case 17:this.$={path:c[p-4],params:c[p-3],hash:c[p-2],blockParams:c[p-1],strip:a.stripFlags(c[p-5],c[p])};break;case 18:this.$={strip:a.stripFlags(c[p-1],c[p-1]),program:c[p]};break;case 19:var h=a.prepareBlock(c[p-2],c[p-1],c[p],c[p],!1,this._$),g=a.prepareProgram([h],c[p-1].loc);g.chained=!0,this.$={strip:c[p-2].strip,program:g,chain:!0};break;case 20:this.$=c[p];break;case 21:this.$={path:c[p-1],strip:a.stripFlags(c[p-2],c[p])};break;case 22:this.$=a.prepareMustache(c[p-3],c[p-2],c[p-1],c[p-4],a.stripFlags(c[p-4],c[p]),this._$);break;case 23:this.$=a.prepareMustache(c[p-3],c[p-2],c[p-1],c[p-4],a.stripFlags(c[p-4],c[p]),this._$);break;case 24:this.$={type:"PartialStatement",name:c[p-3],params:c[p-2],hash:c[p-1],indent:"",strip:a.stripFlags(c[p-4],c[p]),loc:a.locInfo(this._$)};break;case 25:this.$=a.preparePartialBlock(c[p-2],c[p-1],c[p],this._$);break;case 26:this.$={path:c[p-3],params:c[p-2],hash:c[p-1],strip:a.stripFlags(c[p-4],c[p])};break;case 27:this.$=c[p];break;case 28:this.$=c[p];break;case 29:this.$={type:"SubExpression",path:c[p-3],params:c[p-2],hash:c[p-1],loc:a.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:c[p],loc:a.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:a.id(c[p-2]),value:c[p],loc:a.locInfo(this._$)};break;case 32:this.$=a.id(c[p-1]);break;case 33:this.$=c[p];break;case 34:this.$=c[p];break;case 35:this.$={type:"StringLiteral",value:c[p],original:c[p],loc:a.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(c[p]),original:Number(c[p]),loc:a.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:c[p]==="true",original:c[p]==="true",loc:a.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:a.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:a.locInfo(this._$)};break;case 40:this.$=c[p];break;case 41:this.$=c[p];break;case 42:this.$=a.preparePath(!0,c[p],this._$);break;case 43:this.$=a.preparePath(!1,c[p],this._$);break;case 44:c[p-2].push({part:a.id(c[p]),original:c[p],separator:c[p-1]}),this.$=c[p-2];break;case 45:this.$=[{part:a.id(c[p]),original:c[p]}];break;case 46:this.$=[];break;case 47:c[p-1].push(c[p]);break;case 48:this.$=[];break;case 49:c[p-1].push(c[p]);break;case 50:this.$=[];break;case 51:c[p-1].push(c[p]);break;case 58:this.$=[];break;case 59:c[p-1].push(c[p]);break;case 64:this.$=[];break;case 65:c[p-1].push(c[p]);break;case 70:this.$=[];break;case 71:c[p-1].push(c[p]);break;case 78:this.$=[];break;case 79:c[p-1].push(c[p]);break;case 82:this.$=[];break;case 83:c[p-1].push(c[p]);break;case 86:this.$=[];break;case 87:c[p-1].push(c[p]);break;case 90:this.$=[];break;case 91:c[p-1].push(c[p]);break;case 94:this.$=[];break;case 95:c[p-1].push(c[p]);break;case 98:this.$=[c[p]];break;case 99:c[p-1].push(c[p]);break;case 100:this.$=[c[p]];break;case 101:c[p-1].push(c[p]);break}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(r,s){throw new Error(r)},parse:function(r){var s=this,o=[0],a=[null],d=[],c=this.table,f="",p=0,h=0,g=0,v=2,w=1;this.lexer.setInput(r),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var S=this.lexer.yylloc;d.push(S);var x=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);function I(ne){o.length=o.length-2*ne,a.length=a.length-ne,d.length=d.length-ne}function L(){var ne;return ne=s.lexer.lex()||1,typeof ne!="number"&&(ne=s.symbols_[ne]||ne),ne}for(var C,P,O,T,N,$,te={},le,K,Fe,ae;;){if(O=o[o.length-1],this.defaultActions[O]?T=this.defaultActions[O]:((C===null||typeof C=="undefined")&&(C=L()),T=c[O]&&c[O][C]),typeof T=="undefined"||!T.length||!T[0]){var ve="";if(!g){ae=[];for(le in c[O])this.terminals_[le]&&le>2&&ae.push("'"+this.terminals_[le]+"'");this.lexer.showPosition?ve="Parse error on line "+(p+1)+`:
`+this.lexer.showPosition()+`
Expecting `+ae.join(", ")+", got '"+(this.terminals_[C]||C)+"'":ve="Parse error on line "+(p+1)+": Unexpected "+(C==1?"end of input":"'"+(this.terminals_[C]||C)+"'"),this.parseError(ve,{text:this.lexer.match,token:this.terminals_[C]||C,line:this.lexer.yylineno,loc:S,expected:ae})}}if(T[0]instanceof Array&&T.length>1)throw new Error("Parse Error: multiple actions possible at state: "+O+", token: "+C);switch(T[0]){case 1:o.push(C),a.push(this.lexer.yytext),d.push(this.lexer.yylloc),o.push(T[1]),C=null,P?(C=P,P=null):(h=this.lexer.yyleng,f=this.lexer.yytext,p=this.lexer.yylineno,S=this.lexer.yylloc,g>0&&g--);break;case 2:if(K=this.productions_[T[1]][1],te.$=a[a.length-K],te._$={first_line:d[d.length-(K||1)].first_line,last_line:d[d.length-1].last_line,first_column:d[d.length-(K||1)].first_column,last_column:d[d.length-1].last_column},x&&(te._$.range=[d[d.length-(K||1)].range[0],d[d.length-1].range[1]]),$=this.performAction.call(te,f,h,p,this.yy,T[1],a,d),typeof $!="undefined")return $;K&&(o=o.slice(0,-1*K*2),a=a.slice(0,-1*K),d=d.slice(0,-1*K)),o.push(this.productions_[T[1]][0]),a.push(te.$),d.push(te._$),Fe=c[o[o.length-2]][o[o.length-1]],o.push(Fe);break;case 3:return!0}}return!0}},e=function(){var i={EOF:1,parseError:function(s,o){if(this.yy.parser)this.yy.parser.parseError(s,o);else throw new Error(s)},setInput:function(s){return this._input=s,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var s=this._input[0];this.yytext+=s,this.yyleng++,this.offset++,this.match+=s,this.matched+=s;var o=s.match(/(?:\r\n?|\n).*/g);return o?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),s},unput:function(s){var o=s.length,a=s.split(/(?:\r\n?|\n)/g);this._input=s+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-o-1),this.offset-=o;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),a.length-1&&(this.yylineno-=a.length-1);var c=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:a?(a.length===d.length?this.yylloc.first_column:0)+d[d.length-a.length].length-a[0].length:this.yylloc.first_column-o},this.options.ranges&&(this.yylloc.range=[c[0],c[0]+this.yyleng-o]),this},more:function(){return this._more=!0,this},less:function(s){this.unput(this.match.slice(s))},pastInput:function(){var s=this.matched.substr(0,this.matched.length-this.match.length);return(s.length>20?"...":"")+s.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var s=this.match;return s.length<20&&(s+=this._input.substr(0,20-s.length)),(s.substr(0,20)+(s.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var s=this.pastInput(),o=new Array(s.length+1).join("-");return s+this.upcomingInput()+`
`+o+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var s,o,a,d,c,f;this._more||(this.yytext="",this.match="");for(var p=this._currentRules(),h=0;h<p.length&&(a=this._input.match(this.rules[p[h]]),!(a&&(!o||a[0].length>o[0].length)&&(o=a,d=h,!this.options.flex)));h++);return o?(f=o[0].match(/(?:\r\n?|\n).*/g),f&&(this.yylineno+=f.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:f?f[f.length-1].length-f[f.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+o[0].length},this.yytext+=o[0],this.match+=o[0],this.matches=o,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(o[0].length),this.matched+=o[0],s=this.performAction.call(this,this.yy,this,p[d],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),s||void 0):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var s=this.next();return typeof s!="undefined"?s:this.lex()},begin:function(s){this.conditionStack.push(s)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(s){this.begin(s)}};return i.options={},i.performAction=function(s,o,a,d){function c(p,h){return o.yytext=o.yytext.substring(p,o.yyleng-h+p)}var f=d;switch(a){case 0:if(o.yytext.slice(-2)==="\\\\"?(c(0,1),this.begin("mu")):o.yytext.slice(-1)==="\\"?(c(0,1),this.begin("emu")):this.begin("mu"),o.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;break;case 3:return this.begin("raw"),15;break;case 4:return this.popState(),this.conditionStack[this.conditionStack.length-1]==="raw"?15:(c(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;break;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;break;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;break;case 16:return this.popState(),44;break;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(o.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;break;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;break;case 30:return this.popState(),33;break;case 31:return o.yytext=c(1,2).replace(/\\"/g,'"'),80;break;case 32:return o.yytext=c(1,2).replace(/\\'/g,"'"),80;break;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return o.yytext=o.yytext.replace(/\\([\\\]])/g,"$1"),72;break;case 43:return"INVALID";case 44:return 5}},i.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],i.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},i}();n.lexer=e;function t(){this.yy={}}return t.prototype=n,n.Parser=t,new t}();Yi.default=pD;ul.exports=Yi.default});var Bs=V((Zi,fl)=>{"use strict";Zi.__esModule=!0;function hD(n){return n&&n.__esModule?n:{default:n}}var mD=Ie(),Os=hD(mD);function Ki(){this.parents=[]}Ki.prototype={constructor:Ki,mutating:!1,acceptKey:function(e,t){var i=this.accept(e[t]);if(this.mutating){if(i&&!Ki.prototype[i.type])throw new Os.default('Unexpected node type "'+i.type+'" found when accepting '+t+" on "+e.type);e[t]=i}},acceptRequired:function(e,t){if(this.acceptKey(e,t),!e[t])throw new Os.default(e.type+" requires "+t)},acceptArray:function(e){for(var t=0,i=e.length;t<i;t++)this.acceptKey(e,t),e[t]||(e.splice(t,1),t--,i--)},accept:function(e){if(e){if(!this[e.type])throw new Os.default("Unknown type: "+e.type,e);this.current&&this.parents.unshift(this.current),this.current=e;var t=this[e.type](e);if(this.current=this.parents.shift(),!this.mutating||t)return t;if(t!==!1)return e}},Program:function(e){this.acceptArray(e.body)},MustacheStatement:Ji,Decorator:Ji,BlockStatement:cl,DecoratorBlock:cl,PartialStatement:dl,PartialBlockStatement:function(e){dl.call(this,e),this.acceptKey(e,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:Ji,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(e){this.acceptArray(e.pairs)},HashPair:function(e){this.acceptRequired(e,"value")}};function Ji(n){this.acceptRequired(n,"path"),this.acceptArray(n.params),this.acceptKey(n,"hash")}function cl(n){Ji.call(this,n),this.acceptKey(n,"program"),this.acceptKey(n,"inverse")}function dl(n){this.acceptRequired(n,"name"),this.acceptArray(n.params),this.acceptKey(n,"hash")}Zi.default=Ki;fl.exports=Zi.default});var hl=V((Qi,pl)=>{"use strict";Qi.__esModule=!0;function gD(n){return n&&n.__esModule?n:{default:n}}var yD=Bs(),DD=gD(yD);function Ye(){var n=arguments.length<=0||arguments[0]===void 0?{}:arguments[0];this.options=n}Ye.prototype=new DD.default;Ye.prototype.Program=function(n){var e=!this.options.ignoreStandalone,t=!this.isRootSeen;this.isRootSeen=!0;for(var i=n.body,r=0,s=i.length;r<s;r++){var o=i[r],a=this.accept(o);if(a){var d=Vs(i,r,t),c=Gs(i,r,t),f=a.openStandalone&&d,p=a.closeStandalone&&c,h=a.inlineStandalone&&d&&c;a.close&&Ft(i,r,!0),a.open&&ft(i,r,!0),e&&h&&(Ft(i,r),ft(i,r)&&o.type==="PartialStatement"&&(o.indent=/([ \t]+$)/.exec(i[r-1].original)[1])),e&&f&&(Ft((o.program||o.inverse).body),ft(i,r)),e&&p&&(Ft(i,r),ft((o.inverse||o.program).body))}}return n};Ye.prototype.BlockStatement=Ye.prototype.DecoratorBlock=Ye.prototype.PartialBlockStatement=function(n){this.accept(n.program),this.accept(n.inverse);var e=n.program||n.inverse,t=n.program&&n.inverse,i=t,r=t;if(t&&t.chained)for(i=t.body[0].program;r.chained;)r=r.body[r.body.length-1].program;var s={open:n.openStrip.open,close:n.closeStrip.close,openStandalone:Gs(e.body),closeStandalone:Vs((i||e).body)};if(n.openStrip.close&&Ft(e.body,null,!0),t){var o=n.inverseStrip;o.open&&ft(e.body,null,!0),o.close&&Ft(i.body,null,!0),n.closeStrip.open&&ft(r.body,null,!0),!this.options.ignoreStandalone&&Vs(e.body)&&Gs(i.body)&&(ft(e.body),Ft(i.body))}else n.closeStrip.open&&ft(e.body,null,!0);return s};Ye.prototype.Decorator=Ye.prototype.MustacheStatement=function(n){return n.strip};Ye.prototype.PartialStatement=Ye.prototype.CommentStatement=function(n){var e=n.strip||{};return{inlineStandalone:!0,open:e.open,close:e.close}};function Vs(n,e,t){e===void 0&&(e=n.length);var i=n[e-1],r=n[e-2];if(!i)return t;if(i.type==="ContentStatement")return(r||!t?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(i.original)}function Gs(n,e,t){e===void 0&&(e=-1);var i=n[e+1],r=n[e+2];if(!i)return t;if(i.type==="ContentStatement")return(r||!t?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(i.original)}function Ft(n,e,t){var i=n[e==null?0:e+1];if(!(!i||i.type!=="ContentStatement"||!t&&i.rightStripped)){var r=i.value;i.value=i.value.replace(t?/^\s+/:/^[ \t]*\r?\n?/,""),i.rightStripped=i.value!==r}}function ft(n,e,t){var i=n[e==null?n.length-1:e-1];if(!(!i||i.type!=="ContentStatement"||!t&&i.leftStripped)){var r=i.value;return i.value=i.value.replace(t?/\s+$/:/[ \t]+$/,""),i.leftStripped=i.value!==r,i.leftStripped}}Qi.default=Ye;pl.exports=Qi.default});var ml=V(Ae=>{"use strict";Ae.__esModule=!0;Ae.SourceLocation=ED;Ae.id=wD;Ae.stripFlags=FD;Ae.stripComment=SD;Ae.preparePath=TD;Ae.prepareMustache=MD;Ae.prepareRawBlock=_D;Ae.prepareBlock=xD;Ae.prepareProgram=PD;Ae.preparePartialBlock=kD;function vD(n){return n&&n.__esModule?n:{default:n}}var CD=Ie(),Us=vD(CD);function Hs(n,e){if(e=e.path?e.path.original:e,n.path.original!==e){var t={loc:n.path.loc};throw new Us.default(n.path.original+" doesn't match "+e,t)}}function ED(n,e){this.source=n,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}}function wD(n){return/^\[.*\]$/.test(n)?n.substring(1,n.length-1):n}function FD(n,e){return{open:n.charAt(2)==="~",close:e.charAt(e.length-3)==="~"}}function SD(n){return n.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function TD(n,e,t){t=this.locInfo(t);for(var i=n?"@":"",r=[],s=0,o=0,a=e.length;o<a;o++){var d=e[o].part,c=e[o].original!==d;if(i+=(e[o].separator||"")+d,!c&&(d===".."||d==="."||d==="this")){if(r.length>0)throw new Us.default("Invalid path: "+i,{loc:t});d===".."&&s++}else r.push(d)}return{type:"PathExpression",data:n,depth:s,parts:r,original:i,loc:t}}function MD(n,e,t,i,r,s){var o=i.charAt(3)||i.charAt(2),a=o!=="{"&&o!=="&",d=/\*/.test(i);return{type:d?"Decorator":"MustacheStatement",path:n,params:e,hash:t,escaped:a,strip:r,loc:this.locInfo(s)}}function _D(n,e,t,i){Hs(n,t),i=this.locInfo(i);var r={type:"Program",body:e,strip:{},loc:i};return{type:"BlockStatement",path:n.path,params:n.params,hash:n.hash,program:r,openStrip:{},inverseStrip:{},closeStrip:{},loc:i}}function xD(n,e,t,i,r,s){i&&i.path&&Hs(n,i);var o=/\*/.test(n.open);e.blockParams=n.blockParams;var a=void 0,d=void 0;if(t){if(o)throw new Us.default("Unexpected inverse block on decorator",t);t.chain&&(t.program.body[0].closeStrip=i.strip),d=t.strip,a=t.program}return r&&(r=a,a=e,e=r),{type:o?"DecoratorBlock":"BlockStatement",path:n.path,params:n.params,hash:n.hash,program:e,inverse:a,openStrip:n.strip,inverseStrip:d,closeStrip:i&&i.strip,loc:this.locInfo(s)}}function PD(n,e){if(!e&&n.length){var t=n[0].loc,i=n[n.length-1].loc;t&&i&&(e={source:t.source,start:{line:t.start.line,column:t.start.column},end:{line:i.end.line,column:i.end.column}})}return{type:"Program",body:n,strip:{},loc:e}}function kD(n,e,t,i){return Hs(n,t),{type:"PartialBlockStatement",name:n.path,params:n.params,hash:n.hash,program:e,openStrip:n.strip,closeStrip:t&&t.strip,loc:this.locInfo(i)}}});var Dl=V(xn=>{"use strict";xn.__esModule=!0;xn.parseWithoutProcessing=yl;xn.parse=BD;function bD(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function gl(n){return n&&n.__esModule?n:{default:n}}var ID=ll(),qs=gl(ID),AD=hl(),ND=gl(AD),RD=ml(),LD=bD(RD),OD=De();xn.parser=qs.default;var Xi={};OD.extend(Xi,LD);function yl(n,e){if(n.type==="Program")return n;qs.default.yy=Xi,Xi.locInfo=function(i){return new Xi.SourceLocation(e&&e.srcName,i)};var t=qs.default.parse(n);return t}function BD(n,e){var t=yl(n,e),i=new ND.default(e);return i.accept(t)}});var wl=V(In=>{"use strict";In.__esModule=!0;In.Compiler=Ws;In.precompile=HD;In.compile=qD;function Cl(n){return n&&n.__esModule?n:{default:n}}var VD=Ie(),kn=Cl(VD),bn=De(),GD=Ls(),Pn=Cl(GD),UD=[].slice;function Ws(){}Ws.prototype={compiler:Ws,equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var i=0;i<t;i++){var r=this.opcodes[i],s=e.opcodes[i];if(r.opcode!==s.opcode||!El(r.args,s.args))return!1}t=this.children.length;for(var i=0;i<t;i++)if(!this.children[i].equals(e.children[i]))return!1;return!0},guid:0,compile:function(e,t){return this.sourceNode=[],this.opcodes=[],this.children=[],this.options=t,this.stringParams=t.stringParams,this.trackIds=t.trackIds,t.blockParams=t.blockParams||[],t.knownHelpers=bn.extend(Object.create(null),{helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},t.knownHelpers),this.accept(e)},compileProgram:function(e){var t=new this.compiler,i=t.compile(e,this.options),r=this.guid++;return this.usePartial=this.usePartial||i.usePartial,this.children[r]=i,this.useDepths=this.useDepths||i.useDepths,r},accept:function(e){if(!this[e.type])throw new kn.default("Unknown type: "+e.type,e);this.sourceNode.unshift(e);var t=this[e.type](e);return this.sourceNode.shift(),t},Program:function(e){this.options.blockParams.unshift(e.blockParams);for(var t=e.body,i=t.length,r=0;r<i;r++)this.accept(t[r]);return this.options.blockParams.shift(),this.isSimple=i===1,this.blockParams=e.blockParams?e.blockParams.length:0,this},BlockStatement:function(e){vl(e);var t=e.program,i=e.inverse;t=t&&this.compileProgram(t),i=i&&this.compileProgram(i);var r=this.classifySexpr(e);r==="helper"?this.helperSexpr(e,t,i):r==="simple"?(this.simpleSexpr(e),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("blockValue",e.path.original)):(this.ambiguousSexpr(e,t,i),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(e){var t=e.program&&this.compileProgram(e.program),i=this.setupFullMustacheParams(e,t,void 0),r=e.path;this.useDecorators=!0,this.opcode("registerDecorator",i.length,r.original)},PartialStatement:function(e){this.usePartial=!0;var t=e.program;t&&(t=this.compileProgram(e.program));var i=e.params;if(i.length>1)throw new kn.default("Unsupported number of partial arguments: "+i.length,e);i.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):i.push({type:"PathExpression",parts:[],depth:0}));var r=e.name.original,s=e.name.type==="SubExpression";s&&this.accept(e.name),this.setupFullMustacheParams(e,t,void 0,!0);var o=e.indent||"";this.options.preventIndent&&o&&(this.opcode("appendContent",o),o=""),this.opcode("invokePartial",s,r,o),this.opcode("append")},PartialBlockStatement:function(e){this.PartialStatement(e)},MustacheStatement:function(e){this.SubExpression(e),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(e){this.DecoratorBlock(e)},ContentStatement:function(e){e.value&&this.opcode("appendContent",e.value)},CommentStatement:function(){},SubExpression:function(e){vl(e);var t=this.classifySexpr(e);t==="simple"?this.simpleSexpr(e):t==="helper"?this.helperSexpr(e):this.ambiguousSexpr(e)},ambiguousSexpr:function(e,t,i){var r=e.path,s=r.parts[0],o=t!=null||i!=null;this.opcode("getContext",r.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",i),r.strict=!0,this.accept(r),this.opcode("invokeAmbiguous",s,o)},simpleSexpr:function(e){var t=e.path;t.strict=!0,this.accept(t),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,i){var r=this.setupFullMustacheParams(e,t,i),s=e.path,o=s.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",r.length,o);else{if(this.options.knownHelpersOnly)throw new kn.default("You specified knownHelpersOnly, but used the unknown helper "+o,e);s.strict=!0,s.falsy=!0,this.accept(s),this.opcode("invokeHelper",r.length,s.original,Pn.default.helpers.simpleId(s))}},PathExpression:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0],i=Pn.default.helpers.scopedId(e),r=!e.depth&&!i&&this.blockParamIndex(t);r?this.opcode("lookupBlockParam",r,e.parts):t?e.data?(this.options.data=!0,this.opcode("lookupData",e.depth,e.parts,e.strict)):this.opcode("lookupOnContext",e.parts,e.falsy,e.strict,i):this.opcode("pushContext")},StringLiteral:function(e){this.opcode("pushString",e.value)},NumberLiteral:function(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function(e){this.opcode("pushLiteral",e.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(e){var t=e.pairs,i=0,r=t.length;for(this.opcode("pushHash");i<r;i++)this.pushParam(t[i].value);for(;i--;)this.opcode("assignToHash",t[i].key);this.opcode("popHash")},opcode:function(e){this.opcodes.push({opcode:e,args:UD.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(e){e&&(this.useDepths=!0)},classifySexpr:function(e){var t=Pn.default.helpers.simpleId(e.path),i=t&&!!this.blockParamIndex(e.path.parts[0]),r=!i&&Pn.default.helpers.helperExpression(e),s=!i&&(r||t);if(s&&!r){var o=e.path.parts[0],a=this.options;a.knownHelpers[o]?r=!0:a.knownHelpersOnly&&(s=!1)}return r?"helper":s?"ambiguous":"simple"},pushParams:function(e){for(var t=0,i=e.length;t<i;t++)this.pushParam(e[t])},pushParam:function(e){var t=e.value!=null?e.value:e.original||"";if(this.stringParams)t.replace&&(t=t.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",t,e.type),e.type==="SubExpression"&&this.accept(e);else{if(this.trackIds){var i=void 0;if(e.parts&&!Pn.default.helpers.scopedId(e)&&!e.depth&&(i=this.blockParamIndex(e.parts[0])),i){var r=e.parts.slice(1).join(".");this.opcode("pushId","BlockParam",i,r)}else t=e.original||t,t.replace&&(t=t.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",e.type,t)}this.accept(e)}},setupFullMustacheParams:function(e,t,i,r){var s=e.params;return this.pushParams(s),this.opcode("pushProgram",t),this.opcode("pushProgram",i),e.hash?this.accept(e.hash):this.opcode("emptyHash",r),s},blockParamIndex:function(e){for(var t=0,i=this.options.blockParams.length;t<i;t++){var r=this.options.blockParams[t],s=r&&bn.indexOf(r,e);if(r&&s>=0)return[t,s]}}};function HD(n,e,t){if(n==null||typeof n!="string"&&n.type!=="Program")throw new kn.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+n);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var i=t.parse(n,e),r=new t.Compiler().compile(i,e);return new t.JavaScriptCompiler().compile(r,e)}function qD(n,e,t){if(e===void 0&&(e={}),n==null||typeof n!="string"&&n.type!=="Program")throw new kn.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+n);e=bn.extend({},e),"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var i=void 0;function r(){var o=t.parse(n,e),a=new t.Compiler().compile(o,e),d=new t.JavaScriptCompiler().compile(a,e,void 0,!0);return t.template(d)}function s(o,a){return i||(i=r()),i.call(this,o,a)}return s._setup=function(o){return i||(i=r()),i._setup(o)},s._child=function(o,a,d,c){return i||(i=r()),i._child(o,a,d,c)},s}function El(n,e){if(n===e)return!0;if(bn.isArray(n)&&bn.isArray(e)&&n.length===e.length){for(var t=0;t<n.length;t++)if(!El(n[t],e[t]))return!1;return!0}}function vl(n){if(!n.path.parts){var e=n.path;n.path={type:"PathExpression",data:!1,depth:0,parts:[e.original+""],original:e.original+"",loc:e.loc}}}});var Sl=V($s=>{var Fl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");$s.encode=function(n){if(0<=n&&n<Fl.length)return Fl[n];throw new TypeError("Must be between 0 and 63: "+n)};$s.decode=function(n){var e=65,t=90,i=97,r=122,s=48,o=57,a=43,d=47,c=26,f=52;return e<=n&&n<=t?n-e:i<=n&&n<=r?n-i+c:s<=n&&n<=o?n-s+f:n==a?62:n==d?63:-1}});var Ks=V(Ys=>{var Tl=Sl(),zs=5,Ml=1<<zs,_l=Ml-1,xl=Ml;function WD(n){return n<0?(-n<<1)+1:(n<<1)+0}function $D(n){var e=(n&1)===1,t=n>>1;return e?-t:t}Ys.encode=function(e){var t="",i,r=WD(e);do i=r&_l,r>>>=zs,r>0&&(i|=xl),t+=Tl.encode(i);while(r>0);return t};Ys.decode=function(e,t,i){var r=e.length,s=0,o=0,a,d;do{if(t>=r)throw new Error("Expected more digits in base 64 VLQ value.");if(d=Tl.decode(e.charCodeAt(t++)),d===-1)throw new Error("Invalid base64 digit: "+e.charAt(t-1));a=!!(d&xl),d&=_l,s=s+(d<<o),o+=zs}while(a);i.value=$D(s),i.rest=t}});var Yt=V(he=>{function zD(n,e,t){if(e in n)return n[e];if(arguments.length===3)return t;throw new Error('"'+e+'" is a required argument.')}he.getArg=zD;var Pl=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,YD=/^data:.+\,.+$/;function An(n){var e=n.match(Pl);return e?{scheme:e[1],auth:e[2],host:e[3],port:e[4],path:e[5]}:null}he.urlParse=An;function $t(n){var e="";return n.scheme&&(e+=n.scheme+":"),e+="//",n.auth&&(e+=n.auth+"@"),n.host&&(e+=n.host),n.port&&(e+=":"+n.port),n.path&&(e+=n.path),e}he.urlGenerate=$t;function Js(n){var e=n,t=An(n);if(t){if(!t.path)return n;e=t.path}for(var i=he.isAbsolute(e),r=e.split(/\/+/),s,o=0,a=r.length-1;a>=0;a--)s=r[a],s==="."?r.splice(a,1):s===".."?o++:o>0&&(s===""?(r.splice(a+1,o),o=0):(r.splice(a,2),o--));return e=r.join("/"),e===""&&(e=i?"/":"."),t?(t.path=e,$t(t)):e}he.normalize=Js;function kl(n,e){n===""&&(n="."),e===""&&(e=".");var t=An(e),i=An(n);if(i&&(n=i.path||"/"),t&&!t.scheme)return i&&(t.scheme=i.scheme),$t(t);if(t||e.match(YD))return e;if(i&&!i.host&&!i.path)return i.host=e,$t(i);var r=e.charAt(0)==="/"?e:Js(n.replace(/\/+$/,"")+"/"+e);return i?(i.path=r,$t(i)):r}he.join=kl;he.isAbsolute=function(n){return n.charAt(0)==="/"||Pl.test(n)};function KD(n,e){n===""&&(n="."),n=n.replace(/\/$/,"");for(var t=0;e.indexOf(n+"/")!==0;){var i=n.lastIndexOf("/");if(i<0||(n=n.slice(0,i),n.match(/^([^\/]+:\/)?\/*$/)))return e;++t}return Array(t+1).join("../")+e.substr(n.length+1)}he.relative=KD;var bl=function(){var n=Object.create(null);return!("__proto__"in n)}();function Il(n){return n}function JD(n){return Al(n)?"$"+n:n}he.toSetString=bl?Il:JD;function ZD(n){return Al(n)?n.slice(1):n}he.fromSetString=bl?Il:ZD;function Al(n){if(!n)return!1;var e=n.length;if(e<9||n.charCodeAt(e-1)!==95||n.charCodeAt(e-2)!==95||n.charCodeAt(e-3)!==111||n.charCodeAt(e-4)!==116||n.charCodeAt(e-5)!==111||n.charCodeAt(e-6)!==114||n.charCodeAt(e-7)!==112||n.charCodeAt(e-8)!==95||n.charCodeAt(e-9)!==95)return!1;for(var t=e-10;t>=0;t--)if(n.charCodeAt(t)!==36)return!1;return!0}function QD(n,e,t){var i=zt(n.source,e.source);return i!==0||(i=n.originalLine-e.originalLine,i!==0)||(i=n.originalColumn-e.originalColumn,i!==0||t)||(i=n.generatedColumn-e.generatedColumn,i!==0)||(i=n.generatedLine-e.generatedLine,i!==0)?i:zt(n.name,e.name)}he.compareByOriginalPositions=QD;function XD(n,e,t){var i=n.generatedLine-e.generatedLine;return i!==0||(i=n.generatedColumn-e.generatedColumn,i!==0||t)||(i=zt(n.source,e.source),i!==0)||(i=n.originalLine-e.originalLine,i!==0)||(i=n.originalColumn-e.originalColumn,i!==0)?i:zt(n.name,e.name)}he.compareByGeneratedPositionsDeflated=XD;function zt(n,e){return n===e?0:n===null?1:e===null?-1:n>e?1:-1}function jD(n,e){var t=n.generatedLine-e.generatedLine;return t!==0||(t=n.generatedColumn-e.generatedColumn,t!==0)||(t=zt(n.source,e.source),t!==0)||(t=n.originalLine-e.originalLine,t!==0)||(t=n.originalColumn-e.originalColumn,t!==0)?t:zt(n.name,e.name)}he.compareByGeneratedPositionsInflated=jD;function ev(n){return JSON.parse(n.replace(/^\)]}'[^\n]*\n/,""))}he.parseSourceMapInput=ev;function tv(n,e,t){if(e=e||"",n&&(n[n.length-1]!=="/"&&e[0]!=="/"&&(n+="/"),e=n+e),t){var i=An(t);if(!i)throw new Error("sourceMapURL could not be parsed");if(i.path){var r=i.path.lastIndexOf("/");r>=0&&(i.path=i.path.substring(0,r+1))}e=kl($t(i),e)}return Js(e)}he.computeSourceURL=tv});var Xs=V(Nl=>{var Zs=Yt(),Qs=Object.prototype.hasOwnProperty,St=typeof Map!="undefined";function rt(){this._array=[],this._set=St?new Map:Object.create(null)}rt.fromArray=function(e,t){for(var i=new rt,r=0,s=e.length;r<s;r++)i.add(e[r],t);return i};rt.prototype.size=function(){return St?this._set.size:Object.getOwnPropertyNames(this._set).length};rt.prototype.add=function(e,t){var i=St?e:Zs.toSetString(e),r=St?this.has(e):Qs.call(this._set,i),s=this._array.length;(!r||t)&&this._array.push(e),r||(St?this._set.set(e,s):this._set[i]=s)};rt.prototype.has=function(e){if(St)return this._set.has(e);var t=Zs.toSetString(e);return Qs.call(this._set,t)};rt.prototype.indexOf=function(e){if(St){var t=this._set.get(e);if(t>=0)return t}else{var i=Zs.toSetString(e);if(Qs.call(this._set,i))return this._set[i]}throw new Error('"'+e+'" is not in the set.')};rt.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)};rt.prototype.toArray=function(){return this._array.slice()};Nl.ArraySet=rt});var Ol=V(Ll=>{var Rl=Yt();function nv(n,e){var t=n.generatedLine,i=e.generatedLine,r=n.generatedColumn,s=e.generatedColumn;return i>t||i==t&&s>=r||Rl.compareByGeneratedPositionsInflated(n,e)<=0}function ji(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}ji.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)};ji.prototype.add=function(e){nv(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))};ji.prototype.toArray=function(){return this._sorted||(this._array.sort(Rl.compareByGeneratedPositionsInflated),this._sorted=!0),this._array};Ll.MappingList=ji});var js=V(Bl=>{var Nn=Ks(),ie=Yt(),er=Xs().ArraySet,iv=Ol().MappingList;function Ne(n){n||(n={}),this._file=ie.getArg(n,"file",null),this._sourceRoot=ie.getArg(n,"sourceRoot",null),this._skipValidation=ie.getArg(n,"skipValidation",!1),this._sources=new er,this._names=new er,this._mappings=new iv,this._sourcesContents=null}Ne.prototype._version=3;Ne.fromSourceMap=function(e){var t=e.sourceRoot,i=new Ne({file:e.file,sourceRoot:t});return e.eachMapping(function(r){var s={generated:{line:r.generatedLine,column:r.generatedColumn}};r.source!=null&&(s.source=r.source,t!=null&&(s.source=ie.relative(t,s.source)),s.original={line:r.originalLine,column:r.originalColumn},r.name!=null&&(s.name=r.name)),i.addMapping(s)}),e.sources.forEach(function(r){var s=r;t!==null&&(s=ie.relative(t,r)),i._sources.has(s)||i._sources.add(s);var o=e.sourceContentFor(r);o!=null&&i.setSourceContent(r,o)}),i};Ne.prototype.addMapping=function(e){var t=ie.getArg(e,"generated"),i=ie.getArg(e,"original",null),r=ie.getArg(e,"source",null),s=ie.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,i,r,s),r!=null&&(r=String(r),this._sources.has(r)||this._sources.add(r)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:i!=null&&i.line,originalColumn:i!=null&&i.column,source:r,name:s})};Ne.prototype.setSourceContent=function(e,t){var i=e;this._sourceRoot!=null&&(i=ie.relative(this._sourceRoot,i)),t!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[ie.toSetString(i)]=t):this._sourcesContents&&(delete this._sourcesContents[ie.toSetString(i)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))};Ne.prototype.applySourceMap=function(e,t,i){var r=t;if(t==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);r=e.file}var s=this._sourceRoot;s!=null&&(r=ie.relative(s,r));var o=new er,a=new er;this._mappings.unsortedForEach(function(d){if(d.source===r&&d.originalLine!=null){var c=e.originalPositionFor({line:d.originalLine,column:d.originalColumn});c.source!=null&&(d.source=c.source,i!=null&&(d.source=ie.join(i,d.source)),s!=null&&(d.source=ie.relative(s,d.source)),d.originalLine=c.line,d.originalColumn=c.column,c.name!=null&&(d.name=c.name))}var f=d.source;f!=null&&!o.has(f)&&o.add(f);var p=d.name;p!=null&&!a.has(p)&&a.add(p)},this),this._sources=o,this._names=a,e.sources.forEach(function(d){var c=e.sourceContentFor(d);c!=null&&(i!=null&&(d=ie.join(i,d)),s!=null&&(d=ie.relative(s,d)),this.setSourceContent(d,c))},this)};Ne.prototype._validateMapping=function(e,t,i,r){if(t&&typeof t.line!="number"&&typeof t.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!i&&!r)){if(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&i)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:i,original:t,name:r}))}};Ne.prototype._serializeMappings=function(){for(var e=0,t=1,i=0,r=0,s=0,o=0,a="",d,c,f,p,h=this._mappings.toArray(),g=0,v=h.length;g<v;g++){if(c=h[g],d="",c.generatedLine!==t)for(e=0;c.generatedLine!==t;)d+=";",t++;else if(g>0){if(!ie.compareByGeneratedPositionsInflated(c,h[g-1]))continue;d+=","}d+=Nn.encode(c.generatedColumn-e),e=c.generatedColumn,c.source!=null&&(p=this._sources.indexOf(c.source),d+=Nn.encode(p-o),o=p,d+=Nn.encode(c.originalLine-1-r),r=c.originalLine-1,d+=Nn.encode(c.originalColumn-i),i=c.originalColumn,c.name!=null&&(f=this._names.indexOf(c.name),d+=Nn.encode(f-s),s=f)),a+=d}return a};Ne.prototype._generateSourcesContent=function(e,t){return e.map(function(i){if(!this._sourcesContents)return null;t!=null&&(i=ie.relative(t,i));var r=ie.toSetString(i);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null},this)};Ne.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e};Ne.prototype.toString=function(){return JSON.stringify(this.toJSON())};Bl.SourceMapGenerator=Ne});var Vl=V(Tt=>{Tt.GREATEST_LOWER_BOUND=1;Tt.LEAST_UPPER_BOUND=2;function eo(n,e,t,i,r,s){var o=Math.floor((e-n)/2)+n,a=r(t,i[o],!0);return a===0?o:a>0?e-o>1?eo(o,e,t,i,r,s):s==Tt.LEAST_UPPER_BOUND?e<i.length?e:-1:o:o-n>1?eo(n,o,t,i,r,s):s==Tt.LEAST_UPPER_BOUND?o:n<0?-1:n}Tt.search=function(e,t,i,r){if(t.length===0)return-1;var s=eo(-1,t.length,e,t,i,r||Tt.GREATEST_LOWER_BOUND);if(s<0)return-1;for(;s-1>=0&&i(t[s],t[s-1],!0)===0;)--s;return s}});var Ul=V(Gl=>{function to(n,e,t){var i=n[e];n[e]=n[t],n[t]=i}function rv(n,e){return Math.round(n+Math.random()*(e-n))}function no(n,e,t,i){if(t<i){var r=rv(t,i),s=t-1;to(n,r,i);for(var o=n[i],a=t;a<i;a++)e(n[a],o)<=0&&(s+=1,to(n,s,a));to(n,s+1,a);var d=s+1;no(n,e,t,d-1),no(n,e,d+1,i)}}Gl.quickSort=function(n,e){no(n,e,0,n.length-1)}});var ql=V(tr=>{var A=Yt(),io=Vl(),Kt=Xs().ArraySet,sv=Ks(),Rn=Ul().quickSort;function Z(n,e){var t=n;return typeof n=="string"&&(t=A.parseSourceMapInput(n)),t.sections!=null?new Ge(t,e):new fe(t,e)}Z.fromSourceMap=function(n,e){return fe.fromSourceMap(n,e)};Z.prototype._version=3;Z.prototype.__generatedMappings=null;Object.defineProperty(Z.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}});Z.prototype.__originalMappings=null;Object.defineProperty(Z.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}});Z.prototype._charIsMappingSeparator=function(e,t){var i=e.charAt(t);return i===";"||i===","};Z.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")};Z.GENERATED_ORDER=1;Z.ORIGINAL_ORDER=2;Z.GREATEST_LOWER_BOUND=1;Z.LEAST_UPPER_BOUND=2;Z.prototype.eachMapping=function(e,t,i){var r=t||null,s=i||Z.GENERATED_ORDER,o;switch(s){case Z.GENERATED_ORDER:o=this._generatedMappings;break;case Z.ORIGINAL_ORDER:o=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var a=this.sourceRoot;o.map(function(d){var c=d.source===null?null:this._sources.at(d.source);return c=A.computeSourceURL(a,c,this._sourceMapURL),{source:c,generatedLine:d.generatedLine,generatedColumn:d.generatedColumn,originalLine:d.originalLine,originalColumn:d.originalColumn,name:d.name===null?null:this._names.at(d.name)}},this).forEach(e,r)};Z.prototype.allGeneratedPositionsFor=function(e){var t=A.getArg(e,"line"),i={source:A.getArg(e,"source"),originalLine:t,originalColumn:A.getArg(e,"column",0)};if(i.source=this._findSourceIndex(i.source),i.source<0)return[];var r=[],s=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",A.compareByOriginalPositions,io.LEAST_UPPER_BOUND);if(s>=0){var o=this._originalMappings[s];if(e.column===void 0)for(var a=o.originalLine;o&&o.originalLine===a;)r.push({line:A.getArg(o,"generatedLine",null),column:A.getArg(o,"generatedColumn",null),lastColumn:A.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++s];else for(var d=o.originalColumn;o&&o.originalLine===t&&o.originalColumn==d;)r.push({line:A.getArg(o,"generatedLine",null),column:A.getArg(o,"generatedColumn",null),lastColumn:A.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++s]}return r};tr.SourceMapConsumer=Z;function fe(n,e){var t=n;typeof n=="string"&&(t=A.parseSourceMapInput(n));var i=A.getArg(t,"version"),r=A.getArg(t,"sources"),s=A.getArg(t,"names",[]),o=A.getArg(t,"sourceRoot",null),a=A.getArg(t,"sourcesContent",null),d=A.getArg(t,"mappings"),c=A.getArg(t,"file",null);if(i!=this._version)throw new Error("Unsupported version: "+i);o&&(o=A.normalize(o)),r=r.map(String).map(A.normalize).map(function(f){return o&&A.isAbsolute(o)&&A.isAbsolute(f)?A.relative(o,f):f}),this._names=Kt.fromArray(s.map(String),!0),this._sources=Kt.fromArray(r,!0),this._absoluteSources=this._sources.toArray().map(function(f){return A.computeSourceURL(o,f,e)}),this.sourceRoot=o,this.sourcesContent=a,this._mappings=d,this._sourceMapURL=e,this.file=c}fe.prototype=Object.create(Z.prototype);fe.prototype.consumer=Z;fe.prototype._findSourceIndex=function(n){var e=n;if(this.sourceRoot!=null&&(e=A.relative(this.sourceRoot,e)),this._sources.has(e))return this._sources.indexOf(e);var t;for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==n)return t;return-1};fe.fromSourceMap=function(e,t){var i=Object.create(fe.prototype),r=i._names=Kt.fromArray(e._names.toArray(),!0),s=i._sources=Kt.fromArray(e._sources.toArray(),!0);i.sourceRoot=e._sourceRoot,i.sourcesContent=e._generateSourcesContent(i._sources.toArray(),i.sourceRoot),i.file=e._file,i._sourceMapURL=t,i._absoluteSources=i._sources.toArray().map(function(g){return A.computeSourceURL(i.sourceRoot,g,t)});for(var o=e._mappings.toArray().slice(),a=i.__generatedMappings=[],d=i.__originalMappings=[],c=0,f=o.length;c<f;c++){var p=o[c],h=new Hl;h.generatedLine=p.generatedLine,h.generatedColumn=p.generatedColumn,p.source&&(h.source=s.indexOf(p.source),h.originalLine=p.originalLine,h.originalColumn=p.originalColumn,p.name&&(h.name=r.indexOf(p.name)),d.push(h)),a.push(h)}return Rn(i.__originalMappings,A.compareByOriginalPositions),i};fe.prototype._version=3;Object.defineProperty(fe.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function Hl(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}fe.prototype._parseMappings=function(e,t){for(var i=1,r=0,s=0,o=0,a=0,d=0,c=e.length,f=0,p={},h={},g=[],v=[],w,S,x,I,L;f<c;)if(e.charAt(f)===";")i++,f++,r=0;else if(e.charAt(f)===",")f++;else{for(w=new Hl,w.generatedLine=i,I=f;I<c&&!this._charIsMappingSeparator(e,I);I++);if(S=e.slice(f,I),x=p[S],x)f+=S.length;else{for(x=[];f<I;)sv.decode(e,f,h),L=h.value,f=h.rest,x.push(L);if(x.length===2)throw new Error("Found a source, but no line and column");if(x.length===3)throw new Error("Found a source and line, but no column");p[S]=x}w.generatedColumn=r+x[0],r=w.generatedColumn,x.length>1&&(w.source=a+x[1],a+=x[1],w.originalLine=s+x[2],s=w.originalLine,w.originalLine+=1,w.originalColumn=o+x[3],o=w.originalColumn,x.length>4&&(w.name=d+x[4],d+=x[4])),v.push(w),typeof w.originalLine=="number"&&g.push(w)}Rn(v,A.compareByGeneratedPositionsDeflated),this.__generatedMappings=v,Rn(g,A.compareByOriginalPositions),this.__originalMappings=g};fe.prototype._findMapping=function(e,t,i,r,s,o){if(e[i]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[i]);if(e[r]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[r]);return io.search(e,t,s,o)};fe.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var i=this._generatedMappings[e+1];if(t.generatedLine===i.generatedLine){t.lastGeneratedColumn=i.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}};fe.prototype.originalPositionFor=function(e){var t={generatedLine:A.getArg(e,"line"),generatedColumn:A.getArg(e,"column")},i=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",A.compareByGeneratedPositionsDeflated,A.getArg(e,"bias",Z.GREATEST_LOWER_BOUND));if(i>=0){var r=this._generatedMappings[i];if(r.generatedLine===t.generatedLine){var s=A.getArg(r,"source",null);s!==null&&(s=this._sources.at(s),s=A.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));var o=A.getArg(r,"name",null);return o!==null&&(o=this._names.at(o)),{source:s,line:A.getArg(r,"originalLine",null),column:A.getArg(r,"originalColumn",null),name:o}}}return{source:null,line:null,column:null,name:null}};fe.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1};fe.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var i=this._findSourceIndex(e);if(i>=0)return this.sourcesContent[i];var r=e;this.sourceRoot!=null&&(r=A.relative(this.sourceRoot,r));var s;if(this.sourceRoot!=null&&(s=A.urlParse(this.sourceRoot))){var o=r.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!s.path||s.path=="/")&&this._sources.has("/"+r))return this.sourcesContent[this._sources.indexOf("/"+r)]}if(t)return null;throw new Error('"'+r+'" is not in the SourceMap.')};fe.prototype.generatedPositionFor=function(e){var t=A.getArg(e,"source");if(t=this._findSourceIndex(t),t<0)return{line:null,column:null,lastColumn:null};var i={source:t,originalLine:A.getArg(e,"line"),originalColumn:A.getArg(e,"column")},r=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",A.compareByOriginalPositions,A.getArg(e,"bias",Z.GREATEST_LOWER_BOUND));if(r>=0){var s=this._originalMappings[r];if(s.source===i.source)return{line:A.getArg(s,"generatedLine",null),column:A.getArg(s,"generatedColumn",null),lastColumn:A.getArg(s,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}};tr.BasicSourceMapConsumer=fe;function Ge(n,e){var t=n;typeof n=="string"&&(t=A.parseSourceMapInput(n));var i=A.getArg(t,"version"),r=A.getArg(t,"sections");if(i!=this._version)throw new Error("Unsupported version: "+i);this._sources=new Kt,this._names=new Kt;var s={line:-1,column:0};this._sections=r.map(function(o){if(o.url)throw new Error("Support for url field in sections not implemented.");var a=A.getArg(o,"offset"),d=A.getArg(a,"line"),c=A.getArg(a,"column");if(d<s.line||d===s.line&&c<s.column)throw new Error("Section offsets must be ordered and non-overlapping.");return s=a,{generatedOffset:{generatedLine:d+1,generatedColumn:c+1},consumer:new Z(A.getArg(o,"map"),e)}})}Ge.prototype=Object.create(Z.prototype);Ge.prototype.constructor=Z;Ge.prototype._version=3;Object.defineProperty(Ge.prototype,"sources",{get:function(){for(var n=[],e=0;e<this._sections.length;e++)for(var t=0;t<this._sections[e].consumer.sources.length;t++)n.push(this._sections[e].consumer.sources[t]);return n}});Ge.prototype.originalPositionFor=function(e){var t={generatedLine:A.getArg(e,"line"),generatedColumn:A.getArg(e,"column")},i=io.search(t,this._sections,function(s,o){var a=s.generatedLine-o.generatedOffset.generatedLine;return a||s.generatedColumn-o.generatedOffset.generatedColumn}),r=this._sections[i];return r?r.consumer.originalPositionFor({line:t.generatedLine-(r.generatedOffset.generatedLine-1),column:t.generatedColumn-(r.generatedOffset.generatedLine===t.generatedLine?r.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}};Ge.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})};Ge.prototype.sourceContentFor=function(e,t){for(var i=0;i<this._sections.length;i++){var r=this._sections[i],s=r.consumer.sourceContentFor(e,!0);if(s)return s}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')};Ge.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var i=this._sections[t];if(i.consumer._findSourceIndex(A.getArg(e,"source"))!==-1){var r=i.consumer.generatedPositionFor(e);if(r){var s={line:r.line+(i.generatedOffset.generatedLine-1),column:r.column+(i.generatedOffset.generatedLine===r.line?i.generatedOffset.generatedColumn-1:0)};return s}}}return{line:null,column:null}};Ge.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var i=0;i<this._sections.length;i++)for(var r=this._sections[i],s=r.consumer._generatedMappings,o=0;o<s.length;o++){var a=s[o],d=r.consumer._sources.at(a.source);d=A.computeSourceURL(r.consumer.sourceRoot,d,this._sourceMapURL),this._sources.add(d),d=this._sources.indexOf(d);var c=null;a.name&&(c=r.consumer._names.at(a.name),this._names.add(c),c=this._names.indexOf(c));var f={source:d,generatedLine:a.generatedLine+(r.generatedOffset.generatedLine-1),generatedColumn:a.generatedColumn+(r.generatedOffset.generatedLine===a.generatedLine?r.generatedOffset.generatedColumn-1:0),originalLine:a.originalLine,originalColumn:a.originalColumn,name:c};this.__generatedMappings.push(f),typeof f.originalLine=="number"&&this.__originalMappings.push(f)}Rn(this.__generatedMappings,A.compareByGeneratedPositionsDeflated),Rn(this.__originalMappings,A.compareByOriginalPositions)};tr.IndexedSourceMapConsumer=Ge});var $l=V(Wl=>{var ov=js().SourceMapGenerator,nr=Yt(),av=/(\r?\n)/,uv=10,Jt="$$$isSourceNode$$$";function Me(n,e,t,i,r){this.children=[],this.sourceContents={},this.line=n==null?null:n,this.column=e==null?null:e,this.source=t==null?null:t,this.name=r==null?null:r,this[Jt]=!0,i!=null&&this.add(i)}Me.fromStringWithSourceMap=function(e,t,i){var r=new Me,s=e.split(av),o=0,a=function(){var h=v(),g=v()||"";return h+g;function v(){return o<s.length?s[o++]:void 0}},d=1,c=0,f=null;return t.eachMapping(function(h){if(f!==null)if(d<h.generatedLine)p(f,a()),d++,c=0;else{var g=s[o]||"",v=g.substr(0,h.generatedColumn-c);s[o]=g.substr(h.generatedColumn-c),c=h.generatedColumn,p(f,v),f=h;return}for(;d<h.generatedLine;)r.add(a()),d++;if(c<h.generatedColumn){var g=s[o]||"";r.add(g.substr(0,h.generatedColumn)),s[o]=g.substr(h.generatedColumn),c=h.generatedColumn}f=h},this),o<s.length&&(f&&p(f,a()),r.add(s.splice(o).join(""))),t.sources.forEach(function(h){var g=t.sourceContentFor(h);g!=null&&(i!=null&&(h=nr.join(i,h)),r.setSourceContent(h,g))}),r;function p(h,g){if(h===null||h.source===void 0)r.add(g);else{var v=i?nr.join(i,h.source):h.source;r.add(new Me(h.originalLine,h.originalColumn,v,g,h.name))}}};Me.prototype.add=function(e){if(Array.isArray(e))e.forEach(function(t){this.add(t)},this);else if(e[Jt]||typeof e=="string")e&&this.children.push(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};Me.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else if(e[Jt]||typeof e=="string")this.children.unshift(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};Me.prototype.walk=function(e){for(var t,i=0,r=this.children.length;i<r;i++)t=this.children[i],t[Jt]?t.walk(e):t!==""&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})};Me.prototype.join=function(e){var t,i,r=this.children.length;if(r>0){for(t=[],i=0;i<r-1;i++)t.push(this.children[i]),t.push(e);t.push(this.children[i]),this.children=t}return this};Me.prototype.replaceRight=function(e,t){var i=this.children[this.children.length-1];return i[Jt]?i.replaceRight(e,t):typeof i=="string"?this.children[this.children.length-1]=i.replace(e,t):this.children.push("".replace(e,t)),this};Me.prototype.setSourceContent=function(e,t){this.sourceContents[nr.toSetString(e)]=t};Me.prototype.walkSourceContents=function(e){for(var t=0,i=this.children.length;t<i;t++)this.children[t][Jt]&&this.children[t].walkSourceContents(e);for(var r=Object.keys(this.sourceContents),t=0,i=r.length;t<i;t++)e(nr.fromSetString(r[t]),this.sourceContents[r[t]])};Me.prototype.toString=function(){var e="";return this.walk(function(t){e+=t}),e};Me.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},i=new ov(e),r=!1,s=null,o=null,a=null,d=null;return this.walk(function(c,f){t.code+=c,f.source!==null&&f.line!==null&&f.column!==null?((s!==f.source||o!==f.line||a!==f.column||d!==f.name)&&i.addMapping({source:f.source,original:{line:f.line,column:f.column},generated:{line:t.line,column:t.column},name:f.name}),s=f.source,o=f.line,a=f.column,d=f.name,r=!0):r&&(i.addMapping({generated:{line:t.line,column:t.column}}),s=null,r=!1);for(var p=0,h=c.length;p<h;p++)c.charCodeAt(p)===uv?(t.line++,t.column=0,p+1===h?(s=null,r=!1):r&&i.addMapping({source:f.source,original:{line:f.line,column:f.column},generated:{line:t.line,column:t.column},name:f.name})):t.column++}),this.walkSourceContents(function(c,f){i.setSourceContent(c,f)}),{code:t.code,map:i}};Wl.SourceNode=Me});var zl=V(ir=>{ir.SourceMapGenerator=js().SourceMapGenerator;ir.SourceMapConsumer=ql().SourceMapConsumer;ir.SourceNode=$l().SourceNode});var Zl=V((rr,Jl)=>{"use strict";rr.__esModule=!0;var so=De(),Mt=void 0;try{(typeof define!="function"||!define.amd)&&(Yl=zl(),Mt=Yl.SourceNode)}catch(n){}var Yl;Mt||(Mt=function(n,e,t,i){this.src="",i&&this.add(i)},Mt.prototype={add:function(e){so.isArray(e)&&(e=e.join("")),this.src+=e},prepend:function(e){so.isArray(e)&&(e=e.join("")),this.src=e+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}});function ro(n,e,t){if(so.isArray(n)){for(var i=[],r=0,s=n.length;r<s;r++)i.push(e.wrap(n[r],t));return i}else if(typeof n=="boolean"||typeof n=="number")return n+"";return n}function Kl(n){this.srcFile=n,this.source=[]}Kl.prototype={isEmpty:function(){return!this.source.length},prepend:function(e,t){this.source.unshift(this.wrap(e,t))},push:function(e,t){this.source.push(this.wrap(e,t))},merge:function(){var e=this.empty();return this.each(function(t){e.add(["  ",t,`
`])}),e},each:function(e){for(var t=0,i=this.source.length;t<i;t++)e(this.source[t])},empty:function(){var e=this.currentLocation||{start:{}};return new Mt(e.start.line,e.start.column,this.srcFile)},wrap:function(e){var t=arguments.length<=1||arguments[1]===void 0?this.currentLocation||{start:{}}:arguments[1];return e instanceof Mt?e:(e=ro(e,this,t),new Mt(t.start.line,t.start.column,this.srcFile,e))},functionCall:function(e,t,i){return i=this.generateList(i),this.wrap([e,t?"."+t+"(":"(",i,")"])},quotedString:function(e){return'"'+(e+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var t=this,i=[];Object.keys(e).forEach(function(s){var o=ro(e[s],t);o!=="undefined"&&i.push([t.quotedString(s),":",o])});var r=this.generateList(i);return r.prepend("{"),r.add("}"),r},generateList:function(e){for(var t=this.empty(),i=0,r=e.length;i<r;i++)i&&t.add(","),t.add(ro(e[i],this));return t},generateArray:function(e){var t=this.generateList(e);return t.prepend("["),t.add("]"),t}};rr.default=Kl;Jl.exports=rr.default});var tc=V((sr,ec)=>{"use strict";sr.__esModule=!0;function jl(n){return n&&n.__esModule?n:{default:n}}var Ql=Ui(),lv=Ie(),oo=jl(lv),cv=De(),dv=Zl(),Xl=jl(dv);function Zt(n){this.value=n}function Qt(){}Qt.prototype={nameLookup:function(e,t){return this.internalNameLookup(e,t)},depthedLookup:function(e){return[this.aliasable("container.lookup"),"(depths, ",JSON.stringify(e),")"]},compilerInfo:function(){var e=Ql.COMPILER_REVISION,t=Ql.REVISION_CHANGES[e];return[e,t]},appendToBuffer:function(e,t,i){return cv.isArray(e)||(e=[e]),e=this.source.wrap(e,t),this.environment.isSimple?["return ",e,";"]:i?["buffer += ",e,";"]:(e.appendToBuffer=!0,e)},initializeBuffer:function(){return this.quotedString("")},internalNameLookup:function(e,t){return this.lookupPropertyFunctionIsUsed=!0,["lookupProperty(",e,",",JSON.stringify(t),")"]},lookupPropertyFunctionIsUsed:!1,compile:function(e,t,i,r){this.environment=e,this.options=t,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!r,this.name=this.environment.name,this.isChild=!!i,this.context=i||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(e,t),this.useDepths=this.useDepths||e.useDepths||e.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||e.useBlockParams;var s=e.opcodes,o=void 0,a=void 0,d=void 0,c=void 0;for(d=0,c=s.length;d<c;d++)o=s[d],this.source.currentLocation=o.loc,a=a||o.loc,this[o.opcode].apply(this,o.args);if(this.source.currentLocation=a,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new oo.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),`;
`]),this.decorators.push("return fn;"),r?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend(`function(fn, props, container, depth0, data, blockParams, depths) {
`),this.decorators.push(`}
`),this.decorators=this.decorators.merge()));var f=this.createFunctionContext(r);if(this.isChild)return f;var p={compiler:this.compilerInfo(),main:f};this.decorators&&(p.main_d=this.decorators,p.useDecorators=!0);var h=this.context,g=h.programs,v=h.decorators;for(d=0,c=g.length;d<c;d++)g[d]&&(p[d]=g[d],v[d]&&(p[d+"_d"]=v[d],p.useDecorators=!0));return this.environment.usePartial&&(p.usePartial=!0),this.options.data&&(p.useData=!0),this.useDepths&&(p.useDepths=!0),this.useBlockParams&&(p.useBlockParams=!0),this.options.compat&&(p.compat=!0),r?p.compilerOptions=this.options:(p.compiler=JSON.stringify(p.compiler),this.source.currentLocation={start:{line:1,column:0}},p=this.objectLiteral(p),t.srcName?(p=p.toStringWithSourceMap({file:t.destName}),p.map=p.map&&p.map.toString()):p=p.toString()),p},preamble:function(){this.lastContext=0,this.source=new Xl.default(this.options.srcName),this.decorators=new Xl.default(this.options.srcName)},createFunctionContext:function(e){var t=this,i="",r=this.stackVars.concat(this.registers.list);r.length>0&&(i+=", "+r.join(", "));var s=0;Object.keys(this.aliases).forEach(function(d){var c=t.aliases[d];c.children&&c.referenceCount>1&&(i+=", alias"+ ++s+"="+d,c.children[0]="alias"+s)}),this.lookupPropertyFunctionIsUsed&&(i+=", "+this.lookupPropertyFunctionVarDeclaration());var o=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&o.push("blockParams"),this.useDepths&&o.push("depths");var a=this.mergeSource(i);return e?(o.push(a),Function.apply(this,o)):this.source.wrap(["function(",o.join(","),`) {
  `,a,"}"])},mergeSource:function(e){var t=this.environment.isSimple,i=!this.forceBuffer,r=void 0,s=void 0,o=void 0,a=void 0;return this.source.each(function(d){d.appendToBuffer?(o?d.prepend("  + "):o=d,a=d):(o&&(s?o.prepend("buffer += "):r=!0,a.add(";"),o=a=void 0),s=!0,t||(i=!1))}),i?o?(o.prepend("return "),a.add(";")):s||this.source.push('return "";'):(e+=", buffer = "+(r?"":this.initializeBuffer()),o?(o.prepend("return buffer + "),a.add(";")):this.source.push("return buffer;")),e&&this.source.prepend("var "+e.substring(2)+(r?"":`;
`)),this.source.merge()},lookupPropertyFunctionVarDeclaration:function(){return`
      lookupProperty = container.lookupProperty || function(parent, propertyName) {
        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {
          return parent[propertyName];
        }
        return undefined
    }
    `.trim()},blockValue:function(e){var t=this.aliasable("container.hooks.blockHelperMissing"),i=[this.contextName(0)];this.setupHelperArgs(e,0,i);var r=this.popStack();i.splice(1,0,r),this.push(this.source.functionCall(t,"call",i))},ambiguousBlockValue:function(){var e=this.aliasable("container.hooks.blockHelperMissing"),t=[this.contextName(0)];this.setupHelperArgs("",0,t,!0),this.flushInline();var i=this.topStack();t.splice(1,0,i),this.pushSource(["if (!",this.lastHelper,") { ",i," = ",this.source.functionCall(e,"call",t),"}"])},appendContent:function(e){this.pendingContent?e=this.pendingContent+e:this.pendingLocation=this.source.currentLocation,this.pendingContent=e},append:function(){if(this.isInline())this.replaceStack(function(t){return[" != null ? ",t,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var e=this.popStack();this.pushSource(["if (",e," != null) { ",this.appendToBuffer(e,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,t,i,r){var s=0;!r&&this.options.compat&&!this.lastContext?this.push(this.depthedLookup(e[s++])):this.pushContext(),this.resolvePath("context",e,s,t,i)},lookupBlockParam:function(e,t){this.useBlockParams=!0,this.push(["blockParams[",e[0],"][",e[1],"]"]),this.resolvePath("context",t,1)},lookupData:function(e,t,i){e?this.pushStackLiteral("container.data(data, "+e+")"):this.pushStackLiteral("data"),this.resolvePath("data",t,0,!0,i)},resolvePath:function(e,t,i,r,s){var o=this;if(this.options.strict||this.options.assumeObjects){this.push(fv(this.options.strict&&s,this,t,i,e));return}for(var a=t.length;i<a;i++)this.replaceStack(function(d){var c=o.nameLookup(d,t[i],e);return r?[" && ",c]:[" != null ? ",c," : ",d]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(e,t){this.pushContext(),this.pushString(t),t!=="SubExpression"&&(typeof e=="string"?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(e){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(e?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(e.ids)),this.stringParams&&(this.push(this.objectLiteral(e.contexts)),this.push(this.objectLiteral(e.types))),this.push(this.objectLiteral(e.values))},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){e!=null?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},registerDecorator:function(e,t){var i=this.nameLookup("decorators",t,"decorator"),r=this.setupHelperArgs(t,e);this.decorators.push(["fn = ",this.decorators.functionCall(i,"",["fn","props","container",r])," || fn;"])},invokeHelper:function(e,t,i){var r=this.popStack(),s=this.setupHelper(e,t),o=[];i&&o.push(s.name),o.push(r),this.options.strict||o.push(this.aliasable("container.hooks.helperMissing"));var a=["(",this.itemsSeparatedBy(o,"||"),")"],d=this.source.functionCall(a,"call",s.callParams);this.push(d)},itemsSeparatedBy:function(e,t){var i=[];i.push(e[0]);for(var r=1;r<e.length;r++)i.push(t,e[r]);return i},invokeKnownHelper:function(e,t){var i=this.setupHelper(e,t);this.push(this.source.functionCall(i.name,"call",i.callParams))},invokeAmbiguous:function(e,t){this.useRegister("helper");var i=this.popStack();this.emptyHash();var r=this.setupHelper(0,e,t),s=this.lastHelper=this.nameLookup("helpers",e,"helper"),o=["(","(helper = ",s," || ",i,")"];this.options.strict||(o[0]="(helper = ",o.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",o,r.paramsInit?["),(",r.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",r.callParams)," : helper))"])},invokePartial:function(e,t,i){var r=[],s=this.setupParams(t,1,r);e&&(t=this.popStack(),delete s.name),i&&(s.indent=JSON.stringify(i)),s.helpers="helpers",s.partials="partials",s.decorators="container.decorators",e?r.unshift(t):r.unshift(this.nameLookup("partials",t,"partial")),this.options.compat&&(s.depths="depths"),s=this.objectLiteral(s),r.push(s),this.push(this.source.functionCall("container.invokePartial","",r))},assignToHash:function(e){var t=this.popStack(),i=void 0,r=void 0,s=void 0;this.trackIds&&(s=this.popStack()),this.stringParams&&(r=this.popStack(),i=this.popStack());var o=this.hash;i&&(o.contexts[e]=i),r&&(o.types[e]=r),s&&(o.ids[e]=s),o.values[e]=t},pushId:function(e,t,i){e==="BlockParam"?this.pushStackLiteral("blockParams["+t[0]+"].path["+t[1]+"]"+(i?" + "+JSON.stringify("."+i):"")):e==="PathExpression"?this.pushString(t):e==="SubExpression"?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:Qt,compileChildren:function(e,t){for(var i=e.children,r=void 0,s=void 0,o=0,a=i.length;o<a;o++){r=i[o],s=new this.compiler;var d=this.matchExistingProgram(r);if(d==null){this.context.programs.push("");var c=this.context.programs.length;r.index=c,r.name="program"+c,this.context.programs[c]=s.compile(r,t,this.context,!this.precompile),this.context.decorators[c]=s.decorators,this.context.environments[c]=r,this.useDepths=this.useDepths||s.useDepths,this.useBlockParams=this.useBlockParams||s.useBlockParams,r.useDepths=this.useDepths,r.useBlockParams=this.useBlockParams}else r.index=d.index,r.name="program"+d.index,this.useDepths=this.useDepths||d.useDepths,this.useBlockParams=this.useBlockParams||d.useBlockParams}},matchExistingProgram:function(e){for(var t=0,i=this.context.environments.length;t<i;t++){var r=this.context.environments[t];if(r&&r.equals(e))return r}},programExpression:function(e){var t=this.environment.children[e],i=[t.index,"data",t.blockParams];return(this.useBlockParams||this.useDepths)&&i.push("blockParams"),this.useDepths&&i.push("depths"),"container.program("+i.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},push:function(e){return e instanceof Zt||(e=this.source.wrap(e)),this.inlineStack.push(e),e},pushStackLiteral:function(e){this.push(new Zt(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),e&&this.source.push(e)},replaceStack:function(e){var t=["("],i=void 0,r=void 0,s=void 0;if(!this.isInline())throw new oo.default("replaceStack on non-inline");var o=this.popStack(!0);if(o instanceof Zt)i=[o.value],t=["(",i],s=!0;else{r=!0;var a=this.incrStack();t=["((",this.push(a)," = ",o,")"],i=this.topStack()}var d=e.call(this,i);s||this.popStack(),r&&this.stackSlot--,this.push(t.concat(d,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;this.inlineStack=[];for(var t=0,i=e.length;t<i;t++){var r=e[t];if(r instanceof Zt)this.compileStack.push(r);else{var s=this.incrStack();this.pushSource([s," = ",r,";"]),this.compileStack.push(s)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),i=(t?this.inlineStack:this.compileStack).pop();if(!e&&i instanceof Zt)return i.value;if(!t){if(!this.stackSlot)throw new oo.default("Invalid stack pop");this.stackSlot--}return i},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,t=e[e.length-1];return t instanceof Zt?t.value:t},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return this.source.quotedString(e)},objectLiteral:function(e){return this.source.objectLiteral(e)},aliasable:function(e){var t=this.aliases[e];return t?(t.referenceCount++,t):(t=this.aliases[e]=this.source.wrap(e),t.aliasable=!0,t.referenceCount=1,t)},setupHelper:function(e,t,i){var r=[],s=this.setupHelperArgs(t,e,r,i),o=this.nameLookup("helpers",t,"helper"),a=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})");return{params:r,paramsInit:s,name:o,callParams:[a].concat(r)}},setupParams:function(e,t,i){var r={},s=[],o=[],a=[],d=!i,c=void 0;d&&(i=[]),r.name=this.quotedString(e),r.hash=this.popStack(),this.trackIds&&(r.hashIds=this.popStack()),this.stringParams&&(r.hashTypes=this.popStack(),r.hashContexts=this.popStack());var f=this.popStack(),p=this.popStack();(p||f)&&(r.fn=p||"container.noop",r.inverse=f||"container.noop");for(var h=t;h--;)c=this.popStack(),i[h]=c,this.trackIds&&(a[h]=this.popStack()),this.stringParams&&(o[h]=this.popStack(),s[h]=this.popStack());return d&&(r.args=this.source.generateArray(i)),this.trackIds&&(r.ids=this.source.generateArray(a)),this.stringParams&&(r.types=this.source.generateArray(o),r.contexts=this.source.generateArray(s)),this.options.data&&(r.data="data"),this.useBlockParams&&(r.blockParams="blockParams"),r},setupHelperArgs:function(e,t,i,r){var s=this.setupParams(e,t,i);return s.loc=JSON.stringify(this.source.currentLocation),s=this.objectLiteral(s),r?(this.useRegister("options"),i.push("options"),["options=",s]):i?(i.push(s),""):s}};(function(){for(var n="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=Qt.RESERVED_WORDS={},t=0,i=n.length;t<i;t++)e[n[t]]=!0})();Qt.isValidJavaScriptVariableName=function(n){return!Qt.RESERVED_WORDS[n]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(n)};function fv(n,e,t,i,r){var s=e.popStack(),o=t.length;for(n&&o--;i<o;i++)s=e.nameLookup(s,t[i],r);return n?[e.aliasable("container.strict"),"(",s,", ",e.quotedString(t[i]),", ",JSON.stringify(e.source.currentLocation)," )"]:s}sr.default=Qt;ec.exports=sr.default});var lo=V((or,ic)=>{"use strict";or.__esModule=!0;function Ln(n){return n&&n.__esModule?n:{default:n}}var pv=sl(),hv=Ln(pv),mv=Ls(),gv=Ln(mv),ao=Dl(),uo=wl(),yv=tc(),Dv=Ln(yv),vv=Bs(),Cv=Ln(vv),Ev=Is(),wv=Ln(Ev),Fv=hv.default.create;function nc(){var n=Fv();return n.compile=function(e,t){return uo.compile(e,t,n)},n.precompile=function(e,t){return uo.precompile(e,t,n)},n.AST=gv.default,n.Compiler=uo.Compiler,n.JavaScriptCompiler=Dv.default,n.Parser=ao.parser,n.parse=ao.parse,n.parseWithoutProcessing=ao.parseWithoutProcessing,n}var Xt=nc();Xt.create=nc;wv.default(Xt);Xt.Visitor=Cv.default;Xt.default=Xt;or.default=Xt;ic.exports=or.default});var qd=V(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});require("obsidian");var ot=class extends Error{},vo=class extends ot{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}},Co=class extends ot{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}},Eo=class extends ot{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}},kt=class extends ot{},Cr=class extends ot{constructor(e){super(`Invalid unit ${e}`)}},we=class extends ot{},Ke=class extends ot{constructor(){super("Zone is an abstract class")}},b="numeric",We="short",Pe="long",Er={year:b,month:b,day:b},qc={year:b,month:We,day:b},kv={year:b,month:We,day:b,weekday:We},Wc={year:b,month:Pe,day:b},$c={year:b,month:Pe,day:b,weekday:Pe},zc={hour:b,minute:b},Yc={hour:b,minute:b,second:b},Kc={hour:b,minute:b,second:b,timeZoneName:We},Jc={hour:b,minute:b,second:b,timeZoneName:Pe},Zc={hour:b,minute:b,hourCycle:"h23"},Qc={hour:b,minute:b,second:b,hourCycle:"h23"},Xc={hour:b,minute:b,second:b,hourCycle:"h23",timeZoneName:We},jc={hour:b,minute:b,second:b,hourCycle:"h23",timeZoneName:Pe},ed={year:b,month:b,day:b,hour:b,minute:b},td={year:b,month:b,day:b,hour:b,minute:b,second:b},nd={year:b,month:We,day:b,hour:b,minute:b},id={year:b,month:We,day:b,hour:b,minute:b,second:b},bv={year:b,month:We,day:b,weekday:We,hour:b,minute:b},rd={year:b,month:Pe,day:b,hour:b,minute:b,timeZoneName:We},sd={year:b,month:Pe,day:b,hour:b,minute:b,second:b,timeZoneName:We},od={year:b,month:Pe,day:b,weekday:Pe,hour:b,minute:b,timeZoneName:Pe},ad={year:b,month:Pe,day:b,weekday:Pe,hour:b,minute:b,second:b,timeZoneName:Pe},At=class{get type(){throw new Ke}get name(){throw new Ke}get ianaName(){return this.name}get isUniversal(){throw new Ke}offsetName(e,t){throw new Ke}formatOffset(e,t){throw new Ke}offset(e){throw new Ke}equals(e){throw new Ke}get isValid(){throw new Ke}},co=null,wr=class n extends At{static get instance(){return co===null&&(co=new n),co}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:i}){return ld(e,t,i)}formatOffset(e,t){return zn(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}},Dr={};function Iv(n){return Dr[n]||(Dr[n]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),Dr[n]}var Av={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function Nv(n,e){let t=n.format(e).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,r,s,o,a,d,c,f]=i;return[o,r,s,a,d,c,f]}function Rv(n,e){let t=n.formatToParts(e),i=[];for(let r=0;r<t.length;r++){let{type:s,value:o}=t[r],a=Av[s];s==="era"?i[a]=o:q(a)||(i[a]=parseInt(o,10))}return i}var fr={},gt=class n extends At{static create(e){return fr[e]||(fr[e]=new n(e)),fr[e]}static resetCache(){fr={},Dr={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(t){return!1}}constructor(e){super(),this.zoneName=e,this.valid=n.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:i}){return ld(e,t,i,this.name)}formatOffset(e,t){return zn(this.offset(e),t)}offset(e){let t=new Date(e);if(isNaN(t))return NaN;let i=Iv(this.name),[r,s,o,a,d,c,f]=i.formatToParts?Rv(i,t):Nv(i,t);a==="BC"&&(r=-Math.abs(r)+1);let h=br({year:r,month:s,day:o,hour:d===24?0:d,minute:c,second:f,millisecond:0}),g=+t,v=g%1e3;return g-=v>=0?v:1e3+v,(h-g)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}},fc={};function Lv(n,e={}){let t=JSON.stringify([n,e]),i=fc[t];return i||(i=new Intl.ListFormat(n,e),fc[t]=i),i}var wo={};function Fo(n,e={}){let t=JSON.stringify([n,e]),i=wo[t];return i||(i=new Intl.DateTimeFormat(n,e),wo[t]=i),i}var So={};function Ov(n,e={}){let t=JSON.stringify([n,e]),i=So[t];return i||(i=new Intl.NumberFormat(n,e),So[t]=i),i}var To={};function Bv(n,e={}){let{base:t,...i}=e,r=JSON.stringify([n,i]),s=To[r];return s||(s=new Intl.RelativeTimeFormat(n,e),To[r]=s),s}var Wn=null;function Vv(){return Wn||(Wn=new Intl.DateTimeFormat().resolvedOptions().locale,Wn)}function Gv(n){let e=n.indexOf("-x-");e!==-1&&(n=n.substring(0,e));let t=n.indexOf("-u-");if(t===-1)return[n];{let i,r;try{i=Fo(n).resolvedOptions(),r=n}catch(a){let d=n.substring(0,t);i=Fo(d).resolvedOptions(),r=d}let{numberingSystem:s,calendar:o}=i;return[r,s,o]}}function Uv(n,e,t){return(t||e)&&(n.includes("-u-")||(n+="-u"),t&&(n+=`-ca-${t}`),e&&(n+=`-nu-${e}`)),n}function Hv(n){let e=[];for(let t=1;t<=12;t++){let i=G.utc(2009,t,1);e.push(n(i))}return e}function qv(n){let e=[];for(let t=1;t<=7;t++){let i=G.utc(2016,11,13+t);e.push(n(i))}return e}function pr(n,e,t,i){let r=n.listingMode();return r==="error"?null:r==="en"?t(e):i(e)}function Wv(n){return n.numberingSystem&&n.numberingSystem!=="latn"?!1:n.numberingSystem==="latn"||!n.locale||n.locale.startsWith("en")||new Intl.DateTimeFormat(n.intl).resolvedOptions().numberingSystem==="latn"}var Mo=class{constructor(e,t,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;let{padTo:r,floor:s,...o}=i;if(!t||Object.keys(o).length>0){let a={useGrouping:!1,...i};i.padTo>0&&(a.minimumIntegerDigits=i.padTo),this.inf=Ov(e,a)}}format(e){if(this.inf){let t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{let t=this.floor?Math.floor(e):Go(e,3);return re(t,this.padTo)}}},_o=class{constructor(e,t,i){this.opts=i,this.originalZone=void 0;let r;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){let o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&gt.create(a).valid?(r=a,this.dt=e):(r="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,r=e.zone.name):(r="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);let s={...this.opts};s.timeZone=s.timeZone||r,this.dtf=Fo(t,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){let e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(t=>{if(t.type==="timeZoneName"){let i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...t,value:i}}else return t}):e}resolvedOptions(){return this.dtf.resolvedOptions()}},xo=class{constructor(e,t,i){this.opts={style:"long",...i},!t&&ud()&&(this.rtf=Bv(e,i))}format(e,t){return this.rtf?this.rtf.format(e,t):o2(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}},ee=class n{static fromOpts(e){return n.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,t,i,r=!1){let s=e||j.defaultLocale,o=s||(r?"en-US":Vv()),a=t||j.defaultNumberingSystem,d=i||j.defaultOutputCalendar;return new n(o,a,d,s)}static resetCache(){Wn=null,wo={},So={},To={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:i}={}){return n.create(e,t,i)}constructor(e,t,i,r){let[s,o,a]=Gv(e);this.locale=s,this.numberingSystem=t||o||null,this.outputCalendar=i||a||null,this.intl=Uv(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=r,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=Wv(this)),this.fastNumbersCached}listingMode(){let e=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&t?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:n.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1){return pr(this,e,fd,()=>{let i=t?{month:e,day:"numeric"}:{month:e},r=t?"format":"standalone";return this.monthsCache[r][e]||(this.monthsCache[r][e]=Hv(s=>this.extract(s,i,"month"))),this.monthsCache[r][e]})}weekdays(e,t=!1){return pr(this,e,md,()=>{let i=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},r=t?"format":"standalone";return this.weekdaysCache[r][e]||(this.weekdaysCache[r][e]=qv(s=>this.extract(s,i,"weekday"))),this.weekdaysCache[r][e]})}meridiems(){return pr(this,void 0,()=>gd,()=>{if(!this.meridiemCache){let e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[G.utc(2016,11,13,9),G.utc(2016,11,13,19)].map(t=>this.extract(t,e,"dayperiod"))}return this.meridiemCache})}eras(e){return pr(this,e,yd,()=>{let t={era:e};return this.eraCache[e]||(this.eraCache[e]=[G.utc(-40,1,1),G.utc(2017,1,1)].map(i=>this.extract(i,t,"era"))),this.eraCache[e]})}extract(e,t,i){let r=this.dtFormatter(e,t),s=r.formatToParts(),o=s.find(a=>a.type.toLowerCase()===i);return o?o.value:null}numberFormatter(e={}){return new Mo(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new _o(e,this.intl,t)}relFormatter(e={}){return new xo(this.intl,this.isEnglish(),e)}listFormatter(e={}){return Lv(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}},fo=null,Oe=class n extends At{static get utcInstance(){return fo===null&&(fo=new n(0)),fo}static instance(e){return e===0?n.utcInstance:new n(e)}static parseSpecifier(e){if(e){let t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new n(Ir(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${zn(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${zn(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return zn(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}},Po=class extends At{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}};function mt(n,e){if(q(n)||n===null)return e;if(n instanceof At)return n;if($v(n)){let t=n.toLowerCase();return t==="default"?e:t==="local"||t==="system"?wr.instance:t==="utc"||t==="gmt"?Oe.utcInstance:Oe.parseSpecifier(t)||gt.create(n)}else return It(n)?Oe.instance(n):typeof n=="object"&&"offset"in n&&typeof n.offset=="function"?n:new Po(n)}var pc=()=>Date.now(),hc="system",mc=null,gc=null,yc=null,Dc=60,vc,j=class{static get now(){return pc}static set now(e){pc=e}static set defaultZone(e){hc=e}static get defaultZone(){return mt(hc,wr.instance)}static get defaultLocale(){return mc}static set defaultLocale(e){mc=e}static get defaultNumberingSystem(){return gc}static set defaultNumberingSystem(e){gc=e}static get defaultOutputCalendar(){return yc}static set defaultOutputCalendar(e){yc=e}static get twoDigitCutoffYear(){return Dc}static set twoDigitCutoffYear(e){Dc=e%100}static get throwOnInvalid(){return vc}static set throwOnInvalid(e){vc=e}static resetCaches(){ee.resetCache(),gt.resetCache()}};function q(n){return typeof n=="undefined"}function It(n){return typeof n=="number"}function kr(n){return typeof n=="number"&&n%1===0}function $v(n){return typeof n=="string"}function zv(n){return Object.prototype.toString.call(n)==="[object Date]"}function ud(){try{return typeof Intl!="undefined"&&!!Intl.RelativeTimeFormat}catch(n){return!1}}function Yv(n){return Array.isArray(n)?n:[n]}function Cc(n,e,t){if(n.length!==0)return n.reduce((i,r)=>{let s=[e(r),r];return i&&t(i[0],s[0])===i[0]?i:s},null)[1]}function Kv(n,e){return e.reduce((t,i)=>(t[i]=n[i],t),{})}function on(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function st(n,e,t){return kr(n)&&n>=e&&n<=t}function Jv(n,e){return n-e*Math.floor(n/e)}function re(n,e=2){let t=n<0,i;return t?i="-"+(""+-n).padStart(e,"0"):i=(""+n).padStart(e,"0"),i}function ht(n){if(!(q(n)||n===null||n===""))return parseInt(n,10)}function xt(n){if(!(q(n)||n===null||n===""))return parseFloat(n)}function Vo(n){if(!(q(n)||n===null||n==="")){let e=parseFloat("0."+n)*1e3;return Math.floor(e)}}function Go(n,e,t=!1){let i=10**e;return(t?Math.trunc:Math.round)(n*i)/i}function Jn(n){return n%4===0&&(n%100!==0||n%400===0)}function $n(n){return Jn(n)?366:365}function Fr(n,e){let t=Jv(e-1,12)+1,i=n+(e-t)/12;return t===2?Jn(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function br(n){let e=Date.UTC(n.year,n.month-1,n.day,n.hour,n.minute,n.second,n.millisecond);return n.year<100&&n.year>=0&&(e=new Date(e),e.setUTCFullYear(n.year,n.month-1,n.day)),+e}function Sr(n){let e=(n+Math.floor(n/4)-Math.floor(n/100)+Math.floor(n/400))%7,t=n-1,i=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7;return e===4||i===3?53:52}function ko(n){return n>99?n:n>j.twoDigitCutoffYear?1900+n:2e3+n}function ld(n,e,t,i=null){let r=new Date(n),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(s.timeZone=i);let o={timeZoneName:e,...s},a=new Intl.DateTimeFormat(t,o).formatToParts(r).find(d=>d.type.toLowerCase()==="timezonename");return a?a.value:null}function Ir(n,e){let t=parseInt(n,10);Number.isNaN(t)&&(t=0);let i=parseInt(e,10)||0,r=t<0||Object.is(t,-0)?-i:i;return t*60+r}function cd(n){let e=Number(n);if(typeof n=="boolean"||n===""||Number.isNaN(e))throw new we(`Invalid unit value ${n}`);return e}function Tr(n,e){let t={};for(let i in n)if(on(n,i)){let r=n[i];if(r==null)continue;t[e(i)]=cd(r)}return t}function zn(n,e){let t=Math.trunc(Math.abs(n/60)),i=Math.trunc(Math.abs(n%60)),r=n>=0?"+":"-";switch(e){case"short":return`${r}${re(t,2)}:${re(i,2)}`;case"narrow":return`${r}${t}${i>0?`:${i}`:""}`;case"techie":return`${r}${re(t,2)}${re(i,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function Ar(n){return Kv(n,["hour","minute","second","millisecond"])}var Zv=["January","February","March","April","May","June","July","August","September","October","November","December"],dd=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Qv=["J","F","M","A","M","J","J","A","S","O","N","D"];function fd(n){switch(n){case"narrow":return[...Qv];case"short":return[...dd];case"long":return[...Zv];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var pd=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],hd=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Xv=["M","T","W","T","F","S","S"];function md(n){switch(n){case"narrow":return[...Xv];case"short":return[...hd];case"long":return[...pd];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var gd=["AM","PM"],jv=["Before Christ","Anno Domini"],e2=["BC","AD"],t2=["B","A"];function yd(n){switch(n){case"narrow":return[...t2];case"short":return[...e2];case"long":return[...jv];default:return null}}function n2(n){return gd[n.hour<12?0:1]}function i2(n,e){return md(e)[n.weekday-1]}function r2(n,e){return fd(e)[n.month-1]}function s2(n,e){return yd(e)[n.year<0?0:1]}function o2(n,e,t="always",i=!1){let r={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(n)===-1;if(t==="auto"&&s){let p=n==="days";switch(e){case 1:return p?"tomorrow":`next ${r[n][0]}`;case-1:return p?"yesterday":`last ${r[n][0]}`;case 0:return p?"today":`this ${r[n][0]}`}}let o=Object.is(e,-0)||e<0,a=Math.abs(e),d=a===1,c=r[n],f=i?d?c[1]:c[2]||c[1]:d?r[n][0]:n;return o?`${a} ${f} ago`:`in ${a} ${f}`}function Ec(n,e){let t="";for(let i of n)i.literal?t+=i.val:t+=e(i.val);return t}var a2={D:Er,DD:qc,DDD:Wc,DDDD:$c,t:zc,tt:Yc,ttt:Kc,tttt:Jc,T:Zc,TT:Qc,TTT:Xc,TTTT:jc,f:ed,ff:nd,fff:rd,ffff:od,F:td,FF:id,FFF:sd,FFFF:ad},_e=class n{static create(e,t={}){return new n(e,t)}static parseFormat(e){let t=null,i="",r=!1,s=[];for(let o=0;o<e.length;o++){let a=e.charAt(o);a==="'"?(i.length>0&&s.push({literal:r||/^\s+$/.test(i),val:i}),t=null,i="",r=!r):r||a===t?i+=a:(i.length>0&&s.push({literal:/^\s+$/.test(i),val:i}),i=a,t=a)}return i.length>0&&s.push({literal:r||/^\s+$/.test(i),val:i}),s}static macroTokenToFormatOpts(e){return a2[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}dtFormatter(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t})}formatDateTime(e,t){return this.dtFormatter(e,t).format()}formatDateTimeParts(e,t){return this.dtFormatter(e,t).formatToParts()}formatInterval(e,t){return this.dtFormatter(e.start,t).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t){return this.dtFormatter(e,t).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return re(e,t);let i={...this.opts};return t>0&&(i.padTo=t),this.loc.numberFormatter(i).format(e)}formatDateTimeFromString(e,t){let i=this.loc.listingMode()==="en",r=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(g,v)=>this.loc.extract(e,g,v),o=g=>e.isOffsetFixed&&e.offset===0&&g.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,g.format):"",a=()=>i?n2(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),d=(g,v)=>i?r2(e,g):s(v?{month:g}:{month:g,day:"numeric"},"month"),c=(g,v)=>i?i2(e,g):s(v?{weekday:g}:{weekday:g,month:"long",day:"numeric"},"weekday"),f=g=>{let v=n.macroTokenToFormatOpts(g);return v?this.formatWithSystemDefault(e,v):g},p=g=>i?s2(e,g):s({era:g},"era"),h=g=>{switch(g){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return r?s({day:"numeric"},"day"):this.num(e.day);case"dd":return r?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return r?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return r?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return d("short",!0);case"LLLL":return d("long",!0);case"LLLLL":return d("narrow",!0);case"M":return r?s({month:"numeric"},"month"):this.num(e.month);case"MM":return r?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return d("short",!1);case"MMMM":return d("long",!1);case"MMMMM":return d("narrow",!1);case"y":return r?s({year:"numeric"},"year"):this.num(e.year);case"yy":return r?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return r?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return r?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return p("short");case"GG":return p("long");case"GGGGG":return p("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return f(g)}};return Ec(n.parseFormat(t),h)}formatDurationFromString(e,t){let i=d=>{switch(d[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},r=d=>c=>{let f=i(c);return f?this.num(d.get(f),c.length):c},s=n.parseFormat(t),o=s.reduce((d,{literal:c,val:f})=>c?d:d.concat(f),[]),a=e.shiftTo(...o.map(i).filter(d=>d));return Ec(s,r(a))}},xe=class{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}},Dd=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function an(...n){let e=n.reduce((t,i)=>t+i.source,"");return RegExp(`^${e}$`)}function un(...n){return e=>n.reduce(([t,i,r],s)=>{let[o,a,d]=s(e,r);return[{...t,...o},a||i,d]},[{},null,1]).slice(0,2)}function ln(n,...e){if(n==null)return[null,null];for(let[t,i]of e){let r=t.exec(n);if(r)return i(r)}return[null,null]}function vd(...n){return(e,t)=>{let i={},r;for(r=0;r<n.length;r++)i[n[r]]=ht(e[t+r]);return[i,null,t+r]}}var Cd=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,u2=`(?:${Cd.source}?(?:\\[(${Dd.source})\\])?)?`,Uo=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Ed=RegExp(`${Uo.source}${u2}`),Ho=RegExp(`(?:T${Ed.source})?`),l2=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,c2=/(\d{4})-?W(\d\d)(?:-?(\d))?/,d2=/(\d{4})-?(\d{3})/,f2=vd("weekYear","weekNumber","weekDay"),p2=vd("year","ordinal"),h2=/(\d{4})-(\d\d)-(\d\d)/,wd=RegExp(`${Uo.source} ?(?:${Cd.source}|(${Dd.source}))?`),m2=RegExp(`(?: ${wd.source})?`);function rn(n,e,t){let i=n[e];return q(i)?t:ht(i)}function g2(n,e){return[{year:rn(n,e),month:rn(n,e+1,1),day:rn(n,e+2,1)},null,e+3]}function cn(n,e){return[{hours:rn(n,e,0),minutes:rn(n,e+1,0),seconds:rn(n,e+2,0),milliseconds:Vo(n[e+3])},null,e+4]}function Zn(n,e){let t=!n[e]&&!n[e+1],i=Ir(n[e+1],n[e+2]),r=t?null:Oe.instance(i);return[{},r,e+3]}function Qn(n,e){let t=n[e]?gt.create(n[e]):null;return[{},t,e+1]}var y2=RegExp(`^T?${Uo.source}$`),D2=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function v2(n){let[e,t,i,r,s,o,a,d,c]=n,f=e[0]==="-",p=d&&d[0]==="-",h=(g,v=!1)=>g!==void 0&&(v||g&&f)?-g:g;return[{years:h(xt(t)),months:h(xt(i)),weeks:h(xt(r)),days:h(xt(s)),hours:h(xt(o)),minutes:h(xt(a)),seconds:h(xt(d),d==="-0"),milliseconds:h(Vo(c),p)}]}var C2={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function qo(n,e,t,i,r,s,o){let a={year:e.length===2?ko(ht(e)):ht(e),month:dd.indexOf(t)+1,day:ht(i),hour:ht(r),minute:ht(s)};return o&&(a.second=ht(o)),n&&(a.weekday=n.length>3?pd.indexOf(n)+1:hd.indexOf(n)+1),a}var E2=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function w2(n){let[,e,t,i,r,s,o,a,d,c,f,p]=n,h=qo(e,r,i,t,s,o,a),g;return d?g=C2[d]:c?g=0:g=Ir(f,p),[h,new Oe(g)]}function F2(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}var S2=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,T2=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,M2=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function wc(n){let[,e,t,i,r,s,o,a]=n;return[qo(e,r,i,t,s,o,a),Oe.utcInstance]}function _2(n){let[,e,t,i,r,s,o,a]=n;return[qo(e,a,t,i,r,s,o),Oe.utcInstance]}var x2=an(l2,Ho),P2=an(c2,Ho),k2=an(d2,Ho),b2=an(Ed),Fd=un(g2,cn,Zn,Qn),I2=un(f2,cn,Zn,Qn),A2=un(p2,cn,Zn,Qn),N2=un(cn,Zn,Qn);function R2(n){return ln(n,[x2,Fd],[P2,I2],[k2,A2],[b2,N2])}function L2(n){return ln(F2(n),[E2,w2])}function O2(n){return ln(n,[S2,wc],[T2,wc],[M2,_2])}function B2(n){return ln(n,[D2,v2])}var V2=un(cn);function G2(n){return ln(n,[y2,V2])}var U2=an(h2,m2),H2=an(wd),q2=un(cn,Zn,Qn);function W2(n){return ln(n,[U2,Fd],[H2,q2])}var Fc="Invalid Duration",Sd={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},$2={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...Sd},Re=146097/400,en=146097/4800,z2={years:{quarters:4,months:12,weeks:Re/7,days:Re,hours:Re*24,minutes:Re*24*60,seconds:Re*24*60*60,milliseconds:Re*24*60*60*1e3},quarters:{months:3,weeks:Re/28,days:Re/4,hours:Re*24/4,minutes:Re*24*60/4,seconds:Re*24*60*60/4,milliseconds:Re*24*60*60*1e3/4},months:{weeks:en/7,days:en,hours:en*24,minutes:en*24*60,seconds:en*24*60*60,milliseconds:en*24*60*60*1e3},...Sd},bt=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Y2=bt.slice(0).reverse();function pt(n,e,t=!1){let i={values:t?e.values:{...n.values,...e.values||{}},loc:n.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||n.conversionAccuracy,matrix:e.matrix||n.matrix};return new R(i)}function Td(n,e){var i;let t=(i=e.milliseconds)!=null?i:0;for(let r of Y2.slice(1))e[r]&&(t+=e[r]*n[r].milliseconds);return t}function Sc(n,e){let t=Td(n,e)<0?-1:1;bt.reduceRight((i,r)=>{if(q(e[r]))return i;if(i){let s=e[i]*t,o=n[r][i],a=Math.floor(s/o);e[r]+=a*t,e[i]-=a*o*t}return r},null),bt.reduce((i,r)=>{if(q(e[r]))return i;if(i){let s=e[i]%1;e[i]-=s,e[r]+=s*n[i][r]}return r},null)}function K2(n){let e={};for(let[t,i]of Object.entries(n))i!==0&&(e[t]=i);return e}var R=class n{constructor(e){let t=e.conversionAccuracy==="longterm"||!1,i=t?z2:$2;e.matrix&&(i=e.matrix),this.values=e.values,this.loc=e.loc||ee.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(e,t){return n.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(e==null||typeof e!="object")throw new we(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new n({values:Tr(e,n.normalizeUnit),loc:ee.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(It(e))return n.fromMillis(e);if(n.isDuration(e))return e;if(typeof e=="object")return n.fromObject(e);throw new we(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){let[i]=B2(e);return i?n.fromObject(i,t):n.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){let[i]=G2(e);return i?n.fromObject(i,t):n.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new we("need to specify a reason the Duration is invalid");let i=e instanceof xe?e:new xe(e,t);if(j.throwOnInvalid)throw new Eo(i);return new n({invalid:i})}static normalizeUnit(e){let t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!t)throw new Cr(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){let i={...t,floor:t.round!==!1&&t.floor!==!1};return this.isValid?_e.create(this.loc,i).formatDurationFromString(this,e):Fc}toHuman(e={}){if(!this.isValid)return Fc;let t=bt.map(i=>{let r=this.values[i];return q(r)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:i.slice(0,-1)}).format(r)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=Go(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;let t=this.toMillis();return t<0||t>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},G.fromMillis(t,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.isValid?Td(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;let t=n.fromDurationLike(e),i={};for(let r of bt)(on(t.values,r)||on(this.values,r))&&(i[r]=t.get(r)+this.get(r));return pt(this,{values:i},!0)}minus(e){if(!this.isValid)return this;let t=n.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;let t={};for(let i of Object.keys(this.values))t[i]=cd(e(this.values[i],i));return pt(this,{values:t},!0)}get(e){return this[n.normalizeUnit(e)]}set(e){if(!this.isValid)return this;let t={...this.values,...Tr(e,n.normalizeUnit)};return pt(this,{values:t})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:i,matrix:r}={}){let o={loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:r,conversionAccuracy:i};return pt(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;let e=this.toObject();return Sc(this.matrix,e),pt(this,{values:e},!0)}rescale(){if(!this.isValid)return this;let e=K2(this.normalize().shiftToAll().toObject());return pt(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>n.normalizeUnit(o));let t={},i={},r=this.toObject(),s;for(let o of bt)if(e.indexOf(o)>=0){s=o;let a=0;for(let c in i)a+=this.matrix[c][o]*i[c],i[c]=0;It(r[o])&&(a+=r[o]);let d=Math.trunc(a);t[o]=d,i[o]=(a*1e3-d*1e3)/1e3}else It(r[o])&&(i[o]=r[o]);for(let o in i)i[o]!==0&&(t[s]+=o===s?i[o]:i[o]/this.matrix[s][o]);return Sc(this.matrix,t),pt(this,{values:t},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;let e={};for(let t of Object.keys(this.values))e[t]=this.values[t]===0?0:-this.values[t];return pt(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function t(i,r){return i===void 0||i===0?r===void 0||r===0:i===r}for(let i of bt)if(!t(this.values[i],e.values[i]))return!1;return!0}},tn="Invalid Interval";function J2(n,e){return!n||!n.isValid?sn.invalid("missing or invalid start"):!e||!e.isValid?sn.invalid("missing or invalid end"):e<n?sn.invalid("end before start",`The end of an interval must be after its start, but you had start=${n.toISO()} and end=${e.toISO()}`):null}var sn=class n{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new we("need to specify a reason the Interval is invalid");let i=e instanceof xe?e:new xe(e,t);if(j.throwOnInvalid)throw new Co(i);return new n({invalid:i})}static fromDateTimes(e,t){let i=Hn(e),r=Hn(t),s=J2(i,r);return s==null?new n({start:i,end:r}):s}static after(e,t){let i=R.fromDurationLike(t),r=Hn(e);return n.fromDateTimes(r,r.plus(i))}static before(e,t){let i=R.fromDurationLike(t),r=Hn(e);return n.fromDateTimes(r.minus(i),r)}static fromISO(e,t){let[i,r]=(e||"").split("/",2);if(i&&r){let s,o;try{s=G.fromISO(i,t),o=s.isValid}catch(c){o=!1}let a,d;try{a=G.fromISO(r,t),d=a.isValid}catch(c){d=!1}if(o&&d)return n.fromDateTimes(s,a);if(o){let c=R.fromISO(r,t);if(c.isValid)return n.after(s,c)}else if(d){let c=R.fromISO(i,t);if(c.isValid)return n.before(a,c)}}return n.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;let t=this.start.startOf(e),i=this.end.startOf(e);return Math.floor(i.diff(t,e).get(e))+(i.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:t}={}){return this.isValid?n.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];let t=e.map(Hn).filter(o=>this.contains(o)).sort(),i=[],{s:r}=this,s=0;for(;r<this.e;){let o=t[s]||this.e,a=+o>+this.e?this.e:o;i.push(n.fromDateTimes(r,a)),r=a,s+=1}return i}splitBy(e){let t=R.fromDurationLike(e);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s:i}=this,r=1,s,o=[];for(;i<this.e;){let a=this.start.plus(t.mapUnits(d=>d*r));s=+a>+this.e?this.e:a,o.push(n.fromDateTimes(i,s)),i=s,r+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;let t=this.s>e.s?this.s:e.s,i=this.e<e.e?this.e:e.e;return t>=i?null:n.fromDateTimes(t,i)}union(e){if(!this.isValid)return this;let t=this.s<e.s?this.s:e.s,i=this.e>e.e?this.e:e.e;return n.fromDateTimes(t,i)}static merge(e){let[t,i]=e.sort((r,s)=>r.s-s.s).reduce(([r,s],o)=>s?s.overlaps(o)||s.abutsStart(o)?[r,s.union(o)]:[r.concat([s]),o]:[r,o],[[],null]);return i&&t.push(i),t}static xor(e){let t=null,i=0,r=[],s=e.map(d=>[{time:d.s,type:"s"},{time:d.e,type:"e"}]),o=Array.prototype.concat(...s),a=o.sort((d,c)=>d.time-c.time);for(let d of a)i+=d.type==="s"?1:-1,i===1?t=d.time:(t&&+t!=+d.time&&r.push(n.fromDateTimes(t,d.time)),t=null);return n.merge(r)}difference(...e){return n.xor([this].concat(e)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:tn}toLocaleString(e=Er,t={}){return this.isValid?_e.create(this.s.loc.clone(t),e).formatInterval(this):tn}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:tn}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:tn}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:tn}toFormat(e,{separator:t=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:tn}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):R.invalid(this.invalidReason)}mapEndpoints(e){return n.fromDateTimes(e(this.s),e(this.e))}},nn=class{static hasDST(e=j.defaultZone){let t=G.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return gt.isValidZone(e)}static normalizeZone(e){return mt(e,j.defaultZone)}static months(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null,outputCalendar:s="gregory"}={}){return(r||ee.create(t,i,s)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null,outputCalendar:s="gregory"}={}){return(r||ee.create(t,i,s)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null}={}){return(r||ee.create(t,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null}={}){return(r||ee.create(t,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return ee.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return ee.create(t,null,"gregory").eras(e)}static features(){return{relative:ud()}}};function Tc(n,e){let t=r=>r.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=t(e)-t(n);return Math.floor(R.fromMillis(i).as("days"))}function Z2(n,e,t){let i=[["years",(d,c)=>c.year-d.year],["quarters",(d,c)=>c.quarter-d.quarter+(c.year-d.year)*4],["months",(d,c)=>c.month-d.month+(c.year-d.year)*12],["weeks",(d,c)=>{let f=Tc(d,c);return(f-f%7)/7}],["days",Tc]],r={},s=n,o,a;for(let[d,c]of i)t.indexOf(d)>=0&&(o=d,r[d]=c(n,e),a=s.plus(r),a>e?(r[d]--,n=s.plus(r),n>e&&(a=n,r[d]--,n=s.plus(r))):n=a);return[n,r,a,o]}function Q2(n,e,t,i){let[r,s,o,a]=Z2(n,e,t),d=e-r,c=t.filter(p=>["hours","minutes","seconds","milliseconds"].indexOf(p)>=0);c.length===0&&(o<e&&(o=r.plus({[a]:1})),o!==r&&(s[a]=(s[a]||0)+d/(o-r)));let f=R.fromObject(s,i);return c.length>0?R.fromMillis(d,i).shiftTo(...c).plus(f):f}var Wo={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[\u3007|\u4E00|\u4E8C|\u4E09|\u56DB|\u4E94|\u516D|\u4E03|\u516B|\u4E5D]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d"},Mc={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},X2=Wo.hanidec.replace(/[\[|\]]/g,"").split("");function j2(n){let e=parseInt(n,10);if(isNaN(e)){e="";for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(n[t].search(Wo.hanidec)!==-1)e+=X2.indexOf(n[t]);else for(let r in Mc){let[s,o]=Mc[r];i>=s&&i<=o&&(e+=i-s)}}return parseInt(e,10)}else return e}function Ue({numberingSystem:n},e=""){return new RegExp(`${Wo[n||"latn"]}${e}`)}var eC="missing Intl.DateTimeFormat.formatToParts support";function z(n,e=t=>t){return{regex:n,deser:([t])=>e(j2(t))}}var tC="\xA0",Md=`[ ${tC}]`,_d=new RegExp(Md,"g");function nC(n){return n.replace(/\./g,"\\.?").replace(_d,Md)}function _c(n){return n.replace(/\./g,"").replace(_d," ").toLowerCase()}function He(n,e){return n===null?null:{regex:RegExp(n.map(nC).join("|")),deser:([t])=>n.findIndex(i=>_c(t)===_c(i))+e}}function xc(n,e){return{regex:n,deser:([,t,i])=>Ir(t,i),groups:e}}function hr(n){return{regex:n,deser:([e])=>e}}function iC(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function rC(n,e){let t=Ue(e),i=Ue(e,"{2}"),r=Ue(e,"{3}"),s=Ue(e,"{4}"),o=Ue(e,"{6}"),a=Ue(e,"{1,2}"),d=Ue(e,"{1,3}"),c=Ue(e,"{1,6}"),f=Ue(e,"{1,9}"),p=Ue(e,"{2,4}"),h=Ue(e,"{4,6}"),g=S=>({regex:RegExp(iC(S.val)),deser:([x])=>x,literal:!0}),w=(S=>{if(n.literal)return g(S);switch(S.val){case"G":return He(e.eras("short"),0);case"GG":return He(e.eras("long"),0);case"y":return z(c);case"yy":return z(p,ko);case"yyyy":return z(s);case"yyyyy":return z(h);case"yyyyyy":return z(o);case"M":return z(a);case"MM":return z(i);case"MMM":return He(e.months("short",!0),1);case"MMMM":return He(e.months("long",!0),1);case"L":return z(a);case"LL":return z(i);case"LLL":return He(e.months("short",!1),1);case"LLLL":return He(e.months("long",!1),1);case"d":return z(a);case"dd":return z(i);case"o":return z(d);case"ooo":return z(r);case"HH":return z(i);case"H":return z(a);case"hh":return z(i);case"h":return z(a);case"mm":return z(i);case"m":return z(a);case"q":return z(a);case"qq":return z(i);case"s":return z(a);case"ss":return z(i);case"S":return z(d);case"SSS":return z(r);case"u":return hr(f);case"uu":return hr(a);case"uuu":return z(t);case"a":return He(e.meridiems(),0);case"kkkk":return z(s);case"kk":return z(p,ko);case"W":return z(a);case"WW":return z(i);case"E":case"c":return z(t);case"EEE":return He(e.weekdays("short",!1),1);case"EEEE":return He(e.weekdays("long",!1),1);case"ccc":return He(e.weekdays("short",!0),1);case"cccc":return He(e.weekdays("long",!0),1);case"Z":case"ZZ":return xc(new RegExp(`([+-]${a.source})(?::(${i.source}))?`),2);case"ZZZ":return xc(new RegExp(`([+-]${a.source})(${i.source})?`),2);case"z":return hr(/[a-z_+-/]{1,256}?/i);case" ":return hr(/[^\S\n\r]/);default:return g(S)}})(n)||{invalidReason:eC};return w.token=n,w}var sC={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function oC(n,e,t){let{type:i,value:r}=n;if(i==="literal"){let d=/^\s+$/.test(r);return{literal:!d,val:d?" ":r}}let s=e[i],o=i;i==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=t.hour12?"hour12":"hour24");let a=sC[o];if(typeof a=="object"&&(a=a[s]),a)return{literal:!1,val:a}}function aC(n){return[`^${n.map(t=>t.regex).reduce((t,i)=>`${t}(${i.source})`,"")}$`,n]}function uC(n,e,t){let i=n.match(e);if(i){let r={},s=1;for(let o in t)if(on(t,o)){let a=t[o],d=a.groups?a.groups+1:1;!a.literal&&a.token&&(r[a.token.val[0]]=a.deser(i.slice(s,s+d))),s+=d}return[i,r]}else return[i,{}]}function lC(n){let e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}},t=null,i;return q(n.z)||(t=gt.create(n.z)),q(n.Z)||(t||(t=new Oe(n.Z)),i=n.Z),q(n.q)||(n.M=(n.q-1)*3+1),q(n.h)||(n.h<12&&n.a===1?n.h+=12:n.h===12&&n.a===0&&(n.h=0)),n.G===0&&n.y&&(n.y=-n.y),q(n.u)||(n.S=Vo(n.u)),[Object.keys(n).reduce((s,o)=>{let a=e(o);return a&&(s[a]=n[o]),s},{}),t,i]}var po=null;function cC(){return po||(po=G.fromMillis(1555555555555)),po}function dC(n,e){if(n.literal)return n;let t=_e.macroTokenToFormatOpts(n.val),i=kd(t,e);return i==null||i.includes(void 0)?n:i}function xd(n,e){return Array.prototype.concat(...n.map(t=>dC(t,e)))}function Pd(n,e,t){let i=xd(_e.parseFormat(t),n),r=i.map(o=>rC(o,n)),s=r.find(o=>o.invalidReason);if(s)return{input:e,tokens:i,invalidReason:s.invalidReason};{let[o,a]=aC(r),d=RegExp(o,"i"),[c,f]=uC(e,d,a),[p,h,g]=f?lC(f):[null,null,void 0];if(on(f,"a")&&on(f,"H"))throw new kt("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:i,regex:d,rawMatches:c,matches:f,result:p,zone:h,specificOffset:g}}}function fC(n,e,t){let{result:i,zone:r,specificOffset:s,invalidReason:o}=Pd(n,e,t);return[i,r,s,o]}function kd(n,e){if(!n)return null;let i=_e.create(e,n).dtFormatter(cC()),r=i.formatToParts(),s=i.resolvedOptions();return r.map(o=>oC(o,n,s))}var bd=[0,31,59,90,120,151,181,212,243,273,304,334],Id=[0,31,60,91,121,152,182,213,244,274,305,335];function Le(n,e){return new xe("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${n}, which is invalid`)}function Ad(n,e,t){let i=new Date(Date.UTC(n,e-1,t));n<100&&n>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);let r=i.getUTCDay();return r===0?7:r}function Nd(n,e,t){return t+(Jn(n)?Id:bd)[e-1]}function Rd(n,e){let t=Jn(n)?Id:bd,i=t.findIndex(s=>s<e),r=e-t[i];return{month:i+1,day:r}}function bo(n){let{year:e,month:t,day:i}=n,r=Nd(e,t,i),s=Ad(e,t,i),o=Math.floor((r-s+10)/7),a;return o<1?(a=e-1,o=Sr(a)):o>Sr(e)?(a=e+1,o=1):a=e,{weekYear:a,weekNumber:o,weekday:s,...Ar(n)}}function Pc(n){let{weekYear:e,weekNumber:t,weekday:i}=n,r=Ad(e,1,4),s=$n(e),o=t*7+i-r-3,a;o<1?(a=e-1,o+=$n(a)):o>s?(a=e+1,o-=$n(e)):a=e;let{month:d,day:c}=Rd(a,o);return{year:a,month:d,day:c,...Ar(n)}}function ho(n){let{year:e,month:t,day:i}=n,r=Nd(e,t,i);return{year:e,ordinal:r,...Ar(n)}}function kc(n){let{year:e,ordinal:t}=n,{month:i,day:r}=Rd(e,t);return{year:e,month:i,day:r,...Ar(n)}}function pC(n){let e=kr(n.weekYear),t=st(n.weekNumber,1,Sr(n.weekYear)),i=st(n.weekday,1,7);return e?t?i?!1:Le("weekday",n.weekday):Le("week",n.week):Le("weekYear",n.weekYear)}function hC(n){let e=kr(n.year),t=st(n.ordinal,1,$n(n.year));return e?t?!1:Le("ordinal",n.ordinal):Le("year",n.year)}function Ld(n){let e=kr(n.year),t=st(n.month,1,12),i=st(n.day,1,Fr(n.year,n.month));return e?t?i?!1:Le("day",n.day):Le("month",n.month):Le("year",n.year)}function Od(n){let{hour:e,minute:t,second:i,millisecond:r}=n,s=st(e,0,23)||e===24&&t===0&&i===0&&r===0,o=st(t,0,59),a=st(i,0,59),d=st(r,0,999);return s?o?a?d?!1:Le("millisecond",r):Le("second",i):Le("minute",t):Le("hour",e)}var mo="Invalid DateTime",bc=864e13;function mr(n){return new xe("unsupported zone",`the zone "${n.name}" is not supported`)}function go(n){return n.weekData===null&&(n.weekData=bo(n.c)),n.weekData}function Pt(n,e){let t={ts:n.ts,zone:n.zone,c:n.c,o:n.o,loc:n.loc,invalid:n.invalid};return new G({...t,...e,old:t})}function Bd(n,e,t){let i=n-e*60*1e3,r=t.offset(i);if(e===r)return[i,e];i-=(r-e)*60*1e3;let s=t.offset(i);return r===s?[i,r]:[n-Math.min(r,s)*60*1e3,Math.max(r,s)]}function gr(n,e){n+=e*60*1e3;let t=new Date(n);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function vr(n,e,t){return Bd(br(n),e,t)}function Ic(n,e){let t=n.o,i=n.c.year+Math.trunc(e.years),r=n.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...n.c,year:i,month:r,day:Math.min(n.c.day,Fr(i,r))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=R.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=br(s),[d,c]=Bd(a,t,n.zone);return o!==0&&(d+=o,c=n.zone.offset(d)),{ts:d,o:c}}function Un(n,e,t,i,r,s){let{setZone:o,zone:a}=t;if(n&&Object.keys(n).length!==0||e){let d=e||a,c=G.fromObject(n,{...t,zone:d,specificOffset:s});return o?c:c.setZone(a)}else return G.invalid(new xe("unparsable",`the input "${r}" can't be parsed as ${i}`))}function yr(n,e,t=!0){return n.isValid?_e.create(ee.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(n,e):null}function yo(n,e){let t=n.c.year>9999||n.c.year<0,i="";return t&&n.c.year>=0&&(i+="+"),i+=re(n.c.year,t?6:4),e?(i+="-",i+=re(n.c.month),i+="-",i+=re(n.c.day)):(i+=re(n.c.month),i+=re(n.c.day)),i}function Ac(n,e,t,i,r,s){let o=re(n.c.hour);return e?(o+=":",o+=re(n.c.minute),(n.c.millisecond!==0||n.c.second!==0||!t)&&(o+=":")):o+=re(n.c.minute),(n.c.millisecond!==0||n.c.second!==0||!t)&&(o+=re(n.c.second),(n.c.millisecond!==0||!i)&&(o+=".",o+=re(n.c.millisecond,3))),r&&(n.isOffsetFixed&&n.offset===0&&!s?o+="Z":n.o<0?(o+="-",o+=re(Math.trunc(-n.o/60)),o+=":",o+=re(Math.trunc(-n.o%60))):(o+="+",o+=re(Math.trunc(n.o/60)),o+=":",o+=re(Math.trunc(n.o%60)))),s&&(o+="["+n.zone.ianaName+"]"),o}var Vd={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},mC={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},gC={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Gd=["year","month","day","hour","minute","second","millisecond"],yC=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],DC=["year","ordinal","hour","minute","second","millisecond"];function Nc(n){let e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[n.toLowerCase()];if(!e)throw new Cr(n);return e}function Rc(n,e){let t=mt(e.zone,j.defaultZone),i=ee.fromObject(e),r=j.now(),s,o;if(q(n.year))s=r;else{for(let c of Gd)q(n[c])&&(n[c]=Vd[c]);let a=Ld(n)||Od(n);if(a)return G.invalid(a);let d=t.offset(r);[s,o]=vr(n,d,t)}return new G({ts:s,zone:t,loc:i,o})}function Lc(n,e,t){let i=q(t.round)?!0:t.round,r=(o,a)=>(o=Go(o,i||t.calendary?0:2,!0),e.loc.clone(t).relFormatter(t).format(o,a)),s=o=>t.calendary?e.hasSame(n,o)?0:e.startOf(o).diff(n.startOf(o),o).get(o):e.diff(n,o).get(o);if(t.unit)return r(s(t.unit),t.unit);for(let o of t.units){let a=s(o);if(Math.abs(a)>=1)return r(a,o)}return r(n>e?-0:0,t.units[t.units.length-1])}function Oc(n){let e={},t;return n.length>0&&typeof n[n.length-1]=="object"?(e=n[n.length-1],t=Array.from(n).slice(0,n.length-1)):t=Array.from(n),[e,t]}var G=class n{constructor(e){let t=e.zone||j.defaultZone,i=e.invalid||(Number.isNaN(e.ts)?new xe("invalid input"):null)||(t.isValid?null:mr(t));this.ts=q(e.ts)?j.now():e.ts;let r=null,s=null;if(!i)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[r,s]=[e.old.c,e.old.o];else{let a=t.offset(this.ts);r=gr(this.ts,a),i=Number.isNaN(r.year)?new xe("invalid input"):null,r=i?null:r,s=i?null:a}this._zone=t,this.loc=e.loc||ee.create(),this.invalid=i,this.weekData=null,this.c=r,this.o=s,this.isLuxonDateTime=!0}static now(){return new n({})}static local(){let[e,t]=Oc(arguments),[i,r,s,o,a,d,c]=t;return Rc({year:i,month:r,day:s,hour:o,minute:a,second:d,millisecond:c},e)}static utc(){let[e,t]=Oc(arguments),[i,r,s,o,a,d,c]=t;return e.zone=Oe.utcInstance,Rc({year:i,month:r,day:s,hour:o,minute:a,second:d,millisecond:c},e)}static fromJSDate(e,t={}){let i=zv(e)?e.valueOf():NaN;if(Number.isNaN(i))return n.invalid("invalid input");let r=mt(t.zone,j.defaultZone);return r.isValid?new n({ts:i,zone:r,loc:ee.fromObject(t)}):n.invalid(mr(r))}static fromMillis(e,t={}){if(It(e))return e<-bc||e>bc?n.invalid("Timestamp out of range"):new n({ts:e,zone:mt(t.zone,j.defaultZone),loc:ee.fromObject(t)});throw new we(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(It(e))return new n({ts:e*1e3,zone:mt(t.zone,j.defaultZone),loc:ee.fromObject(t)});throw new we("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};let i=mt(t.zone,j.defaultZone);if(!i.isValid)return n.invalid(mr(i));let r=j.now(),s=q(t.specificOffset)?i.offset(r):t.specificOffset,o=Tr(e,Nc),a=!q(o.ordinal),d=!q(o.year),c=!q(o.month)||!q(o.day),f=d||c,p=o.weekYear||o.weekNumber,h=ee.fromObject(t);if((f||a)&&p)throw new kt("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(c&&a)throw new kt("Can't mix ordinal dates with month/day");let g=p||o.weekday&&!f,v,w,S=gr(r,s);g?(v=yC,w=mC,S=bo(S)):a?(v=DC,w=gC,S=ho(S)):(v=Gd,w=Vd);let x=!1;for(let N of v){let $=o[N];q($)?x?o[N]=w[N]:o[N]=S[N]:x=!0}let I=g?pC(o):a?hC(o):Ld(o),L=I||Od(o);if(L)return n.invalid(L);let C=g?Pc(o):a?kc(o):o,[P,O]=vr(C,s,i),T=new n({ts:P,zone:i,o:O,loc:h});return o.weekday&&f&&e.weekday!==T.weekday?n.invalid("mismatched weekday",`you can't specify both a weekday of ${o.weekday} and a date of ${T.toISO()}`):T}static fromISO(e,t={}){let[i,r]=R2(e);return Un(i,r,t,"ISO 8601",e)}static fromRFC2822(e,t={}){let[i,r]=L2(e);return Un(i,r,t,"RFC 2822",e)}static fromHTTP(e,t={}){let[i,r]=O2(e);return Un(i,r,t,"HTTP",t)}static fromFormat(e,t,i={}){if(q(e)||q(t))throw new we("fromFormat requires an input string and a format");let{locale:r=null,numberingSystem:s=null}=i,o=ee.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0}),[a,d,c,f]=fC(o,e,t);return f?n.invalid(f):Un(a,d,i,`format ${t}`,e,c)}static fromString(e,t,i={}){return n.fromFormat(e,t,i)}static fromSQL(e,t={}){let[i,r]=W2(e);return Un(i,r,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new we("need to specify a reason the DateTime is invalid");let i=e instanceof xe?e:new xe(e,t);if(j.throwOnInvalid)throw new vo(i);return new n({invalid:i})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){let i=kd(e,ee.fromObject(t));return i?i.map(r=>r?r.val:null).join(""):null}static expandFormat(e,t={}){return xd(_e.parseFormat(e),ee.fromObject(t)).map(r=>r.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?go(this).weekYear:NaN}get weekNumber(){return this.isValid?go(this).weekNumber:NaN}get weekday(){return this.isValid?go(this).weekday:NaN}get ordinal(){return this.isValid?ho(this.c).ordinal:NaN}get monthShort(){return this.isValid?nn.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?nn.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?nn.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?nn.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];let e=864e5,t=6e4,i=br(this.c),r=this.zone.offset(i-e),s=this.zone.offset(i+e),o=this.zone.offset(i-r*t),a=this.zone.offset(i-s*t);if(o===a)return[this];let d=i-o*t,c=i-a*t,f=gr(d,o),p=gr(c,a);return f.hour===p.hour&&f.minute===p.minute&&f.second===p.second&&f.millisecond===p.millisecond?[Pt(this,{ts:d}),Pt(this,{ts:c})]:[this]}get isInLeapYear(){return Jn(this.year)}get daysInMonth(){return Fr(this.year,this.month)}get daysInYear(){return this.isValid?$n(this.year):NaN}get weeksInWeekYear(){return this.isValid?Sr(this.weekYear):NaN}resolvedLocaleOptions(e={}){let{locale:t,numberingSystem:i,calendar:r}=_e.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:i,outputCalendar:r}}toUTC(e=0,t={}){return this.setZone(Oe.instance(e),t)}toLocal(){return this.setZone(j.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:i=!1}={}){if(e=mt(e,j.defaultZone),e.equals(this.zone))return this;if(e.isValid){let r=this.ts;if(t||i){let s=e.offset(this.ts),o=this.toObject();[r]=vr(o,s,e)}return Pt(this,{ts:r,zone:e})}else return n.invalid(mr(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:i}={}){let r=this.loc.clone({locale:e,numberingSystem:t,outputCalendar:i});return Pt(this,{loc:r})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;let t=Tr(e,Nc),i=!q(t.weekYear)||!q(t.weekNumber)||!q(t.weekday),r=!q(t.ordinal),s=!q(t.year),o=!q(t.month)||!q(t.day),a=s||o,d=t.weekYear||t.weekNumber;if((a||r)&&d)throw new kt("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(o&&r)throw new kt("Can't mix ordinal dates with month/day");let c;i?c=Pc({...bo(this.c),...t}):q(t.ordinal)?(c={...this.toObject(),...t},q(t.day)&&(c.day=Math.min(Fr(c.year,c.month),c.day))):c=kc({...ho(this.c),...t});let[f,p]=vr(c,this.o,this.zone);return Pt(this,{ts:f,o:p})}plus(e){if(!this.isValid)return this;let t=R.fromDurationLike(e);return Pt(this,Ic(this,t))}minus(e){if(!this.isValid)return this;let t=R.fromDurationLike(e).negate();return Pt(this,Ic(this,t))}startOf(e){if(!this.isValid)return this;let t={},i=R.normalizeUnit(e);switch(i){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0;break}if(i==="weeks"&&(t.weekday=1),i==="quarters"){let r=Math.ceil(this.month/3);t.month=(r-1)*3+1}return this.set(t)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,t={}){return this.isValid?_e.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):mo}toLocaleString(e=Er,t={}){return this.isValid?_e.create(this.loc.clone(t),e).formatDateTime(this):mo}toLocaleParts(e={}){return this.isValid?_e.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:i=!1,includeOffset:r=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;let o=e==="extended",a=yo(this,o);return a+="T",a+=Ac(this,o,t,i,r,s),a}toISODate({format:e="extended"}={}){return this.isValid?yo(this,e==="extended"):null}toISOWeekDate(){return yr(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:i=!0,includePrefix:r=!1,extendedZone:s=!1,format:o="extended"}={}){return this.isValid?(r?"T":"")+Ac(this,o==="extended",t,e,i,s):null}toRFC2822(){return yr(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return yr(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?yo(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:i=!0}={}){let r="HH:mm:ss.SSS";return(t||e)&&(i&&(r+=" "),t?r+="z":e&&(r+="ZZ")),yr(this,r,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():mo}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};let t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",i={}){if(!this.isValid||!e.isValid)return R.invalid("created by diffing an invalid DateTime");let r={locale:this.locale,numberingSystem:this.numberingSystem,...i},s=Yv(t).map(R.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,d=o?e:this,c=Q2(a,d,s,r);return o?c.negate():c}diffNow(e="milliseconds",t={}){return this.diff(n.now(),e,t)}until(e){return this.isValid?sn.fromDateTimes(this,e):this}hasSame(e,t){if(!this.isValid)return!1;let i=e.valueOf(),r=this.setZone(e.zone,{keepLocalTime:!0});return r.startOf(t)<=i&&i<=r.endOf(t)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;let t=e.base||n.fromObject({},{zone:this.zone}),i=e.padding?this<t?-e.padding:e.padding:0,r=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(r=e.unit,s=void 0),Lc(t,this.plus(i),{...e,numeric:"always",units:r,unit:s})}toRelativeCalendar(e={}){return this.isValid?Lc(e.base||n.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(n.isDateTime))throw new we("min requires all arguments be DateTimes");return Cc(e,t=>t.valueOf(),Math.min)}static max(...e){if(!e.every(n.isDateTime))throw new we("max requires all arguments be DateTimes");return Cc(e,t=>t.valueOf(),Math.max)}static fromFormatExplain(e,t,i={}){let{locale:r=null,numberingSystem:s=null}=i,o=ee.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0});return Pd(o,e,t)}static fromStringExplain(e,t,i={}){return n.fromFormatExplain(e,t,i)}static get DATE_SHORT(){return Er}static get DATE_MED(){return qc}static get DATE_MED_WITH_WEEKDAY(){return kv}static get DATE_FULL(){return Wc}static get DATE_HUGE(){return $c}static get TIME_SIMPLE(){return zc}static get TIME_WITH_SECONDS(){return Yc}static get TIME_WITH_SHORT_OFFSET(){return Kc}static get TIME_WITH_LONG_OFFSET(){return Jc}static get TIME_24_SIMPLE(){return Zc}static get TIME_24_WITH_SECONDS(){return Qc}static get TIME_24_WITH_SHORT_OFFSET(){return Xc}static get TIME_24_WITH_LONG_OFFSET(){return jc}static get DATETIME_SHORT(){return ed}static get DATETIME_SHORT_WITH_SECONDS(){return td}static get DATETIME_MED(){return nd}static get DATETIME_MED_WITH_SECONDS(){return id}static get DATETIME_MED_WITH_WEEKDAY(){return bv}static get DATETIME_FULL(){return rd}static get DATETIME_FULL_WITH_SECONDS(){return sd}static get DATETIME_HUGE(){return od}static get DATETIME_HUGE_WITH_SECONDS(){return ad}};function Hn(n){if(G.isDateTime(n))return n;if(n&&n.valueOf&&It(n.valueOf()))return G.fromJSDate(n);if(n&&typeof n=="object")return G.fromObject(n);throw new we(`Unknown datetime argument: ${n}, of type ${typeof n}`)}var $o={renderNullAs:"\\-",taskCompletionTracking:!1,taskCompletionUseEmojiShorthand:!1,taskCompletionText:"completion",taskCompletionDateFormat:"yyyy-MM-dd",recursiveSubTaskCompletion:!1,warnOnEmptyResult:!0,refreshEnabled:!0,refreshInterval:2500,defaultDateFormat:"MMMM dd, yyyy",defaultDateTimeFormat:"h:mm a - MMMM dd, yyyy",maxRecursiveRenderDepth:4,tableIdColumnName:"File",tableGroupColumnName:"Group",showResultCount:!0},vC={allowHtml:!0};({...$o,...vC});var Io=class n{constructor(e){ye(this,"value");ye(this,"successful");this.value=e,this.successful=!0}map(e){return new n(e(this.value))}flatMap(e){return e(this.value)}mapErr(e){return this}bimap(e,t){return this.map(e)}orElse(e){return this.value}cast(){return this}orElseThrow(e){return this.value}},Ao=class n{constructor(e){ye(this,"error");ye(this,"successful");this.error=e,this.successful=!1}map(e){return this}flatMap(e){return this}mapErr(e){return new n(e(this.error))}bimap(e,t){return this.mapErr(t)}orElse(e){return e}cast(){return this}orElseThrow(e){throw e?new Error(e(this.error)):new Error(""+this.error)}},Mr;(function(n){function e(s){return new Io(s)}n.success=e;function t(s){return new Ao(s)}n.failure=t;function i(s,o,a){return s.successful?o.successful?a(s.value,o.value):t(o.error):t(s.error)}n.flatMap2=i;function r(s,o,a){return i(s,o,(d,c)=>e(a(d,c)))}n.map2=r})(Mr||(Mr={}));var CC=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},_r={exports:{}};_r.exports;(function(n,e){(function(t,i){n.exports=i()})(typeof self!="undefined"?self:CC,function(){return function(t){var i={};function r(s){if(i[s])return i[s].exports;var o=i[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=i,r.d=function(s,o,a){r.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:a})},r.r=function(s){Object.defineProperty(s,"__esModule",{value:!0})},r.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(o,"a",o),o},r.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},r.p="",r(r.s=0)}([function(t,i,r){function s(m){if(!(this instanceof s))return new s(m);this._=m}var o=s.prototype;function a(m,D){for(var E=0;E<m;E++)D(E)}function d(m,D,E){return function(F,M){a(M.length,function(_){F(M[_],_,M)})}(function(F,M,_){D=m(D,F,M,_)},E),D}function c(m,D){return d(function(E,F,M,_){return E.concat([m(F,M,_)])},[],D)}function f(m,D){var E={v:0,buf:D};return a(m,function(){var F;E={v:E.v<<1|(F=E.buf,F[0]>>7),buf:function(M){var _=d(function(k,B,J,ge){return k.concat(J===ge.length-1?Buffer.from([B,0]).readUInt16BE(0):ge.readUInt16BE(J))},[],M);return Buffer.from(c(function(k){return(k<<1&65535)>>8},_))}(E.buf)}}),E}function p(){return typeof Buffer!="undefined"}function h(){if(!p())throw new Error("Buffer global does not exist; please use webpack if you need to parse Buffers in the browser.")}function g(m){h();var D=d(function(_,k){return _+k},0,m);if(D%8!=0)throw new Error("The bits ["+m.join(", ")+"] add up to "+D+" which is not an even number of bytes; the total should be divisible by 8");var E,F=D/8,M=(E=function(_){return _>48},d(function(_,k){return _||(E(k)?k:_)},null,m));if(M)throw new Error(M+" bit range requested exceeds 48 bit (6 byte) Number max.");return new s(function(_,k){var B=F+k;return B>_.length?N(k,F.toString()+" bytes"):T(B,d(function(J,ge){var ce=f(ge,J.buf);return{coll:J.coll.concat(ce.v),buf:ce.buf}},{coll:[],buf:_.slice(k,B)},m).coll)})}function v(m,D){return new s(function(E,F){return h(),F+D>E.length?N(F,D+" bytes for "+m):T(F+D,E.slice(F,F+D))})}function w(m,D){if(typeof(E=D)!="number"||Math.floor(E)!==E||D<0||D>6)throw new Error(m+" requires integer length in range [0, 6].");var E}function S(m){return w("uintBE",m),v("uintBE("+m+")",m).map(function(D){return D.readUIntBE(0,m)})}function x(m){return w("uintLE",m),v("uintLE("+m+")",m).map(function(D){return D.readUIntLE(0,m)})}function I(m){return w("intBE",m),v("intBE("+m+")",m).map(function(D){return D.readIntBE(0,m)})}function L(m){return w("intLE",m),v("intLE("+m+")",m).map(function(D){return D.readIntLE(0,m)})}function C(m){return m instanceof s}function P(m){return{}.toString.call(m)==="[object Array]"}function O(m){return p()&&Buffer.isBuffer(m)}function T(m,D){return{status:!0,index:m,value:D,furthest:-1,expected:[]}}function N(m,D){return P(D)||(D=[D]),{status:!1,index:-1,value:null,furthest:m,expected:D}}function $(m,D){if(!D||m.furthest>D.furthest)return m;var E=m.furthest===D.furthest?function(F,M){if(function(){if(s._supportsSet!==void 0)return s._supportsSet;var et=typeof Set!="undefined";return s._supportsSet=et,et}()&&Array.from){for(var _=new Set(F),k=0;k<M.length;k++)_.add(M[k]);var B=Array.from(_);return B.sort(),B}for(var J={},ge=0;ge<F.length;ge++)J[F[ge]]=!0;for(var ce=0;ce<M.length;ce++)J[M[ce]]=!0;var je=[];for(var Se in J)({}).hasOwnProperty.call(J,Se)&&je.push(Se);return je.sort(),je}(m.expected,D.expected):D.expected;return{status:m.status,index:m.index,value:m.value,furthest:D.furthest,expected:E}}var te={};function le(m,D){if(O(m))return{offset:D,line:-1,column:-1};m in te||(te[m]={});for(var E=te[m],F=0,M=0,_=0,k=D;k>=0;){if(k in E){F=E[k].line,_===0&&(_=E[k].lineStart);break}(m.charAt(k)===`
`||m.charAt(k)==="\r"&&m.charAt(k+1)!==`
`)&&(M++,_===0&&(_=k+1)),k--}var B=F+M,J=D-_;return E[D]={line:B,lineStart:_},{offset:D,line:B+1,column:J+1}}function K(m){if(!C(m))throw new Error("not a parser: "+m)}function Fe(m,D){return typeof m=="string"?m.charAt(D):m[D]}function ae(m){if(typeof m!="number")throw new Error("not a number: "+m)}function ve(m){if(typeof m!="function")throw new Error("not a function: "+m)}function ne(m){if(typeof m!="string")throw new Error("not a string: "+m)}var mn=2,jn=3,Ve=8,gn=5*Ve,ei=4*Ve,yn="  ";function Ce(m,D){return new Array(D+1).join(m)}function $e(m,D,E){var F=D-m.length;return F<=0?m:Ce(E,F)+m}function ta(m,D,E,F){return{from:m-D>0?m-D:0,to:m+E>F?F:m+E}}function jd(m,D){var E,F,M,_,k,B=D.index,J=B.offset,ge=1;if(J===m.length)return"Got the end of the input";if(O(m)){var ce=J-J%Ve,je=J-ce,Se=ta(ce,gn,ei+Ve,m.length),et=c(function(se){return c(function(Ot){return $e(Ot.toString(16),2,"0")},se)},function(se,Ot){var Bt=se.length,vt=[],Vt=0;if(Bt<=Ot)return[se.slice()];for(var Gt=0;Gt<Bt;Gt++)vt[Vt]||vt.push([]),vt[Vt].push(se[Gt]),(Gt+1)%Ot==0&&Vt++;return vt}(m.slice(Se.from,Se.to).toJSON().data,Ve));_=function(se){return se.from===0&&se.to===1?{from:se.from,to:se.to}:{from:se.from/Ve,to:Math.floor(se.to/Ve)}}(Se),F=ce/Ve,E=3*je,je>=4&&(E+=1),ge=2,M=c(function(se){return se.length<=4?se.join(" "):se.slice(0,4).join(" ")+"  "+se.slice(4).join(" ")},et),(k=(8*(_.to>0?_.to-1:_.to)).toString(16).length)<2&&(k=2)}else{var Lt=m.split(/\r\n|[\n\r\u2028\u2029]/);E=B.column-1,F=B.line-1,_=ta(F,mn,jn,Lt.length),M=Lt.slice(_.from,_.to),k=_.to.toString().length}var cf=F-_.from;return O(m)&&(k=(8*(_.to>0?_.to-1:_.to)).toString(16).length)<2&&(k=2),d(function(se,Ot,Bt){var vt,Vt=Bt===cf,Gt=Vt?"> ":yn;return vt=O(m)?$e((8*(_.from+Bt)).toString(16),k,"0"):$e((_.from+Bt+1).toString(),k," "),[].concat(se,[Gt+vt+" | "+Ot],Vt?[yn+Ce(" ",k)+" | "+$e("",E," ")+Ce("^",ge)]:[])},[],M).join(`
`)}function na(m,D){return[`
`,"-- PARSING FAILED "+Ce("-",50),`

`,jd(m,D),`

`,(E=D.expected,E.length===1?`Expected:

`+E[0]:`Expected one of the following: 

`+E.join(", ")),`
`].join("");var E}function ia(m){return m.flags!==void 0?m.flags:[m.global?"g":"",m.ignoreCase?"i":"",m.multiline?"m":"",m.unicode?"u":"",m.sticky?"y":""].join("")}function ti(){for(var m=[].slice.call(arguments),D=m.length,E=0;E<D;E+=1)K(m[E]);return s(function(F,M){for(var _,k=new Array(D),B=0;B<D;B+=1){if(!(_=$(m[B]._(F,M),_)).status)return _;k[B]=_.value,M=_.index}return $(T(M,k),_)})}function yt(){var m=[].slice.call(arguments);if(m.length===0)throw new Error("seqMap needs at least one argument");var D=m.pop();return ve(D),ti.apply(null,m).map(function(E){return D.apply(null,E)})}function ni(){var m=[].slice.call(arguments),D=m.length;if(D===0)return ii("zero alternates");for(var E=0;E<D;E+=1)K(m[E]);return s(function(F,M){for(var _,k=0;k<m.length;k+=1)if((_=$(m[k]._(F,M),_)).status)return _;return _})}function ra(m,D){return Wr(m,D).or(Dt([]))}function Wr(m,D){return K(m),K(D),yt(m,D.then(m).many(),function(E,F){return[E].concat(F)})}function Dn(m){ne(m);var D="'"+m+"'";return s(function(E,F){var M=F+m.length,_=E.slice(F,M);return _===m?T(M,_):N(F,D)})}function Xe(m,D){(function(M){if(!(M instanceof RegExp))throw new Error("not a regexp: "+M);for(var _=ia(M),k=0;k<_.length;k++){var B=_.charAt(k);if(B!=="i"&&B!=="m"&&B!=="u"&&B!=="s")throw new Error('unsupported regexp flag "'+B+'": '+M)}})(m),arguments.length>=2?ae(D):D=0;var E=function(M){return RegExp("^(?:"+M.source+")",ia(M))}(m),F=""+m;return s(function(M,_){var k=E.exec(M.slice(_));if(k){if(0<=D&&D<=k.length){var B=k[0],J=k[D];return T(_+B.length,J)}return N(_,"valid match group (0 to "+k.length+") in "+F)}return N(_,F)})}function Dt(m){return s(function(D,E){return T(E,m)})}function ii(m){return s(function(D,E){return N(E,m)})}function ri(m){if(C(m))return s(function(D,E){var F=m._(D,E);return F.index=E,F.value="",F});if(typeof m=="string")return ri(Dn(m));if(m instanceof RegExp)return ri(Xe(m));throw new Error("not a string, regexp, or parser: "+m)}function sa(m){return K(m),s(function(D,E){var F=m._(D,E),M=D.slice(E,F.index);return F.status?N(E,'not "'+M+'"'):T(E,null)})}function si(m){return ve(m),s(function(D,E){var F=Fe(D,E);return E<D.length&&m(F)?T(E+1,F):N(E,"a character/byte matching "+m)})}function oa(m,D){arguments.length<2&&(D=m,m=void 0);var E=s(function(F,M){return E._=D()._,E._(F,M)});return m?E.desc(m):E}function $r(){return ii("fantasy-land/empty")}o.parse=function(m){if(typeof m!="string"&&!O(m))throw new Error(".parse must be called with a string or Buffer as its argument");var D,E=this.skip(zr)._(m,0);return D=E.status?{status:!0,value:E.value}:{status:!1,index:le(m,E.furthest),expected:E.expected},delete te[m],D},o.tryParse=function(m){var D=this.parse(m);if(D.status)return D.value;var E=na(m,D),F=new Error(E);throw F.type="ParsimmonError",F.result=D,F},o.assert=function(m,D){return this.chain(function(E){return m(E)?Dt(E):ii(D)})},o.or=function(m){return ni(this,m)},o.trim=function(m){return this.wrap(m,m)},o.wrap=function(m,D){return yt(m,this,D,function(E,F){return F})},o.thru=function(m){return m(this)},o.then=function(m){return K(m),ti(this,m).map(function(D){return D[1]})},o.many=function(){var m=this;return s(function(D,E){for(var F=[],M=void 0;;){if(!(M=$(m._(D,E),M)).status)return $(T(E,F),M);if(E===M.index)throw new Error("infinite loop detected in .many() parser --- calling .many() on a parser which can accept zero characters is usually the cause");E=M.index,F.push(M.value)}})},o.tieWith=function(m){return ne(m),this.map(function(D){if(function(M){if(!P(M))throw new Error("not an array: "+M)}(D),D.length){ne(D[0]);for(var E=D[0],F=1;F<D.length;F++)ne(D[F]),E+=m+D[F];return E}return""})},o.tie=function(){return this.tieWith("")},o.times=function(m,D){var E=this;return arguments.length<2&&(D=m),ae(m),ae(D),s(function(F,M){for(var _=[],k=void 0,B=void 0,J=0;J<m;J+=1){if(B=$(k=E._(F,M),B),!k.status)return B;M=k.index,_.push(k.value)}for(;J<D&&(B=$(k=E._(F,M),B),k.status);J+=1)M=k.index,_.push(k.value);return $(T(M,_),B)})},o.result=function(m){return this.map(function(){return m})},o.atMost=function(m){return this.times(0,m)},o.atLeast=function(m){return yt(this.times(m),this.many(),function(D,E){return D.concat(E)})},o.map=function(m){ve(m);var D=this;return s(function(E,F){var M=D._(E,F);return M.status?$(T(M.index,m(M.value)),M):M})},o.contramap=function(m){ve(m);var D=this;return s(function(E,F){var M=D.parse(m(E.slice(F)));return M.status?T(F+E.length,M.value):M})},o.promap=function(m,D){return ve(m),ve(D),this.contramap(m).map(D)},o.skip=function(m){return ti(this,m).map(function(D){return D[0]})},o.mark=function(){return yt(vn,this,vn,function(m,D,E){return{start:m,value:D,end:E}})},o.node=function(m){return yt(vn,this,vn,function(D,E,F){return{name:m,value:E,start:D,end:F}})},o.sepBy=function(m){return ra(this,m)},o.sepBy1=function(m){return Wr(this,m)},o.lookahead=function(m){return this.skip(ri(m))},o.notFollowedBy=function(m){return this.skip(sa(m))},o.desc=function(m){P(m)||(m=[m]);var D=this;return s(function(E,F){var M=D._(E,F);return M.status||(M.expected=m),M})},o.fallback=function(m){return this.or(Dt(m))},o.ap=function(m){return yt(m,this,function(D,E){return D(E)})},o.chain=function(m){var D=this;return s(function(E,F){var M=D._(E,F);return M.status?$(m(M.value)._(E,M.index),M):M})},o.concat=o.or,o.empty=$r,o.of=Dt,o["fantasy-land/ap"]=o.ap,o["fantasy-land/chain"]=o.chain,o["fantasy-land/concat"]=o.concat,o["fantasy-land/empty"]=o.empty,o["fantasy-land/of"]=o.of,o["fantasy-land/map"]=o.map;var vn=s(function(m,D){return T(D,le(m,D))}),ef=s(function(m,D){return D>=m.length?N(D,"any character/byte"):T(D+1,Fe(m,D))}),tf=s(function(m,D){return T(m.length,m.slice(D))}),zr=s(function(m,D){return D<m.length?N(D,"EOF"):T(D,null)}),nf=Xe(/[0-9]/).desc("a digit"),rf=Xe(/[0-9]*/).desc("optional digits"),sf=Xe(/[a-z]/i).desc("a letter"),of=Xe(/[a-z]*/i).desc("optional letters"),af=Xe(/\s*/).desc("optional whitespace"),uf=Xe(/\s+/).desc("whitespace"),aa=Dn("\r"),ua=Dn(`
`),la=Dn(`\r
`),ca=ni(la,ua,aa).desc("newline"),lf=ni(ca,zr);s.all=tf,s.alt=ni,s.any=ef,s.cr=aa,s.createLanguage=function(m){var D={};for(var E in m)({}).hasOwnProperty.call(m,E)&&function(F){D[F]=oa(function(){return m[F](D)})}(E);return D},s.crlf=la,s.custom=function(m){return s(m(T,N))},s.digit=nf,s.digits=rf,s.empty=$r,s.end=lf,s.eof=zr,s.fail=ii,s.formatError=na,s.index=vn,s.isParser=C,s.lazy=oa,s.letter=sf,s.letters=of,s.lf=ua,s.lookahead=ri,s.makeFailure=N,s.makeSuccess=T,s.newline=ca,s.noneOf=function(m){return si(function(D){return m.indexOf(D)<0}).desc("none of '"+m+"'")},s.notFollowedBy=sa,s.of=Dt,s.oneOf=function(m){for(var D=m.split(""),E=0;E<D.length;E++)D[E]="'"+D[E]+"'";return si(function(F){return m.indexOf(F)>=0}).desc(D)},s.optWhitespace=af,s.Parser=s,s.range=function(m,D){return si(function(E){return m<=E&&E<=D}).desc(m+"-"+D)},s.regex=Xe,s.regexp=Xe,s.sepBy=ra,s.sepBy1=Wr,s.seq=ti,s.seqMap=yt,s.seqObj=function(){for(var m,D={},E=0,F=(m=arguments,Array.prototype.slice.call(m)),M=F.length,_=0;_<M;_+=1){var k=F[_];if(!C(k)){if(P(k)&&k.length===2&&typeof k[0]=="string"&&C(k[1])){var B=k[0];if(Object.prototype.hasOwnProperty.call(D,B))throw new Error("seqObj: duplicate key "+B);D[B]=!0,E++;continue}throw new Error("seqObj arguments must be parsers or [string, parser] array pairs.")}}if(E===0)throw new Error("seqObj expects at least one named parser, found zero");return s(function(J,ge){for(var ce,je={},Se=0;Se<M;Se+=1){var et,Lt;if(P(F[Se])?(et=F[Se][0],Lt=F[Se][1]):(et=null,Lt=F[Se]),!(ce=$(Lt._(J,ge),ce)).status)return ce;et&&(je[et]=ce.value),ge=ce.index}return $(T(ge,je),ce)})},s.string=Dn,s.succeed=Dt,s.takeWhile=function(m){return ve(m),s(function(D,E){for(var F=E;F<D.length&&m(Fe(D,F));)F++;return T(F,D.slice(E,F))})},s.test=si,s.whitespace=uf,s["fantasy-land/empty"]=$r,s["fantasy-land/of"]=Dt,s.Binary={bitSeq:g,bitSeqObj:function(m){h();var D={},E=0,F=c(function(_){if(P(_)){var k=_;if(k.length!==2)throw new Error("["+k.join(", ")+"] should be length 2, got length "+k.length);if(ne(k[0]),ae(k[1]),Object.prototype.hasOwnProperty.call(D,k[0]))throw new Error("duplicate key in bitSeqObj: "+k[0]);return D[k[0]]=!0,E++,k}return ae(_),[null,_]},m);if(E<1)throw new Error("bitSeqObj expects at least one named pair, got ["+m.join(", ")+"]");var M=c(function(_){return _[0]},F);return g(c(function(_){return _[1]},F)).map(function(_){return d(function(k,B){return B[0]!==null&&(k[B[0]]=B[1]),k},{},c(function(k,B){return[k,_[B]]},M))})},byte:function(m){if(h(),ae(m),m>255)throw new Error("Value specified to byte constructor ("+m+"=0x"+m.toString(16)+") is larger in value than a single byte.");var D=(m>15?"0x":"0x0")+m.toString(16);return s(function(E,F){var M=Fe(E,F);return M===m?T(F+1,M):N(F,D)})},buffer:function(m){return v("buffer",m).map(function(D){return Buffer.from(D)})},encodedString:function(m,D){return v("string",D).map(function(E){return E.toString(m)})},uintBE:S,uint8BE:S(1),uint16BE:S(2),uint32BE:S(4),uintLE:x,uint8LE:x(1),uint16LE:x(2),uint32LE:x(4),intBE:I,int8BE:I(1),int16BE:I(2),int32BE:I(4),intLE:L,int8LE:L(1),int16LE:L(2),int32LE:L(4),floatBE:v("floatBE",4).map(function(m){return m.readFloatBE(0)}),floatLE:v("floatLE",4).map(function(m){return m.readFloatLE(0)}),doubleBE:v("doubleBE",8).map(function(m){return m.readDoubleBE(0)}),doubleLE:v("doubleLE",8).map(function(m){return m.readDoubleLE(0)})},t.exports=s}])})})(_r,_r.exports);var y=_r.exports,zo=()=>/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC3\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC08\uDC26](?:\u200D\u2B1B)?|[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g;function Ud(n){return n==null?n:n.shiftToAll().normalize()}function Bc(n){return n.includes("/")&&(n=n.substring(n.lastIndexOf("/")+1)),n.endsWith(".md")&&(n=n.substring(0,n.length-3)),n}y.alt(y.regex(new RegExp(zo(),"")),y.regex(/[0-9\p{Letter}_-]+/u).map(n=>n.toLocaleLowerCase()),y.whitespace.map(n=>"-"),y.any.map(n=>"")).many().map(n=>n.join(""));var EC=y.alt(y.regex(new RegExp(zo(),"")),y.regex(/[0-9\p{Letter}_-]+/u),y.whitespace.map(n=>" "),y.any.map(n=>" ")).many().map(n=>n.join("").split(/\s+/).join(" ").trim());function wC(n){return EC.tryParse(n)}function FC(n){return n=Ud(n),n=R.fromObject(Object.fromEntries(Object.entries(n.toObject()).filter(([,e])=>e!=0))),n.toHuman()}var Yn;(function(n){function e(C,P=$o,O=!1){let T=t(C);if(!T)return P.renderNullAs;switch(T.type){case"null":return P.renderNullAs;case"string":return T.value;case"number":case"boolean":return""+T.value;case"html":return T.value.outerHTML;case"widget":return T.value.markdown();case"link":return T.value.markdown();case"function":return"<function>";case"array":let N="";return O&&(N+="["),N+=T.value.map($=>e($,P,!0)).join(", "),O&&(N+="]"),N;case"object":return"{ "+Object.entries(T.value).map($=>$[0]+": "+e($[1],P,!0)).join(", ")+" }";case"date":return T.value.second==0&&T.value.hour==0&&T.value.minute==0?T.value.toFormat(P.defaultDateFormat):T.value.toFormat(P.defaultDateTimeFormat);case"duration":return FC(T.value)}}n.toString=e;function t(C){return h(C)?{type:"null",value:C}:c(C)?{type:"number",value:C}:d(C)?{type:"string",value:C}:v(C)?{type:"boolean",value:C}:p(C)?{type:"duration",value:C}:f(C)?{type:"date",value:C}:S(C)?{type:"widget",value:C}:g(C)?{type:"array",value:C}:w(C)?{type:"link",value:C}:L(C)?{type:"function",value:C}:x(C)?{type:"html",value:C}:I(C)?{type:"object",value:C}:void 0}n.wrapValue=t;function i(C,P){if(I(C)){let O={};for(let[T,N]of Object.entries(C))O[T]=i(N,P);return O}else if(g(C)){let O=[];for(let T of C)O.push(i(T,P));return O}else return P(C)}n.mapLeaves=i;function r(C,P,O){var $,te;if(C===void 0&&(C=null),P===void 0&&(P=null),C===null&&P===null)return 0;if(C===null)return-1;if(P===null)return 1;let T=t(C),N=t(P);if(T===void 0&&N===void 0)return 0;if(T===void 0)return-1;if(N===void 0)return 1;if(T.type!=N.type)return T.type.localeCompare(N.type);if(T.value===N.value)return 0;switch(T.type){case"string":return T.value.localeCompare(N.value);case"number":return T.value<N.value?-1:T.value==N.value?0:1;case"null":return 0;case"boolean":return T.value==N.value?0:T.value?1:-1;case"link":let le=T.value,K=N.value,Fe=O!=null?O:Ce=>Ce,ae=Fe(le.path).localeCompare(Fe(K.path));if(ae!=0)return ae;let ve=le.type.localeCompare(K.type);return ve!=0?ve:le.subpath&&!K.subpath?1:!le.subpath&&K.subpath?-1:!le.subpath&&!K.subpath?0:(($=le.subpath)!=null?$:"").localeCompare((te=K.subpath)!=null?te:"");case"date":return T.value<N.value?-1:T.value.equals(N.value)?0:1;case"duration":return T.value<N.value?-1:T.value.equals(N.value)?0:1;case"array":let ne=T.value,mn=N.value;for(let Ce=0;Ce<Math.min(ne.length,mn.length);Ce++){let $e=r(ne[Ce],mn[Ce]);if($e!=0)return $e}return ne.length-mn.length;case"object":let jn=T.value,Ve=N.value,gn=Array.from(Object.keys(jn)),ei=Array.from(Object.keys(Ve));gn.sort(),ei.sort();let yn=r(gn,ei);if(yn!=0)return yn;for(let Ce of gn){let $e=r(jn[Ce],Ve[Ce]);if($e!=0)return $e}return 0;case"widget":case"html":case"function":return 0}}n.compareValue=r;function s(C){var P;return(P=t(C))==null?void 0:P.type}n.typeOf=s;function o(C){let P=t(C);if(!P)return!1;switch(P.type){case"number":return P.value!=0;case"string":return P.value.length>0;case"boolean":return P.value;case"link":return!!P.value.path;case"date":return P.value.toMillis()!=0;case"duration":return P.value.as("seconds")!=0;case"object":return Object.keys(P.value).length>0;case"array":return P.value.length>0;case"null":return!1;case"html":case"widget":case"function":return!0}}n.isTruthy=o;function a(C){if(C==null)return C;if(n.isArray(C))return[].concat(C.map(P=>a(P)));if(n.isObject(C)){let P={};for(let[O,T]of Object.entries(C))P[O]=a(T);return P}else return C}n.deepCopy=a;function d(C){return typeof C=="string"}n.isString=d;function c(C){return typeof C=="number"}n.isNumber=c;function f(C){return C instanceof G}n.isDate=f;function p(C){return C instanceof R}n.isDuration=p;function h(C){return C==null}n.isNull=h;function g(C){return Array.isArray(C)}n.isArray=g;function v(C){return typeof C=="boolean"}n.isBoolean=v;function w(C){return C instanceof xr}n.isLink=w;function S(C){return C instanceof Kn}n.isWidget=S;function x(C){return typeof HTMLElement!="undefined"?C instanceof HTMLElement:!1}n.isHtml=x;function I(C){return typeof C=="object"&&!x(C)&&!S(C)&&!g(C)&&!p(C)&&!f(C)&&!w(C)&&C!==void 0&&!h(C)}n.isObject=I;function L(C){return typeof C=="function"}n.isFunction=L})(Yn||(Yn={}));var Vc;(function(n){function e(r){return Yn.isObject(r)&&Object.keys(r).length==2&&"key"in r&&"rows"in r}n.isElementGroup=e;function t(r){for(let s of r)if(!e(s))return!1;return!0}n.isGrouping=t;function i(r){if(t(r)){let s=0;for(let o of r)s+=i(o.rows);return s}else return r.length}n.count=i})(Vc||(Vc={}));var xr=class n{constructor(e){ye(this,"path");ye(this,"display");ye(this,"subpath");ye(this,"embed");ye(this,"type");Object.assign(this,e)}static file(e,t=!1,i){return new n({path:e,embed:t,display:i,subpath:void 0,type:"file"})}static infer(e,t=!1,i){if(e.includes("#^")){let r=e.split("#^");return n.block(r[0],r[1],t,i)}else if(e.includes("#")){let r=e.split("#");return n.header(r[0],r[1],t,i)}else return n.file(e,t,i)}static header(e,t,i,r){return new n({path:e,embed:i,display:r,subpath:wC(t),type:"header"})}static block(e,t,i,r){return new n({path:e,embed:i,display:r,subpath:t,type:"block"})}static fromObject(e){return new n(e)}equals(e){return e==null||e==null?!1:this.path==e.path&&this.type==e.type&&this.subpath==e.subpath}toString(){return this.markdown()}toObject(){return{path:this.path,type:this.type,subpath:this.subpath,display:this.display,embed:this.embed}}withPath(e){return new n(Object.assign({},this,{path:e}))}withDisplay(e){return new n(Object.assign({},this,{display:e}))}withHeader(e){return n.header(this.path,e,this.embed,this.display)}toFile(){return n.file(this.path,this.embed,this.display)}toEmbed(){if(this.embed)return this;{let e=new n(this);return e.embed=!0,e}}fromEmbed(){if(this.embed){let e=new n(this);return e.embed=!1,e}else return this}markdown(){let e=(this.embed?"!":"")+"[["+this.obsidianLink();return this.display?e+="|"+this.display:(e+="|"+Bc(this.path),(this.type=="header"||this.type=="block")&&(e+=" > "+this.subpath)),e+="]]",e}obsidianLink(){var t,i;let e=this.path.replaceAll("|","\\|");return this.type=="header"?e+"#"+((t=this.subpath)==null?void 0:t.replaceAll("|","\\|")):this.type=="block"?e+"#^"+((i=this.subpath)==null?void 0:i.replaceAll("|","\\|")):e}fileName(){return Bc(this.path).replace(".md","")}},Kn=class{constructor(e){ye(this,"$widget");this.$widget=e}},No=class extends Kn{constructor(t,i){super("dataview:list-pair");ye(this,"key");ye(this,"value");this.key=t,this.value=i}markdown(){return`${Yn.toString(this.key)}: ${Yn.toString(this.value)}`}},Ro=class extends Kn{constructor(t,i){super("dataview:external-link");ye(this,"url");ye(this,"display");this.url=t,this.display=i}markdown(){var t;return`[${(t=this.display)!=null?t:this.url}](${this.url})`}},Gc;(function(n){function e(o,a){return new No(o,a)}n.listPair=e;function t(o,a){return new Ro(o,a)}n.externalLink=t;function i(o){return o.$widget==="dataview:list-pair"}n.isListPair=i;function r(o){return o.$widget==="dataview:external-link"}n.isExternalLink=r;function s(o){return i(o)||r(o)}n.isBuiltin=s})(Gc||(Gc={}));var X;(function(n){function e(h){return{type:"variable",name:h}}n.variable=e;function t(h){return{type:"literal",value:h}}n.literal=t;function i(h,g,v){return{type:"binaryop",left:h,op:g,right:v}}n.binaryOp=i;function r(h,g){return{type:"index",object:h,index:g}}n.index=r;function s(h){let g=h.split("."),v=n.variable(g[0]);for(let w=1;w<g.length;w++)v=n.index(v,n.literal(g[w]));return v}n.indexVariable=s;function o(h,g){return{type:"lambda",arguments:h,value:g}}n.lambda=o;function a(h,g){return{type:"function",func:h,arguments:g}}n.func=a;function d(h){return{type:"list",values:h}}n.list=d;function c(h){return{type:"object",values:h}}n.object=c;function f(h){return{type:"negated",child:h}}n.negate=f;function p(h){return h=="<="||h=="<"||h==">"||h==">="||h=="!="||h=="="}n.isCompareOp=p,n.NULL=n.literal(null)})(X||(X={}));var Je;(function(n){function e(f){return{type:"tag",tag:f}}n.tag=e;function t(f){return{type:"csv",path:f}}n.csv=t;function i(f){return{type:"folder",folder:f}}n.folder=i;function r(f,p){return{type:"link",file:f,direction:p?"incoming":"outgoing"}}n.link=r;function s(f,p,h){return{type:"binaryop",left:f,op:p,right:h}}n.binaryOp=s;function o(f,p){return{type:"binaryop",left:f,op:"&",right:p}}n.and=o;function a(f,p){return{type:"binaryop",left:f,op:"|",right:p}}n.or=a;function d(f){return{type:"negate",child:f}}n.negate=d;function c(){return{type:"empty"}}n.empty=c})(Je||(Je={}));var Uc=new RegExp(zo(),""),Lo={year:R.fromObject({years:1}),years:R.fromObject({years:1}),yr:R.fromObject({years:1}),yrs:R.fromObject({years:1}),month:R.fromObject({months:1}),months:R.fromObject({months:1}),mo:R.fromObject({months:1}),mos:R.fromObject({months:1}),week:R.fromObject({weeks:1}),weeks:R.fromObject({weeks:1}),wk:R.fromObject({weeks:1}),wks:R.fromObject({weeks:1}),w:R.fromObject({weeks:1}),day:R.fromObject({days:1}),days:R.fromObject({days:1}),d:R.fromObject({days:1}),hour:R.fromObject({hours:1}),hours:R.fromObject({hours:1}),hr:R.fromObject({hours:1}),hrs:R.fromObject({hours:1}),h:R.fromObject({hours:1}),minute:R.fromObject({minutes:1}),minutes:R.fromObject({minutes:1}),min:R.fromObject({minutes:1}),mins:R.fromObject({minutes:1}),m:R.fromObject({minutes:1}),second:R.fromObject({seconds:1}),seconds:R.fromObject({seconds:1}),sec:R.fromObject({seconds:1}),secs:R.fromObject({seconds:1}),s:R.fromObject({seconds:1})},Oo={now:()=>G.local(),today:()=>G.local().startOf("day"),yesterday:()=>G.local().startOf("day").minus(R.fromObject({days:1})),tomorrow:()=>G.local().startOf("day").plus(R.fromObject({days:1})),sow:()=>G.local().startOf("week"),"start-of-week":()=>G.local().startOf("week"),eow:()=>G.local().endOf("week"),"end-of-week":()=>G.local().endOf("week"),soy:()=>G.local().startOf("year"),"start-of-year":()=>G.local().startOf("year"),eoy:()=>G.local().endOf("year"),"end-of-year":()=>G.local().endOf("year"),som:()=>G.local().startOf("month"),"start-of-month":()=>G.local().startOf("month"),eom:()=>G.local().endOf("month"),"end-of-month":()=>G.local().endOf("month")},Bo=["FROM","WHERE","LIMIT","GROUP","FLATTEN"];function SC(n){let e=-1;for(;(e=n.indexOf("|",e+1))>=0;)if(!(e>0&&n[e-1]=="\\"))return[n.substring(0,e).replace(/\\\|/g,"|"),n.substring(e+1)];return[n.replace(/\\\|/g,"|"),void 0]}function TC(n){let[e,t]=SC(n);return xr.infer(e,!1,t)}function qn(n,e,t){return y.seqMap(n,y.seq(y.optWhitespace,e,y.optWhitespace,n).many(),(i,r)=>{if(r.length==0)return i;let s=t(i,r[0][1],r[0][3]);for(let o=1;o<r.length;o++)s=t(s,r[o][1],r[o][3]);return s})}function MC(n,...e){return y.custom((t,i)=>(r,s)=>{let o=n._(r,s);if(!o.status)return o;for(let a of e){let d=a(o.value)._(r,o.index);if(!d.status)return o;o=d}return o})}var qe=y.createLanguage({number:n=>y.regexp(/-?[0-9]+(\.[0-9]+)?/).map(e=>Number.parseFloat(e)).desc("number"),string:n=>y.string('"').then(y.alt(n.escapeCharacter,y.noneOf('"\\')).atLeast(0).map(e=>e.join(""))).skip(y.string('"')).desc("string"),escapeCharacter:n=>y.string("\\").then(y.any).map(e=>e==='"'?'"':e==="\\"?"\\":"\\"+e),bool:n=>y.regexp(/true|false|True|False/).map(e=>e.toLowerCase()=="true").desc("boolean ('true' or 'false')"),tag:n=>y.seqMap(y.string("#"),y.alt(y.regexp(/[^\u2000-\u206F\u2E00-\u2E7F'!"#$%&()*+,.:;<=>?@^`{|}~\[\]\\\s]/).desc("text")).many(),(e,t)=>e+t.join("")).desc("tag ('#hello/stuff')"),identifier:n=>y.seqMap(y.alt(y.regexp(/\p{Letter}/u),y.regexp(Uc).desc("text")),y.alt(y.regexp(/[0-9\p{Letter}_-]/u),y.regexp(Uc).desc("text")).many(),(e,t)=>e+t.join("")).desc("variable identifier"),link:n=>y.regexp(/\[\[([^\[\]]*?)\]\]/u,1).map(e=>TC(e)).desc("file link"),embedLink:n=>y.seqMap(y.string("!").atMost(1),n.link,(e,t)=>(e.length>0&&(t.embed=!0),t)).desc("file link"),binaryPlusMinus:n=>y.regexp(/\+|-/).map(e=>e).desc("'+' or '-'"),binaryMulDiv:n=>y.regexp(/\*|\/|%/).map(e=>e).desc("'*' or '/' or '%'"),binaryCompareOp:n=>y.regexp(/>=|<=|!=|>|<|=/).map(e=>e).desc("'>=' or '<=' or '!=' or '=' or '>' or '<'"),binaryBooleanOp:n=>y.regexp(/and|or|&|\|/i).map(e=>e.toLowerCase()=="and"?"&":e.toLowerCase()=="or"?"|":e).desc("'and' or 'or'"),rootDate:n=>y.seqMap(y.regexp(/\d{4}/),y.string("-"),y.regexp(/\d{2}/),(e,t,i)=>G.fromObject({year:Number.parseInt(e),month:Number.parseInt(i)})).desc("date in format YYYY-MM[-DDTHH-MM-SS.MS]"),dateShorthand:n=>y.alt(...Object.keys(Oo).sort((e,t)=>t.length-e.length).map(y.string)),date:n=>MC(n.rootDate,e=>y.seqMap(y.string("-"),y.regexp(/\d{2}/),(t,i)=>e.set({day:Number.parseInt(i)})),e=>y.seqMap(y.string("T"),y.regexp(/\d{2}/),(t,i)=>e.set({hour:Number.parseInt(i)})),e=>y.seqMap(y.string(":"),y.regexp(/\d{2}/),(t,i)=>e.set({minute:Number.parseInt(i)})),e=>y.seqMap(y.string(":"),y.regexp(/\d{2}/),(t,i)=>e.set({second:Number.parseInt(i)})),e=>y.alt(y.seqMap(y.string("."),y.regexp(/\d{3}/),(t,i)=>e.set({millisecond:Number.parseInt(i)})),y.succeed(e)),e=>y.alt(y.seqMap(y.string("+").or(y.string("-")),y.regexp(/\d{1,2}(:\d{2})?/),(t,i)=>e.setZone("UTC"+t+i,{keepLocalTime:!0})),y.seqMap(y.string("Z"),()=>e.setZone("utc",{keepLocalTime:!0})),y.seqMap(y.string("["),y.regexp(/[0-9A-Za-z+-\/]+/u),y.string("]"),(t,i,r)=>e.setZone(i,{keepLocalTime:!0})))).assert(e=>e.isValid,"valid date").desc("date in format YYYY-MM[-DDTHH-MM-SS.MS]"),datePlus:n=>y.alt(n.dateShorthand.map(e=>Oo[e]()),n.date).desc("date in format YYYY-MM[-DDTHH-MM-SS.MS] or in shorthand"),durationType:n=>y.alt(...Object.keys(Lo).sort((e,t)=>t.length-e.length).map(y.string)),duration:n=>y.seqMap(n.number,y.optWhitespace,n.durationType,(e,t,i)=>Lo[i].mapUnits(r=>r*e)).sepBy1(y.string(",").trim(y.optWhitespace).or(y.optWhitespace)).map(e=>e.reduce((t,i)=>t.plus(i))).desc("duration like 4hr2min"),rawNull:n=>y.string("null"),tagSource:n=>n.tag.map(e=>Je.tag(e)),csvSource:n=>y.seqMap(y.string("csv(").skip(y.optWhitespace),n.string,y.string(")"),(e,t,i)=>Je.csv(t)),linkIncomingSource:n=>n.link.map(e=>Je.link(e.path,!0)),linkOutgoingSource:n=>y.seqMap(y.string("outgoing(").skip(y.optWhitespace),n.link,y.string(")"),(e,t,i)=>Je.link(t.path,!1)),folderSource:n=>n.string.map(e=>Je.folder(e)),parensSource:n=>y.seqMap(y.string("("),y.optWhitespace,n.source,y.optWhitespace,y.string(")"),(e,t,i,r,s)=>i),negateSource:n=>y.seqMap(y.alt(y.string("-"),y.string("!")),n.atomSource,(e,t)=>Je.negate(t)),atomSource:n=>y.alt(n.parensSource,n.negateSource,n.linkOutgoingSource,n.linkIncomingSource,n.folderSource,n.tagSource,n.csvSource),binaryOpSource:n=>qn(n.atomSource,n.binaryBooleanOp.map(e=>e),Je.binaryOp),source:n=>n.binaryOpSource,variableField:n=>n.identifier.chain(e=>Bo.includes(e.toUpperCase())?y.fail("Variable fields cannot be a keyword ("+Bo.join(" or ")+")"):y.succeed(X.variable(e))).desc("variable"),numberField:n=>n.number.map(e=>X.literal(e)).desc("number"),stringField:n=>n.string.map(e=>X.literal(e)).desc("string"),boolField:n=>n.bool.map(e=>X.literal(e)).desc("boolean"),dateField:n=>y.seqMap(y.string("date("),y.optWhitespace,n.datePlus,y.optWhitespace,y.string(")"),(e,t,i,r,s)=>X.literal(i)).desc("date"),durationField:n=>y.seqMap(y.string("dur("),y.optWhitespace,n.duration,y.optWhitespace,y.string(")"),(e,t,i,r,s)=>X.literal(i)).desc("duration"),nullField:n=>n.rawNull.map(e=>X.NULL),linkField:n=>n.link.map(e=>X.literal(e)),listField:n=>n.field.sepBy(y.string(",").trim(y.optWhitespace)).wrap(y.string("[").skip(y.optWhitespace),y.optWhitespace.then(y.string("]"))).map(e=>X.list(e)).desc("list ('[1, 2, 3]')"),objectField:n=>y.seqMap(n.identifier.or(n.string),y.string(":").trim(y.optWhitespace),n.field,(e,t,i)=>({name:e,value:i})).sepBy(y.string(",").trim(y.optWhitespace)).wrap(y.string("{").skip(y.optWhitespace),y.optWhitespace.then(y.string("}"))).map(e=>{let t={};for(let i of e)t[i.name]=i.value;return X.object(t)}).desc("object ('{ a: 1, b: 2 }')"),atomInlineField:n=>y.alt(n.date,n.duration.map(e=>Ud(e)),n.string,n.tag,n.embedLink,n.bool,n.number,n.rawNull),inlineFieldList:n=>n.atomInlineField.sepBy(y.string(",").trim(y.optWhitespace).lookahead(n.atomInlineField)),inlineField:n=>y.alt(y.seqMap(n.atomInlineField,y.string(",").trim(y.optWhitespace),n.inlineFieldList,(e,t,i)=>[e].concat(i)),n.atomInlineField),atomField:n=>y.alt(n.embedLink.map(e=>X.literal(e)),n.negatedField,n.linkField,n.listField,n.objectField,n.lambdaField,n.parensField,n.boolField,n.numberField,n.stringField,n.dateField,n.durationField,n.nullField,n.variableField),indexField:n=>y.seqMap(n.atomField,y.alt(n.dotPostfix,n.indexPostfix,n.functionPostfix).many(),(e,t)=>{let i=e;for(let r of t)switch(r.type){case"dot":i=X.index(i,X.literal(r.field));break;case"index":i=X.index(i,r.field);break;case"function":i=X.func(i,r.fields);break}return i}),negatedField:n=>y.seqMap(y.string("!"),n.indexField,(e,t)=>X.negate(t)).desc("negated field"),parensField:n=>y.seqMap(y.string("("),y.optWhitespace,n.field,y.optWhitespace,y.string(")"),(e,t,i,r,s)=>i),lambdaField:n=>y.seqMap(n.identifier.sepBy(y.string(",").trim(y.optWhitespace)).wrap(y.string("(").trim(y.optWhitespace),y.string(")").trim(y.optWhitespace)),y.string("=>").trim(y.optWhitespace),n.field,(e,t,i)=>({type:"lambda",arguments:e,value:i})),dotPostfix:n=>y.seqMap(y.string("."),n.identifier,(e,t)=>({type:"dot",field:t})),indexPostfix:n=>y.seqMap(y.string("["),y.optWhitespace,n.field,y.optWhitespace,y.string("]"),(e,t,i,r,s)=>({type:"index",field:i})),functionPostfix:n=>y.seqMap(y.string("("),y.optWhitespace,n.field.sepBy(y.string(",").trim(y.optWhitespace)),y.optWhitespace,y.string(")"),(e,t,i,r,s)=>({type:"function",fields:i})),binaryMulDivField:n=>qn(n.indexField,n.binaryMulDiv,X.binaryOp),binaryPlusMinusField:n=>qn(n.binaryMulDivField,n.binaryPlusMinus,X.binaryOp),binaryCompareField:n=>qn(n.binaryPlusMinusField,n.binaryCompareOp,X.binaryOp),binaryBooleanField:n=>qn(n.binaryCompareField,n.binaryBooleanOp,X.binaryOp),binaryOpField:n=>n.binaryBooleanField,field:n=>n.binaryOpField});function _C(n){try{return Mr.success(qe.field.tryParse(n))}catch(e){return Mr.failure(""+e)}}var Pr;(function(n){function e(i,r){return{name:i,field:r}}n.named=e;function t(i,r){return{field:i,direction:r}}n.sortBy=t})(Pr||(Pr={}));function xC(n){return y.custom((e,t)=>(i,r)=>{let s=n._(i,r);return s.status?Object.assign({},s,{value:[s.value,i.substring(r,s.index)]}):s})}function PC(n){return n.split(/[\r\n]+/).map(e=>e.trim()).join("")}function Hc(n,e){return y.eof.map(n).or(y.whitespace.then(e))}var Hd=y.createLanguage({queryType:n=>y.alt(y.regexp(/TABLE|LIST|TASK|CALENDAR/i)).map(e=>e.toLowerCase()).desc("query type ('TABLE', 'LIST', 'TASK', or 'CALENDAR')"),explicitNamedField:n=>y.seqMap(qe.field.skip(y.whitespace),y.regexp(/AS/i).skip(y.whitespace),qe.identifier.or(qe.string),(e,t,i)=>Pr.named(i,e)),comment:()=>y.Parser((n,e)=>{let t=n.substring(e);if(!t.startsWith("//"))return y.makeFailure(e,"Not a comment");t=t.split(`
`)[0];let i=t.substring(2).trim();return y.makeSuccess(e+t.length,i)}),namedField:n=>y.alt(n.explicitNamedField,xC(qe.field).map(([e,t])=>Pr.named(PC(t),e))),sortField:n=>y.seqMap(qe.field.skip(y.optWhitespace),y.regexp(/ASCENDING|DESCENDING|ASC|DESC/i).atMost(1),(e,t)=>{let i=t.length==0?"ascending":t[0].toLowerCase();return i=="desc"&&(i="descending"),i=="asc"&&(i="ascending"),{field:e,direction:i}}),headerClause:n=>n.queryType.chain(e=>{switch(e){case"table":return Hc(()=>({type:e,fields:[],showId:!0}),y.seqMap(y.regexp(/WITHOUT\s+ID/i).skip(y.optWhitespace).atMost(1),y.sepBy(n.namedField,y.string(",").trim(y.optWhitespace)),(t,i)=>({type:e,fields:i,showId:t.length==0})));case"list":return Hc(()=>({type:e,format:void 0,showId:!0}),y.seqMap(y.regexp(/WITHOUT\s+ID/i).skip(y.optWhitespace).atMost(1),qe.field.atMost(1),(t,i)=>({type:e,format:i.length==1?i[0]:void 0,showId:t.length==0})));case"task":return y.succeed({type:e});case"calendar":return y.whitespace.then(y.seqMap(n.namedField,t=>({type:e,showId:!0,field:t})));default:return y.fail(`Unrecognized query type '${e}'`)}}).desc("TABLE or LIST or TASK or CALENDAR"),fromClause:n=>y.seqMap(y.regexp(/FROM/i),y.whitespace,qe.source,(e,t,i)=>i),whereClause:n=>y.seqMap(y.regexp(/WHERE/i),y.whitespace,qe.field,(e,t,i)=>({type:"where",clause:i})).desc("WHERE <expression>"),sortByClause:n=>y.seqMap(y.regexp(/SORT/i),y.whitespace,n.sortField.sepBy1(y.string(",").trim(y.optWhitespace)),(e,t,i)=>({type:"sort",fields:i})).desc("SORT field [ASC/DESC]"),limitClause:n=>y.seqMap(y.regexp(/LIMIT/i),y.whitespace,qe.field,(e,t,i)=>({type:"limit",amount:i})).desc("LIMIT <value>"),flattenClause:n=>y.seqMap(y.regexp(/FLATTEN/i).skip(y.whitespace),n.namedField,(e,t)=>({type:"flatten",field:t})).desc("FLATTEN <value> [AS <name>]"),groupByClause:n=>y.seqMap(y.regexp(/GROUP BY/i).skip(y.whitespace),n.namedField,(e,t)=>({type:"group",field:t})).desc("GROUP BY <value> [AS <name>]"),clause:n=>y.alt(n.fromClause,n.whereClause,n.sortByClause,n.limitClause,n.groupByClause,n.flattenClause),query:n=>y.seqMap(n.headerClause.trim(Do),n.fromClause.trim(Do).atMost(1),n.clause.trim(Do).many(),(e,t,i)=>({header:e,source:t.length==0?Je.folder(""):t[0],operations:i,settings:$o}))}),Do=y.alt(y.whitespace,Hd.comment).many().map(n=>n.join("")),kC=n=>{var e;return n?(e=n.plugins.plugins.dataview)==null?void 0:e.api:window.DataviewAPI},bC=n=>n.plugins.enabledPlugins.has("dataview");Ze.DATE_SHORTHANDS=Oo;Ze.DURATION_TYPES=Lo;Ze.EXPRESSION=qe;Ze.KEYWORDS=Bo;Ze.QUERY_LANGUAGE=Hd;Ze.getAPI=kC;Ze.isPluginEnabled=bC;Ze.parseField=_C});var VC={};da(VC,{default:()=>qr});module.exports=Kr(VC);var Qd=require("obsidian");var H=require("obsidian");var pa=require("obsidian");Ct();async function oi(n,e,t,i,r){var a;let s=(a=e.settings.modelDiscovery)!=null&&a.enabled&&e.getModelManager?await e.getModelManager().getAvailableModels():ke,o=new pa.Setting(n).setName(i).setDesc(r).addDropdown(d=>(s.forEach(c=>{d.addOption(c.value,c.label)}),d.setValue(String(e.settings[t])).onChange(async c=>{e.settings[t]=c,await e.saveSettings()}),d))}var ui=require("obsidian"),ai=class extends ui.AbstractInputSuggest{constructor(e,t,i){super(e,t),this.inputEl=t,this.folderSelectCallback=i}getSuggestions(e){return this.app.vault.getAllLoadedFiles().filter(i=>i instanceof ui.TFolder).filter(i=>i.path.toLowerCase().contains(e.toLowerCase()))}renderSuggestion(e,t){t.setText(e.path)}selectSuggestion(e,t){this.inputEl.value=e.path,this.inputEl.trigger("input"),this.close(),this.folderSelectCallback(e.path)}};var vf,Cf;function Ef(){return{geminiUrl:vf,vertexUrl:Cf}}function wf(n,e,t){var i,r,s;if(!(!((i=n.httpOptions)===null||i===void 0)&&i.baseUrl)){let o=Ef();return n.vertexai?(r=o.vertexUrl)!==null&&r!==void 0?r:e:(s=o.geminiUrl)!==null&&s!==void 0?s:t}return n.httpOptions.baseUrl}var Ht=class{};function W(n,e){let t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){let s=e[r];return s!=null?String(s):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function u(n,e,t){for(let s=0;s<e.length-1;s++){let o=e[s];if(o.endsWith("[]")){let a=o.slice(0,-2);if(!(a in n))if(Array.isArray(t))n[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[a])){let d=n[a];if(Array.isArray(t))for(let c=0;c<d.length;c++){let f=d[c];u(f,e.slice(s+1),t[c])}else for(let c of d)u(c,e.slice(s+1),t)}return}else if(o.endsWith("[0]")){let a=o.slice(0,-3);a in n||(n[a]=[{}]);let d=n[a];u(d[0],e.slice(s+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}let i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else n[i]=t}function l(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;let i=e[t];if(i.endsWith("[]")){let r=i.slice(0,-2);if(r in n){let s=n[r];return Array.isArray(s)?s.map(o=>l(o,e.slice(t+1))):void 0}else return}else n=n[i]}return n}catch(t){if(t instanceof TypeError)return;throw t}}function ue(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){let t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function ou(n,e){let t=ue(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function au(n,e){return Array.isArray(e)?e.map(t=>pi(n,t)):[pi(n,e)]}function pi(n,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Ff(n,e){let t=pi(n,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Sf(n,e){let t=pi(n,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function ha(n,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function uu(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>ha(n,t)):[ha(n,e)]}function Zr(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function ma(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function ga(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Ee(n,e){if(e==null)throw new Error("ContentUnion is required");return Zr(e)?e:{role:"user",parts:uu(n,e)}}function lu(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{let i=Ee(n,t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){let t=Ee(n,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Ee(n,t)):[Ee(n,e)]}function Q(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(ma(e)||ga(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ee(n,e)]}let t=[],i=[],r=Zr(e[0]);for(let s of e){let o=Zr(s);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(s);else{if(ma(s)||ga(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");i.push(s)}}return r||t.push({role:"user",parts:uu(n,i)}),t}function cu(n,e){return e}function du(n,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function Ti(n,e){return e}function be(n,e){if(!Array.isArray(e))throw new Error("tool is required and must be an array of Tools");return e}function Tf(n,e,t,i=1){let r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function lt(n,e){if(typeof e!="string")throw new Error("name must be a string");return Tf(n,e,"cachedContents")}function ct(n,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function fu(n,e){if(typeof e!="string")throw new Error("fromName must be a string");return e.startsWith("files/")?e.split("files/")[1]:e}function Mf(n,e){let t={};if(l(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");let i=l(e,["thought"]);i!=null&&u(t,["thought"],i);let r=l(e,["codeExecutionResult"]);r!=null&&u(t,["codeExecutionResult"],r);let s=l(e,["executableCode"]);s!=null&&u(t,["executableCode"],s);let o=l(e,["fileData"]);o!=null&&u(t,["fileData"],o);let a=l(e,["functionCall"]);a!=null&&u(t,["functionCall"],a);let d=l(e,["functionResponse"]);d!=null&&u(t,["functionResponse"],d);let c=l(e,["inlineData"]);c!=null&&u(t,["inlineData"],c);let f=l(e,["text"]);return f!=null&&u(t,["text"],f),t}function ya(n,e){let t={},i=l(e,["parts"]);i!=null&&(Array.isArray(i)?u(t,["parts"],i.map(s=>Mf(n,s))):u(t,["parts"],i));let r=l(e,["role"]);return r!=null&&u(t,["role"],r),t}function _f(n,e){let t={};if(l(e,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");let i=l(e,["description"]);i!=null&&u(t,["description"],i);let r=l(e,["name"]);r!=null&&u(t,["name"],r);let s=l(e,["parameters"]);return s!=null&&u(t,["parameters"],s),t}function xf(){return{}}function Pf(n,e){let t={},i=l(e,["mode"]);i!=null&&u(t,["mode"],i);let r=l(e,["dynamicThreshold"]);return r!=null&&u(t,["dynamicThreshold"],r),t}function kf(n,e){let t={},i=l(e,["dynamicRetrievalConfig"]);return i!=null&&u(t,["dynamicRetrievalConfig"],Pf(n,i)),t}function bf(n,e){let t={},i=l(e,["functionDeclarations"]);if(i!=null&&(Array.isArray(i)?u(t,["functionDeclarations"],i.map(a=>_f(n,a))):u(t,["functionDeclarations"],i)),l(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");l(e,["googleSearch"])!=null&&u(t,["googleSearch"],xf());let s=l(e,["googleSearchRetrieval"]);s!=null&&u(t,["googleSearchRetrieval"],kf(n,s));let o=l(e,["codeExecution"]);return o!=null&&u(t,["codeExecution"],o),t}function If(n,e){let t={},i=l(e,["mode"]);i!=null&&u(t,["mode"],i);let r=l(e,["allowedFunctionNames"]);return r!=null&&u(t,["allowedFunctionNames"],r),t}function Af(n,e){let t={},i=l(e,["functionCallingConfig"]);return i!=null&&u(t,["functionCallingConfig"],If(n,i)),t}function Nf(n,e,t){let i={},r=l(e,["ttl"]);t!==void 0&&r!=null&&u(t,["ttl"],r);let s=l(e,["expireTime"]);t!==void 0&&s!=null&&u(t,["expireTime"],s);let o=l(e,["displayName"]);t!==void 0&&o!=null&&u(t,["displayName"],o);let a=l(e,["contents"]);t!==void 0&&a!=null&&(Array.isArray(a)?u(t,["contents"],Q(n,Q(n,a).map(p=>ya(n,p)))):u(t,["contents"],Q(n,a)));let d=l(e,["systemInstruction"]);t!==void 0&&d!=null&&u(t,["systemInstruction"],ya(n,Ee(n,d)));let c=l(e,["tools"]);t!==void 0&&c!=null&&(Array.isArray(c)?u(t,["tools"],c.map(p=>bf(n,p))):u(t,["tools"],c));let f=l(e,["toolConfig"]);return t!==void 0&&f!=null&&u(t,["toolConfig"],Af(n,f)),i}function Rf(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["model"],ou(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],Nf(n,r,t)),t}function Lf(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["_url","name"],lt(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function Of(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["_url","name"],lt(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function Bf(n,e,t){let i={},r=l(e,["ttl"]);t!==void 0&&r!=null&&u(t,["ttl"],r);let s=l(e,["expireTime"]);return t!==void 0&&s!=null&&u(t,["expireTime"],s),i}function Vf(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["_url","name"],lt(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],Bf(n,r,t)),t}function Gf(n,e,t){let i={},r=l(e,["pageSize"]);t!==void 0&&r!=null&&u(t,["_query","pageSize"],r);let s=l(e,["pageToken"]);return t!==void 0&&s!=null&&u(t,["_query","pageToken"],s),i}function Uf(n,e){let t={},i=l(e,["config"]);return i!=null&&u(t,["config"],Gf(n,i,t)),t}function Hf(n,e){let t={},i=l(e,["videoMetadata"]);i!=null&&u(t,["videoMetadata"],i);let r=l(e,["thought"]);r!=null&&u(t,["thought"],r);let s=l(e,["codeExecutionResult"]);s!=null&&u(t,["codeExecutionResult"],s);let o=l(e,["executableCode"]);o!=null&&u(t,["executableCode"],o);let a=l(e,["fileData"]);a!=null&&u(t,["fileData"],a);let d=l(e,["functionCall"]);d!=null&&u(t,["functionCall"],d);let c=l(e,["functionResponse"]);c!=null&&u(t,["functionResponse"],c);let f=l(e,["inlineData"]);f!=null&&u(t,["inlineData"],f);let p=l(e,["text"]);return p!=null&&u(t,["text"],p),t}function Da(n,e){let t={},i=l(e,["parts"]);i!=null&&(Array.isArray(i)?u(t,["parts"],i.map(s=>Hf(n,s))):u(t,["parts"],i));let r=l(e,["role"]);return r!=null&&u(t,["role"],r),t}function qf(n,e){let t={},i=l(e,["example"]);i!=null&&u(t,["example"],i);let r=l(e,["pattern"]);r!=null&&u(t,["pattern"],r);let s=l(e,["default"]);s!=null&&u(t,["default"],s);let o=l(e,["maxLength"]);o!=null&&u(t,["maxLength"],o);let a=l(e,["minLength"]);a!=null&&u(t,["minLength"],a);let d=l(e,["minProperties"]);d!=null&&u(t,["minProperties"],d);let c=l(e,["maxProperties"]);c!=null&&u(t,["maxProperties"],c);let f=l(e,["anyOf"]);f!=null&&u(t,["anyOf"],f);let p=l(e,["description"]);p!=null&&u(t,["description"],p);let h=l(e,["enum"]);h!=null&&u(t,["enum"],h);let g=l(e,["format"]);g!=null&&u(t,["format"],g);let v=l(e,["items"]);v!=null&&u(t,["items"],v);let w=l(e,["maxItems"]);w!=null&&u(t,["maxItems"],w);let S=l(e,["maximum"]);S!=null&&u(t,["maximum"],S);let x=l(e,["minItems"]);x!=null&&u(t,["minItems"],x);let I=l(e,["minimum"]);I!=null&&u(t,["minimum"],I);let L=l(e,["nullable"]);L!=null&&u(t,["nullable"],L);let C=l(e,["properties"]);C!=null&&u(t,["properties"],C);let P=l(e,["propertyOrdering"]);P!=null&&u(t,["propertyOrdering"],P);let O=l(e,["required"]);O!=null&&u(t,["required"],O);let T=l(e,["title"]);T!=null&&u(t,["title"],T);let N=l(e,["type"]);return N!=null&&u(t,["type"],N),t}function Wf(n,e){let t={},i=l(e,["response"]);i!=null&&u(t,["response"],qf(n,i));let r=l(e,["description"]);r!=null&&u(t,["description"],r);let s=l(e,["name"]);s!=null&&u(t,["name"],s);let o=l(e,["parameters"]);return o!=null&&u(t,["parameters"],o),t}function $f(){return{}}function zf(n,e){let t={},i=l(e,["mode"]);i!=null&&u(t,["mode"],i);let r=l(e,["dynamicThreshold"]);return r!=null&&u(t,["dynamicThreshold"],r),t}function Yf(n,e){let t={},i=l(e,["dynamicRetrievalConfig"]);return i!=null&&u(t,["dynamicRetrievalConfig"],zf(n,i)),t}function Kf(n,e){let t={},i=l(e,["functionDeclarations"]);i!=null&&(Array.isArray(i)?u(t,["functionDeclarations"],i.map(d=>Wf(n,d))):u(t,["functionDeclarations"],i));let r=l(e,["retrieval"]);r!=null&&u(t,["retrieval"],r),l(e,["googleSearch"])!=null&&u(t,["googleSearch"],$f());let o=l(e,["googleSearchRetrieval"]);o!=null&&u(t,["googleSearchRetrieval"],Yf(n,o));let a=l(e,["codeExecution"]);return a!=null&&u(t,["codeExecution"],a),t}function Jf(n,e){let t={},i=l(e,["mode"]);i!=null&&u(t,["mode"],i);let r=l(e,["allowedFunctionNames"]);return r!=null&&u(t,["allowedFunctionNames"],r),t}function Zf(n,e){let t={},i=l(e,["functionCallingConfig"]);return i!=null&&u(t,["functionCallingConfig"],Jf(n,i)),t}function Qf(n,e,t){let i={},r=l(e,["ttl"]);t!==void 0&&r!=null&&u(t,["ttl"],r);let s=l(e,["expireTime"]);t!==void 0&&s!=null&&u(t,["expireTime"],s);let o=l(e,["displayName"]);t!==void 0&&o!=null&&u(t,["displayName"],o);let a=l(e,["contents"]);t!==void 0&&a!=null&&(Array.isArray(a)?u(t,["contents"],Q(n,Q(n,a).map(p=>Da(n,p)))):u(t,["contents"],Q(n,a)));let d=l(e,["systemInstruction"]);t!==void 0&&d!=null&&u(t,["systemInstruction"],Da(n,Ee(n,d)));let c=l(e,["tools"]);t!==void 0&&c!=null&&(Array.isArray(c)?u(t,["tools"],c.map(p=>Kf(n,p))):u(t,["tools"],c));let f=l(e,["toolConfig"]);return t!==void 0&&f!=null&&u(t,["toolConfig"],Zf(n,f)),i}function Xf(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["model"],ou(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],Qf(n,r,t)),t}function jf(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["_url","name"],lt(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function ep(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["_url","name"],lt(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function tp(n,e,t){let i={},r=l(e,["ttl"]);t!==void 0&&r!=null&&u(t,["ttl"],r);let s=l(e,["expireTime"]);return t!==void 0&&s!=null&&u(t,["expireTime"],s),i}function np(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["_url","name"],lt(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],tp(n,r,t)),t}function ip(n,e,t){let i={},r=l(e,["pageSize"]);t!==void 0&&r!=null&&u(t,["_query","pageSize"],r);let s=l(e,["pageToken"]);return t!==void 0&&s!=null&&u(t,["_query","pageToken"],s),i}function rp(n,e){let t={},i=l(e,["config"]);return i!=null&&u(t,["config"],ip(n,i,t)),t}function di(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["name"],i);let r=l(e,["displayName"]);r!=null&&u(t,["displayName"],r);let s=l(e,["model"]);s!=null&&u(t,["model"],s);let o=l(e,["createTime"]);o!=null&&u(t,["createTime"],o);let a=l(e,["updateTime"]);a!=null&&u(t,["updateTime"],a);let d=l(e,["expireTime"]);d!=null&&u(t,["expireTime"],d);let c=l(e,["usageMetadata"]);return c!=null&&u(t,["usageMetadata"],c),t}function sp(){return{}}function op(n,e){let t={},i=l(e,["nextPageToken"]);i!=null&&u(t,["nextPageToken"],i);let r=l(e,["cachedContents"]);return r!=null&&(Array.isArray(r)?u(t,["cachedContents"],r.map(s=>di(n,s))):u(t,["cachedContents"],r)),t}function fi(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["name"],i);let r=l(e,["displayName"]);r!=null&&u(t,["displayName"],r);let s=l(e,["model"]);s!=null&&u(t,["model"],s);let o=l(e,["createTime"]);o!=null&&u(t,["createTime"],o);let a=l(e,["updateTime"]);a!=null&&u(t,["updateTime"],a);let d=l(e,["expireTime"]);d!=null&&u(t,["expireTime"],d);let c=l(e,["usageMetadata"]);return c!=null&&u(t,["usageMetadata"],c),t}function ap(){return{}}function up(n,e){let t={},i=l(e,["nextPageToken"]);i!=null&&u(t,["nextPageToken"],i);let r=l(e,["cachedContents"]);return r!=null&&(Array.isArray(r)?u(t,["cachedContents"],r.map(s=>fi(n,s))):u(t,["cachedContents"],r)),t}var hi;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(hi||(hi={}));var mi=class{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};i?typeof i=="object"?o=Object.assign({},i):o=i:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(r=o.config)===null||r===void 0?void 0:r.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}};var va;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(va||(va={}));var Ca;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Ca||(Ca={}));var Ea;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(Ea||(Ea={}));var wa;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(wa||(wa={}));var Fa;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Fa||(Fa={}));var Sa;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Sa||(Sa={}));var Ta;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Ta||(Ta={}));var Ma;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(Ma||(Ma={}));var _a;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(_a||(_a={}));var xa;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(xa||(xa={}));var Pa;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(Pa||(Pa={}));var ka;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ka||(ka={}));var gi;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(gi||(gi={}));var ba;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(ba||(ba={}));var Ia;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(Ia||(Ia={}));var Aa;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Aa||(Aa={}));var Na;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(Na||(Na={}));var Ra;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Ra||(Ra={}));var La;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(La||(La={}));var Oa;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})(Oa||(Oa={}));var Ba;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(Ba||(Ba={}));var Va;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(Va||(Va={}));var Ga;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Ga||(Ga={}));var Ua;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Ua||(Ua={}));var Ha;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ha||(Ha={}));var qa;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(qa||(qa={}));var Wa;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Wa||(Wa={}));var $a;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})($a||($a={}));var za;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(za||(za={}));var Ya;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Ya||(Ya={}));var Ut=class{get text(){var e,t,i,r,s,o,a,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",f=!1,p=[];for(let h of(d=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&d!==void 0?d:[]){for(let[g,v]of Object.entries(h))g!=="text"&&g!=="thought"&&(v!==null||v!==void 0)&&p.push(g);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;f=!0,c+=h.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?c:void 0}get data(){var e,t,i,r,s,o,a,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="",f=[];for(let p of(d=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&d!==void 0?d:[]){for(let[h,g]of Object.entries(p))h!=="inlineData"&&(g!==null||g!==void 0)&&f.push(h);p.inlineData&&typeof p.inlineData.data=="string"&&(c+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,t,i,r,s,o,a,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let c=(d=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||d===void 0?void 0:d.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,t,i,r,s,o,a,d,c;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let f=(d=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||d===void 0?void 0:d.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,t,i,r,s,o,a,d,c;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let f=(d=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||d===void 0?void 0:d.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.output}},yi=class{},Di=class{},vi=class{},Qr=class{};var Ci=class{},Ei=class{},Xr=class{},wn=class{constructor(e){let t={};for(let i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}},jr=class{},es=class{};var ts=class extends Ht{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new mi(hi.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=Xf(this.apiClient,e);return a=W("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>fi(this.apiClient,f))}else{let c=Rf(this.apiClient,e);return a=W("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>di(this.apiClient,f))}}async get(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=jf(this.apiClient,e);return a=W("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>fi(this.apiClient,f))}else{let c=Lf(this.apiClient,e);return a=W("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>di(this.apiClient,f))}}async delete(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=ep(this.apiClient,e);return a=W("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(()=>{let f=ap(),p=new Ci;return Object.assign(p,f),p})}else{let c=Of(this.apiClient,e);return a=W("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(()=>{let f=sp(),p=new Ci;return Object.assign(p,f),p})}}async update(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=np(this.apiClient,e);return a=W("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>fi(this.apiClient,f))}else{let c=Vf(this.apiClient,e);return a=W("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>di(this.apiClient,f))}}async listInternal(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=rp(this.apiClient,e);return a=W("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{let p=up(this.apiClient,f),h=new Ei;return Object.assign(h,p),h})}else{let c=Uf(this.apiClient,e);return a=W("cachedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{let p=op(this.apiClient,f),h=new Ei;return Object.assign(h,p),h})}}};function Ka(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function pe(n){return this instanceof pe?(this.v=n,this):new pe(n)}function wi(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(g){return function(v){return Promise.resolve(v).then(g,p)}}function a(g,v){i[g]&&(r[g]=function(w){return new Promise(function(S,x){s.push([g,w,S,x])>1||d(g,w)})},v&&(r[g]=v(r[g])))}function d(g,v){try{c(i[g](v))}catch(w){h(s[0][3],w)}}function c(g){g.value instanceof pe?Promise.resolve(g.value.v).then(f,p):h(s[0][2],g)}function f(g){d("next",g)}function p(g){d("throw",g)}function h(g,v){g(v),s.shift(),s.length&&d(s[0][0],s[0][1])}}function ns(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Ka=="function"?Ka(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,d){o=n[s](o),r(a,d,o.done,o.value)})}}function r(s,o,a,d){Promise.resolve(d).then(function(c){s({value:c,done:a})},o)}}function lp(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;let t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:pu(t)}function pu(n){if(n.parts===void 0||n.parts.length===0)return!1;for(let e of n.parts)if(e===void 0||Object.keys(e).length===0||e.text!==void 0&&e.text==="")return!1;return!0}function cp(n){if(n.length!==0){if(n[0].role!=="user")throw new Error("History must start with a user turn.");for(let e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function dp(n){if(n===void 0||n.length===0)return[];let e=[],t=n.length,i=0,r=n[0];for(;i<t;)if(n[i].role==="user")r=n[i],i++;else{let s=[],o=!0;for(;i<t&&n[i].role==="model";)s.push(n[i]),o&&!pu(n[i])&&(o=!1),i++;o&&(e.push(r),e.push(...s))}return e}var is=class{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new rs(this.apiClient,this.modelsModule,e.model,e.config,e.history)}},rs=class{constructor(e,t,i,r={},s=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=s,this.sendPromise=Promise.resolve(),cp(s)}async sendMessage(e){var t;await this.sendPromise;let i=Ee(this.apiClient,e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,o;let d=(o=(s=(await r).candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,c=d?[d]:[];this.recordHistory(i,c)})(),await this.sendPromise,r}async sendMessageStream(e){var t;await this.sendPromise;let i=Ee(this.apiClient,e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{});let s=await r;return this.processStreamResponse(s,i)}getHistory(e=!1){return e?dp(this.history):this.history}processStreamResponse(e,t){var i,r;return wi(this,arguments,function*(){var o,a,d,c;let f=[];try{for(var p=!0,h=ns(e),g;g=yield pe(h.next()),o=g.done,!o;p=!0){c=g.value,p=!1;let v=c;if(lp(v)){let w=(r=(i=v.candidates)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.content;w!==void 0&&f.push(w)}yield yield pe(v)}}catch(v){a={error:v}}finally{try{!p&&!o&&(d=h.return)&&(yield pe(d.call(h)))}finally{if(a)throw a.error}}this.recordHistory(t,f)})}recordHistory(e,t){let i=[];t.length>0&&t.every(r=>r.role==="model")?i=t:i.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...i)}};function fp(n,e,t){let i={},r=l(e,["pageSize"]);t!==void 0&&r!=null&&u(t,["_query","pageSize"],r);let s=l(e,["pageToken"]);return t!==void 0&&s!=null&&u(t,["_query","pageToken"],s),i}function pp(n,e){let t={},i=l(e,["config"]);return i!=null&&u(t,["config"],fp(n,i,t)),t}function hp(n,e){let t={},i=l(e,["details"]);i!=null&&u(t,["details"],i);let r=l(e,["message"]);r!=null&&u(t,["message"],r);let s=l(e,["code"]);return s!=null&&u(t,["code"],s),t}function mp(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["name"],i);let r=l(e,["displayName"]);r!=null&&u(t,["displayName"],r);let s=l(e,["mimeType"]);s!=null&&u(t,["mimeType"],s);let o=l(e,["sizeBytes"]);o!=null&&u(t,["sizeBytes"],o);let a=l(e,["createTime"]);a!=null&&u(t,["createTime"],a);let d=l(e,["expirationTime"]);d!=null&&u(t,["expirationTime"],d);let c=l(e,["updateTime"]);c!=null&&u(t,["updateTime"],c);let f=l(e,["sha256Hash"]);f!=null&&u(t,["sha256Hash"],f);let p=l(e,["uri"]);p!=null&&u(t,["uri"],p);let h=l(e,["downloadUri"]);h!=null&&u(t,["downloadUri"],h);let g=l(e,["state"]);g!=null&&u(t,["state"],g);let v=l(e,["source"]);v!=null&&u(t,["source"],v);let w=l(e,["videoMetadata"]);w!=null&&u(t,["videoMetadata"],w);let S=l(e,["error"]);return S!=null&&u(t,["error"],hp(n,S)),t}function gp(n,e){let t={},i=l(e,["file"]);i!=null&&u(t,["file"],mp(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function yp(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["_url","file"],fu(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function Dp(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["_url","file"],fu(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function vp(n,e){let t={},i=l(e,["details"]);i!=null&&u(t,["details"],i);let r=l(e,["message"]);r!=null&&u(t,["message"],r);let s=l(e,["code"]);return s!=null&&u(t,["code"],s),t}function ss(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["name"],i);let r=l(e,["displayName"]);r!=null&&u(t,["displayName"],r);let s=l(e,["mimeType"]);s!=null&&u(t,["mimeType"],s);let o=l(e,["sizeBytes"]);o!=null&&u(t,["sizeBytes"],o);let a=l(e,["createTime"]);a!=null&&u(t,["createTime"],a);let d=l(e,["expirationTime"]);d!=null&&u(t,["expirationTime"],d);let c=l(e,["updateTime"]);c!=null&&u(t,["updateTime"],c);let f=l(e,["sha256Hash"]);f!=null&&u(t,["sha256Hash"],f);let p=l(e,["uri"]);p!=null&&u(t,["uri"],p);let h=l(e,["downloadUri"]);h!=null&&u(t,["downloadUri"],h);let g=l(e,["state"]);g!=null&&u(t,["state"],g);let v=l(e,["source"]);v!=null&&u(t,["source"],v);let w=l(e,["videoMetadata"]);w!=null&&u(t,["videoMetadata"],w);let S=l(e,["error"]);return S!=null&&u(t,["error"],vp(n,S)),t}function Cp(n,e){let t={},i=l(e,["nextPageToken"]);i!=null&&u(t,["nextPageToken"],i);let r=l(e,["files"]);return r!=null&&(Array.isArray(r)?u(t,["files"],r.map(s=>ss(n,s))):u(t,["files"],r)),t}function Ep(){return{}}function wp(){return{}}var os=class extends Ht{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new mi(hi.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>ss(this.apiClient,t))}async listInternal(e){var t,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=pp(this.apiClient,e);return s=W("files",a._url),o=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{let c=Cp(this.apiClient,d),f=new Xr;return Object.assign(f,c),f})}}async createInternal(e){var t,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=gp(this.apiClient,e);return s=W("upload/v1beta/files",a._url),o=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(()=>{let d=Ep(),c=new jr;return Object.assign(c,d),c})}}async get(e){var t,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=yp(this.apiClient,e);return s=W("files/{file}",a._url),o=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>ss(this.apiClient,d))}}async delete(e){var t,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=Dp(this.apiClient,e);return s=W("files/{file}",a._url),o=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(()=>{let d=wp(),c=new es;return Object.assign(c,d),c})}}};function Fp(n,e){let t={};if(l(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");let i=l(e,["thought"]);i!=null&&u(t,["thought"],i);let r=l(e,["codeExecutionResult"]);r!=null&&u(t,["codeExecutionResult"],r);let s=l(e,["executableCode"]);s!=null&&u(t,["executableCode"],s);let o=l(e,["fileData"]);o!=null&&u(t,["fileData"],o);let a=l(e,["functionCall"]);a!=null&&u(t,["functionCall"],a);let d=l(e,["functionResponse"]);d!=null&&u(t,["functionResponse"],d);let c=l(e,["inlineData"]);c!=null&&u(t,["inlineData"],c);let f=l(e,["text"]);return f!=null&&u(t,["text"],f),t}function Sp(n,e){let t={},i=l(e,["videoMetadata"]);i!=null&&u(t,["videoMetadata"],i);let r=l(e,["thought"]);r!=null&&u(t,["thought"],r);let s=l(e,["codeExecutionResult"]);s!=null&&u(t,["codeExecutionResult"],s);let o=l(e,["executableCode"]);o!=null&&u(t,["executableCode"],o);let a=l(e,["fileData"]);a!=null&&u(t,["fileData"],a);let d=l(e,["functionCall"]);d!=null&&u(t,["functionCall"],d);let c=l(e,["functionResponse"]);c!=null&&u(t,["functionResponse"],c);let f=l(e,["inlineData"]);f!=null&&u(t,["inlineData"],f);let p=l(e,["text"]);return p!=null&&u(t,["text"],p),t}function Tp(n,e){let t={},i=l(e,["parts"]);i!=null&&(Array.isArray(i)?u(t,["parts"],i.map(s=>Fp(n,s))):u(t,["parts"],i));let r=l(e,["role"]);return r!=null&&u(t,["role"],r),t}function Mp(n,e){let t={},i=l(e,["parts"]);i!=null&&(Array.isArray(i)?u(t,["parts"],i.map(s=>Sp(n,s))):u(t,["parts"],i));let r=l(e,["role"]);return r!=null&&u(t,["role"],r),t}function _p(n,e){let t={},i=l(e,["example"]);i!=null&&u(t,["example"],i);let r=l(e,["pattern"]);r!=null&&u(t,["pattern"],r);let s=l(e,["default"]);s!=null&&u(t,["default"],s);let o=l(e,["maxLength"]);o!=null&&u(t,["maxLength"],o);let a=l(e,["minLength"]);a!=null&&u(t,["minLength"],a);let d=l(e,["minProperties"]);d!=null&&u(t,["minProperties"],d);let c=l(e,["maxProperties"]);c!=null&&u(t,["maxProperties"],c);let f=l(e,["anyOf"]);f!=null&&u(t,["anyOf"],f);let p=l(e,["description"]);p!=null&&u(t,["description"],p);let h=l(e,["enum"]);h!=null&&u(t,["enum"],h);let g=l(e,["format"]);g!=null&&u(t,["format"],g);let v=l(e,["items"]);v!=null&&u(t,["items"],v);let w=l(e,["maxItems"]);w!=null&&u(t,["maxItems"],w);let S=l(e,["maximum"]);S!=null&&u(t,["maximum"],S);let x=l(e,["minItems"]);x!=null&&u(t,["minItems"],x);let I=l(e,["minimum"]);I!=null&&u(t,["minimum"],I);let L=l(e,["nullable"]);L!=null&&u(t,["nullable"],L);let C=l(e,["properties"]);C!=null&&u(t,["properties"],C);let P=l(e,["propertyOrdering"]);P!=null&&u(t,["propertyOrdering"],P);let O=l(e,["required"]);O!=null&&u(t,["required"],O);let T=l(e,["title"]);T!=null&&u(t,["title"],T);let N=l(e,["type"]);return N!=null&&u(t,["type"],N),t}function xp(n,e){let t={};if(l(e,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");let i=l(e,["description"]);i!=null&&u(t,["description"],i);let r=l(e,["name"]);r!=null&&u(t,["name"],r);let s=l(e,["parameters"]);return s!=null&&u(t,["parameters"],s),t}function Pp(n,e){let t={},i=l(e,["response"]);i!=null&&u(t,["response"],_p(n,i));let r=l(e,["description"]);r!=null&&u(t,["description"],r);let s=l(e,["name"]);s!=null&&u(t,["name"],s);let o=l(e,["parameters"]);return o!=null&&u(t,["parameters"],o),t}function kp(){return{}}function bp(){return{}}function Ip(n,e){let t={},i=l(e,["mode"]);i!=null&&u(t,["mode"],i);let r=l(e,["dynamicThreshold"]);return r!=null&&u(t,["dynamicThreshold"],r),t}function Ap(n,e){let t={},i=l(e,["mode"]);i!=null&&u(t,["mode"],i);let r=l(e,["dynamicThreshold"]);return r!=null&&u(t,["dynamicThreshold"],r),t}function Np(n,e){let t={},i=l(e,["dynamicRetrievalConfig"]);return i!=null&&u(t,["dynamicRetrievalConfig"],Ip(n,i)),t}function Rp(n,e){let t={},i=l(e,["dynamicRetrievalConfig"]);return i!=null&&u(t,["dynamicRetrievalConfig"],Ap(n,i)),t}function Lp(n,e){let t={},i=l(e,["functionDeclarations"]);if(i!=null&&(Array.isArray(i)?u(t,["functionDeclarations"],i.map(a=>xp(n,a))):u(t,["functionDeclarations"],i)),l(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");l(e,["googleSearch"])!=null&&u(t,["googleSearch"],kp());let s=l(e,["googleSearchRetrieval"]);s!=null&&u(t,["googleSearchRetrieval"],Np(n,s));let o=l(e,["codeExecution"]);return o!=null&&u(t,["codeExecution"],o),t}function Op(n,e){let t={},i=l(e,["functionDeclarations"]);i!=null&&(Array.isArray(i)?u(t,["functionDeclarations"],i.map(d=>Pp(n,d))):u(t,["functionDeclarations"],i));let r=l(e,["retrieval"]);r!=null&&u(t,["retrieval"],r),l(e,["googleSearch"])!=null&&u(t,["googleSearch"],bp());let o=l(e,["googleSearchRetrieval"]);o!=null&&u(t,["googleSearchRetrieval"],Rp(n,o));let a=l(e,["codeExecution"]);return a!=null&&u(t,["codeExecution"],a),t}function Bp(n,e){let t={},i=l(e,["handle"]);if(i!=null&&u(t,["handle"],i),l(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Vp(n,e){let t={},i=l(e,["handle"]);i!=null&&u(t,["handle"],i);let r=l(e,["transparent"]);return r!=null&&u(t,["transparent"],r),t}function Gp(){return{}}function Ja(){return{}}function Up(n,e){let t={},i=l(e,["disabled"]);i!=null&&u(t,["disabled"],i);let r=l(e,["startOfSpeechSensitivity"]);r!=null&&u(t,["startOfSpeechSensitivity"],r);let s=l(e,["endOfSpeechSensitivity"]);s!=null&&u(t,["endOfSpeechSensitivity"],s);let o=l(e,["prefixPaddingMs"]);o!=null&&u(t,["prefixPaddingMs"],o);let a=l(e,["silenceDurationMs"]);return a!=null&&u(t,["silenceDurationMs"],a),t}function Hp(n,e){let t={},i=l(e,["disabled"]);i!=null&&u(t,["disabled"],i);let r=l(e,["startOfSpeechSensitivity"]);r!=null&&u(t,["startOfSpeechSensitivity"],r);let s=l(e,["endOfSpeechSensitivity"]);s!=null&&u(t,["endOfSpeechSensitivity"],s);let o=l(e,["prefixPaddingMs"]);o!=null&&u(t,["prefixPaddingMs"],o);let a=l(e,["silenceDurationMs"]);return a!=null&&u(t,["silenceDurationMs"],a),t}function qp(n,e){let t={},i=l(e,["automaticActivityDetection"]);i!=null&&u(t,["automaticActivityDetection"],Up(n,i));let r=l(e,["activityHandling"]);r!=null&&u(t,["activityHandling"],r);let s=l(e,["turnCoverage"]);return s!=null&&u(t,["turnCoverage"],s),t}function Wp(n,e){let t={},i=l(e,["automaticActivityDetection"]);i!=null&&u(t,["automaticActivityDetection"],Hp(n,i));let r=l(e,["activityHandling"]);r!=null&&u(t,["activityHandling"],r);let s=l(e,["turnCoverage"]);return s!=null&&u(t,["turnCoverage"],s),t}function $p(n,e){let t={},i=l(e,["targetTokens"]);return i!=null&&u(t,["targetTokens"],i),t}function zp(n,e){let t={},i=l(e,["targetTokens"]);return i!=null&&u(t,["targetTokens"],i),t}function Yp(n,e){let t={},i=l(e,["triggerTokens"]);i!=null&&u(t,["triggerTokens"],i);let r=l(e,["slidingWindow"]);return r!=null&&u(t,["slidingWindow"],$p(n,r)),t}function Kp(n,e){let t={},i=l(e,["triggerTokens"]);i!=null&&u(t,["triggerTokens"],i);let r=l(e,["slidingWindow"]);return r!=null&&u(t,["slidingWindow"],zp(n,r)),t}function Jp(n,e,t){let i={},r=l(e,["generationConfig"]);t!==void 0&&r!=null&&u(t,["setup","generationConfig"],r);let s=l(e,["responseModalities"]);t!==void 0&&s!=null&&u(t,["setup","generationConfig","responseModalities"],s);let o=l(e,["temperature"]);t!==void 0&&o!=null&&u(t,["setup","generationConfig","temperature"],o);let a=l(e,["topP"]);t!==void 0&&a!=null&&u(t,["setup","generationConfig","topP"],a);let d=l(e,["topK"]);t!==void 0&&d!=null&&u(t,["setup","generationConfig","topK"],d);let c=l(e,["maxOutputTokens"]);t!==void 0&&c!=null&&u(t,["setup","generationConfig","maxOutputTokens"],c);let f=l(e,["mediaResolution"]);t!==void 0&&f!=null&&u(t,["setup","generationConfig","mediaResolution"],f);let p=l(e,["seed"]);t!==void 0&&p!=null&&u(t,["setup","generationConfig","seed"],p);let h=l(e,["speechConfig"]);t!==void 0&&h!=null&&u(t,["setup","generationConfig","speechConfig"],h);let g=l(e,["systemInstruction"]);t!==void 0&&g!=null&&u(t,["setup","systemInstruction"],Tp(n,Ee(n,g)));let v=l(e,["tools"]);t!==void 0&&v!=null&&(Array.isArray(v)?u(t,["setup","tools"],be(n,be(n,v).map(L=>Lp(n,Ti(n,L))))):u(t,["setup","tools"],be(n,v)));let w=l(e,["sessionResumption"]);if(t!==void 0&&w!=null&&u(t,["setup","sessionResumption"],Bp(n,w)),l(e,["inputAudioTranscription"])!==void 0)throw new Error("inputAudioTranscription parameter is not supported in Gemini API.");let S=l(e,["outputAudioTranscription"]);t!==void 0&&S!=null&&u(t,["setup","outputAudioTranscription"],Gp());let x=l(e,["realtimeInputConfig"]);t!==void 0&&x!=null&&u(t,["setup","realtimeInputConfig"],qp(n,x));let I=l(e,["contextWindowCompression"]);return t!==void 0&&I!=null&&u(t,["setup","contextWindowCompression"],Yp(n,I)),i}function Zp(n,e,t){let i={},r=l(e,["generationConfig"]);t!==void 0&&r!=null&&u(t,["setup","generationConfig"],r);let s=l(e,["responseModalities"]);t!==void 0&&s!=null&&u(t,["setup","generationConfig","responseModalities"],s);let o=l(e,["temperature"]);t!==void 0&&o!=null&&u(t,["setup","generationConfig","temperature"],o);let a=l(e,["topP"]);t!==void 0&&a!=null&&u(t,["setup","generationConfig","topP"],a);let d=l(e,["topK"]);t!==void 0&&d!=null&&u(t,["setup","generationConfig","topK"],d);let c=l(e,["maxOutputTokens"]);t!==void 0&&c!=null&&u(t,["setup","generationConfig","maxOutputTokens"],c);let f=l(e,["mediaResolution"]);t!==void 0&&f!=null&&u(t,["setup","generationConfig","mediaResolution"],f);let p=l(e,["seed"]);t!==void 0&&p!=null&&u(t,["setup","generationConfig","seed"],p);let h=l(e,["speechConfig"]);t!==void 0&&h!=null&&u(t,["setup","generationConfig","speechConfig"],h);let g=l(e,["systemInstruction"]);t!==void 0&&g!=null&&u(t,["setup","systemInstruction"],Mp(n,Ee(n,g)));let v=l(e,["tools"]);t!==void 0&&v!=null&&(Array.isArray(v)?u(t,["setup","tools"],be(n,be(n,v).map(C=>Op(n,Ti(n,C))))):u(t,["setup","tools"],be(n,v)));let w=l(e,["sessionResumption"]);t!==void 0&&w!=null&&u(t,["setup","sessionResumption"],Vp(n,w));let S=l(e,["inputAudioTranscription"]);t!==void 0&&S!=null&&u(t,["setup","inputAudioTranscription"],Ja());let x=l(e,["outputAudioTranscription"]);t!==void 0&&x!=null&&u(t,["setup","outputAudioTranscription"],Ja());let I=l(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&u(t,["setup","realtimeInputConfig"],Wp(n,I));let L=l(e,["contextWindowCompression"]);return t!==void 0&&L!=null&&u(t,["setup","contextWindowCompression"],Kp(n,L)),i}function Qp(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["setup","model"],ue(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],Jp(n,r,t)),t}function Xp(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["setup","model"],ue(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],Zp(n,r,t)),t}function jp(){return{}}function eh(){return{}}function th(){return{}}function nh(){return{}}function ih(n,e){let t={},i=l(e,["media"]);i!=null&&u(t,["mediaChunks"],au(n,i));let r=l(e,["audio"]);r!=null&&u(t,["audio"],Sf(n,r));let s=l(e,["audioStreamEnd"]);s!=null&&u(t,["audioStreamEnd"],s);let o=l(e,["video"]);o!=null&&u(t,["video"],Ff(n,o));let a=l(e,["text"]);return a!=null&&u(t,["text"],a),l(e,["activityStart"])!=null&&u(t,["activityStart"],jp()),l(e,["activityEnd"])!=null&&u(t,["activityEnd"],th()),t}function rh(n,e){let t={},i=l(e,["media"]);if(i!=null&&u(t,["mediaChunks"],au(n,i)),l(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");let r=l(e,["audioStreamEnd"]);if(r!=null&&u(t,["audioStreamEnd"],r),l(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(l(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return l(e,["activityStart"])!=null&&u(t,["activityStart"],eh()),l(e,["activityEnd"])!=null&&u(t,["activityEnd"],nh()),t}function sh(){return{}}function oh(){return{}}function ah(n,e){let t={},i=l(e,["thought"]);i!=null&&u(t,["thought"],i);let r=l(e,["codeExecutionResult"]);r!=null&&u(t,["codeExecutionResult"],r);let s=l(e,["executableCode"]);s!=null&&u(t,["executableCode"],s);let o=l(e,["fileData"]);o!=null&&u(t,["fileData"],o);let a=l(e,["functionCall"]);a!=null&&u(t,["functionCall"],a);let d=l(e,["functionResponse"]);d!=null&&u(t,["functionResponse"],d);let c=l(e,["inlineData"]);c!=null&&u(t,["inlineData"],c);let f=l(e,["text"]);return f!=null&&u(t,["text"],f),t}function uh(n,e){let t={},i=l(e,["videoMetadata"]);i!=null&&u(t,["videoMetadata"],i);let r=l(e,["thought"]);r!=null&&u(t,["thought"],r);let s=l(e,["codeExecutionResult"]);s!=null&&u(t,["codeExecutionResult"],s);let o=l(e,["executableCode"]);o!=null&&u(t,["executableCode"],o);let a=l(e,["fileData"]);a!=null&&u(t,["fileData"],a);let d=l(e,["functionCall"]);d!=null&&u(t,["functionCall"],d);let c=l(e,["functionResponse"]);c!=null&&u(t,["functionResponse"],c);let f=l(e,["inlineData"]);f!=null&&u(t,["inlineData"],f);let p=l(e,["text"]);return p!=null&&u(t,["text"],p),t}function lh(n,e){let t={},i=l(e,["parts"]);i!=null&&(Array.isArray(i)?u(t,["parts"],i.map(s=>ah(n,s))):u(t,["parts"],i));let r=l(e,["role"]);return r!=null&&u(t,["role"],r),t}function ch(n,e){let t={},i=l(e,["parts"]);i!=null&&(Array.isArray(i)?u(t,["parts"],i.map(s=>uh(n,s))):u(t,["parts"],i));let r=l(e,["role"]);return r!=null&&u(t,["role"],r),t}function Za(n,e){let t={},i=l(e,["text"]);i!=null&&u(t,["text"],i);let r=l(e,["finished"]);return r!=null&&u(t,["finished"],r),t}function Qa(n,e){let t={},i=l(e,["text"]);i!=null&&u(t,["text"],i);let r=l(e,["finished"]);return r!=null&&u(t,["finished"],r),t}function dh(n,e){let t={},i=l(e,["modelTurn"]);i!=null&&u(t,["modelTurn"],lh(n,i));let r=l(e,["turnComplete"]);r!=null&&u(t,["turnComplete"],r);let s=l(e,["interrupted"]);s!=null&&u(t,["interrupted"],s);let o=l(e,["generationComplete"]);o!=null&&u(t,["generationComplete"],o);let a=l(e,["inputTranscription"]);a!=null&&u(t,["inputTranscription"],Za(n,a));let d=l(e,["outputTranscription"]);return d!=null&&u(t,["outputTranscription"],Za(n,d)),t}function fh(n,e){let t={},i=l(e,["modelTurn"]);i!=null&&u(t,["modelTurn"],ch(n,i));let r=l(e,["turnComplete"]);r!=null&&u(t,["turnComplete"],r);let s=l(e,["interrupted"]);s!=null&&u(t,["interrupted"],s);let o=l(e,["generationComplete"]);o!=null&&u(t,["generationComplete"],o);let a=l(e,["inputTranscription"]);a!=null&&u(t,["inputTranscription"],Qa(n,a));let d=l(e,["outputTranscription"]);return d!=null&&u(t,["outputTranscription"],Qa(n,d)),t}function ph(n,e){let t={},i=l(e,["id"]);i!=null&&u(t,["id"],i);let r=l(e,["args"]);r!=null&&u(t,["args"],r);let s=l(e,["name"]);return s!=null&&u(t,["name"],s),t}function hh(n,e){let t={},i=l(e,["args"]);i!=null&&u(t,["args"],i);let r=l(e,["name"]);return r!=null&&u(t,["name"],r),t}function mh(n,e){let t={},i=l(e,["functionCalls"]);return i!=null&&(Array.isArray(i)?u(t,["functionCalls"],i.map(r=>ph(n,r))):u(t,["functionCalls"],i)),t}function gh(n,e){let t={},i=l(e,["functionCalls"]);return i!=null&&(Array.isArray(i)?u(t,["functionCalls"],i.map(r=>hh(n,r))):u(t,["functionCalls"],i)),t}function yh(n,e){let t={},i=l(e,["ids"]);return i!=null&&u(t,["ids"],i),t}function Dh(n,e){let t={},i=l(e,["ids"]);return i!=null&&u(t,["ids"],i),t}function li(n,e){let t={},i=l(e,["modality"]);i!=null&&u(t,["modality"],i);let r=l(e,["tokenCount"]);return r!=null&&u(t,["tokenCount"],r),t}function ci(n,e){let t={},i=l(e,["modality"]);i!=null&&u(t,["modality"],i);let r=l(e,["tokenCount"]);return r!=null&&u(t,["tokenCount"],r),t}function vh(n,e){let t={},i=l(e,["promptTokenCount"]);i!=null&&u(t,["promptTokenCount"],i);let r=l(e,["cachedContentTokenCount"]);r!=null&&u(t,["cachedContentTokenCount"],r);let s=l(e,["responseTokenCount"]);s!=null&&u(t,["responseTokenCount"],s);let o=l(e,["toolUsePromptTokenCount"]);o!=null&&u(t,["toolUsePromptTokenCount"],o);let a=l(e,["thoughtsTokenCount"]);a!=null&&u(t,["thoughtsTokenCount"],a);let d=l(e,["totalTokenCount"]);d!=null&&u(t,["totalTokenCount"],d);let c=l(e,["promptTokensDetails"]);c!=null&&(Array.isArray(c)?u(t,["promptTokensDetails"],c.map(g=>li(n,g))):u(t,["promptTokensDetails"],c));let f=l(e,["cacheTokensDetails"]);f!=null&&(Array.isArray(f)?u(t,["cacheTokensDetails"],f.map(g=>li(n,g))):u(t,["cacheTokensDetails"],f));let p=l(e,["responseTokensDetails"]);p!=null&&(Array.isArray(p)?u(t,["responseTokensDetails"],p.map(g=>li(n,g))):u(t,["responseTokensDetails"],p));let h=l(e,["toolUsePromptTokensDetails"]);return h!=null&&(Array.isArray(h)?u(t,["toolUsePromptTokensDetails"],h.map(g=>li(n,g))):u(t,["toolUsePromptTokensDetails"],h)),t}function Ch(n,e){let t={},i=l(e,["promptTokenCount"]);i!=null&&u(t,["promptTokenCount"],i);let r=l(e,["cachedContentTokenCount"]);r!=null&&u(t,["cachedContentTokenCount"],r);let s=l(e,["candidatesTokenCount"]);s!=null&&u(t,["responseTokenCount"],s);let o=l(e,["toolUsePromptTokenCount"]);o!=null&&u(t,["toolUsePromptTokenCount"],o);let a=l(e,["thoughtsTokenCount"]);a!=null&&u(t,["thoughtsTokenCount"],a);let d=l(e,["totalTokenCount"]);d!=null&&u(t,["totalTokenCount"],d);let c=l(e,["promptTokensDetails"]);c!=null&&(Array.isArray(c)?u(t,["promptTokensDetails"],c.map(v=>ci(n,v))):u(t,["promptTokensDetails"],c));let f=l(e,["cacheTokensDetails"]);f!=null&&(Array.isArray(f)?u(t,["cacheTokensDetails"],f.map(v=>ci(n,v))):u(t,["cacheTokensDetails"],f));let p=l(e,["candidatesTokensDetails"]);p!=null&&(Array.isArray(p)?u(t,["responseTokensDetails"],p.map(v=>ci(n,v))):u(t,["responseTokensDetails"],p));let h=l(e,["toolUsePromptTokensDetails"]);h!=null&&(Array.isArray(h)?u(t,["toolUsePromptTokensDetails"],h.map(v=>ci(n,v))):u(t,["toolUsePromptTokensDetails"],h));let g=l(e,["trafficType"]);return g!=null&&u(t,["trafficType"],g),t}function Eh(n,e){let t={},i=l(e,["timeLeft"]);return i!=null&&u(t,["timeLeft"],i),t}function wh(n,e){let t={},i=l(e,["timeLeft"]);return i!=null&&u(t,["timeLeft"],i),t}function Fh(n,e){let t={},i=l(e,["newHandle"]);i!=null&&u(t,["newHandle"],i);let r=l(e,["resumable"]);r!=null&&u(t,["resumable"],r);let s=l(e,["lastConsumedClientMessageIndex"]);return s!=null&&u(t,["lastConsumedClientMessageIndex"],s),t}function Sh(n,e){let t={},i=l(e,["newHandle"]);i!=null&&u(t,["newHandle"],i);let r=l(e,["resumable"]);r!=null&&u(t,["resumable"],r);let s=l(e,["lastConsumedClientMessageIndex"]);return s!=null&&u(t,["lastConsumedClientMessageIndex"],s),t}function Th(n,e){let t={};l(e,["setupComplete"])!=null&&u(t,["setupComplete"],sh());let r=l(e,["serverContent"]);r!=null&&u(t,["serverContent"],dh(n,r));let s=l(e,["toolCall"]);s!=null&&u(t,["toolCall"],mh(n,s));let o=l(e,["toolCallCancellation"]);o!=null&&u(t,["toolCallCancellation"],yh(n,o));let a=l(e,["usageMetadata"]);a!=null&&u(t,["usageMetadata"],vh(n,a));let d=l(e,["goAway"]);d!=null&&u(t,["goAway"],Eh(n,d));let c=l(e,["sessionResumptionUpdate"]);return c!=null&&u(t,["sessionResumptionUpdate"],Fh(n,c)),t}function Mh(n,e){let t={};l(e,["setupComplete"])!=null&&u(t,["setupComplete"],oh());let r=l(e,["serverContent"]);r!=null&&u(t,["serverContent"],fh(n,r));let s=l(e,["toolCall"]);s!=null&&u(t,["toolCall"],gh(n,s));let o=l(e,["toolCallCancellation"]);o!=null&&u(t,["toolCallCancellation"],Dh(n,o));let a=l(e,["usageMetadata"]);a!=null&&u(t,["usageMetadata"],Ch(n,a));let d=l(e,["goAway"]);d!=null&&u(t,["goAway"],wh(n,d));let c=l(e,["sessionResumptionUpdate"]);return c!=null&&u(t,["sessionResumptionUpdate"],Sh(n,c)),t}function _h(n,e){let t={};if(l(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");let i=l(e,["thought"]);i!=null&&u(t,["thought"],i);let r=l(e,["codeExecutionResult"]);r!=null&&u(t,["codeExecutionResult"],r);let s=l(e,["executableCode"]);s!=null&&u(t,["executableCode"],s);let o=l(e,["fileData"]);o!=null&&u(t,["fileData"],o);let a=l(e,["functionCall"]);a!=null&&u(t,["functionCall"],a);let d=l(e,["functionResponse"]);d!=null&&u(t,["functionResponse"],d);let c=l(e,["inlineData"]);c!=null&&u(t,["inlineData"],c);let f=l(e,["text"]);return f!=null&&u(t,["text"],f),t}function Mi(n,e){let t={},i=l(e,["parts"]);i!=null&&(Array.isArray(i)?u(t,["parts"],i.map(s=>_h(n,s))):u(t,["parts"],i));let r=l(e,["role"]);return r!=null&&u(t,["role"],r),t}function xh(n,e){let t={};if(l(e,["example"])!==void 0)throw new Error("example parameter is not supported in Gemini API.");if(l(e,["pattern"])!==void 0)throw new Error("pattern parameter is not supported in Gemini API.");if(l(e,["default"])!==void 0)throw new Error("default parameter is not supported in Gemini API.");if(l(e,["maxLength"])!==void 0)throw new Error("maxLength parameter is not supported in Gemini API.");if(l(e,["minLength"])!==void 0)throw new Error("minLength parameter is not supported in Gemini API.");if(l(e,["minProperties"])!==void 0)throw new Error("minProperties parameter is not supported in Gemini API.");if(l(e,["maxProperties"])!==void 0)throw new Error("maxProperties parameter is not supported in Gemini API.");let i=l(e,["anyOf"]);i!=null&&u(t,["anyOf"],i);let r=l(e,["description"]);r!=null&&u(t,["description"],r);let s=l(e,["enum"]);s!=null&&u(t,["enum"],s);let o=l(e,["format"]);o!=null&&u(t,["format"],o);let a=l(e,["items"]);a!=null&&u(t,["items"],a);let d=l(e,["maxItems"]);d!=null&&u(t,["maxItems"],d);let c=l(e,["maximum"]);c!=null&&u(t,["maximum"],c);let f=l(e,["minItems"]);f!=null&&u(t,["minItems"],f);let p=l(e,["minimum"]);p!=null&&u(t,["minimum"],p);let h=l(e,["nullable"]);h!=null&&u(t,["nullable"],h);let g=l(e,["properties"]);g!=null&&u(t,["properties"],g);let v=l(e,["propertyOrdering"]);v!=null&&u(t,["propertyOrdering"],v);let w=l(e,["required"]);w!=null&&u(t,["required"],w);let S=l(e,["title"]);S!=null&&u(t,["title"],S);let x=l(e,["type"]);return x!=null&&u(t,["type"],x),t}function Ph(n,e){let t={};if(l(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");let i=l(e,["category"]);i!=null&&u(t,["category"],i);let r=l(e,["threshold"]);return r!=null&&u(t,["threshold"],r),t}function kh(n,e){let t={};if(l(e,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");let i=l(e,["description"]);i!=null&&u(t,["description"],i);let r=l(e,["name"]);r!=null&&u(t,["name"],r);let s=l(e,["parameters"]);return s!=null&&u(t,["parameters"],s),t}function bh(){return{}}function Ih(n,e){let t={},i=l(e,["mode"]);i!=null&&u(t,["mode"],i);let r=l(e,["dynamicThreshold"]);return r!=null&&u(t,["dynamicThreshold"],r),t}function Ah(n,e){let t={},i=l(e,["dynamicRetrievalConfig"]);return i!=null&&u(t,["dynamicRetrievalConfig"],Ih(n,i)),t}function Nh(n,e){let t={},i=l(e,["functionDeclarations"]);if(i!=null&&(Array.isArray(i)?u(t,["functionDeclarations"],i.map(a=>kh(n,a))):u(t,["functionDeclarations"],i)),l(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");l(e,["googleSearch"])!=null&&u(t,["googleSearch"],bh());let s=l(e,["googleSearchRetrieval"]);s!=null&&u(t,["googleSearchRetrieval"],Ah(n,s));let o=l(e,["codeExecution"]);return o!=null&&u(t,["codeExecution"],o),t}function Rh(n,e){let t={},i=l(e,["mode"]);i!=null&&u(t,["mode"],i);let r=l(e,["allowedFunctionNames"]);return r!=null&&u(t,["allowedFunctionNames"],r),t}function Lh(n,e){let t={},i=l(e,["functionCallingConfig"]);return i!=null&&u(t,["functionCallingConfig"],Rh(n,i)),t}function Oh(n,e){let t={},i=l(e,["voiceName"]);return i!=null&&u(t,["voiceName"],i),t}function Bh(n,e){let t={},i=l(e,["prebuiltVoiceConfig"]);return i!=null&&u(t,["prebuiltVoiceConfig"],Oh(n,i)),t}function Vh(n,e){let t={},i=l(e,["voiceConfig"]);i!=null&&u(t,["voiceConfig"],Bh(n,i));let r=l(e,["languageCode"]);return r!=null&&u(t,["languageCode"],r),t}function Gh(n,e){let t={},i=l(e,["includeThoughts"]);i!=null&&u(t,["includeThoughts"],i);let r=l(e,["thinkingBudget"]);return r!=null&&u(t,["thinkingBudget"],r),t}function Uh(n,e,t){let i={},r=l(e,["systemInstruction"]);t!==void 0&&r!=null&&u(t,["systemInstruction"],Mi(n,Ee(n,r)));let s=l(e,["temperature"]);s!=null&&u(i,["temperature"],s);let o=l(e,["topP"]);o!=null&&u(i,["topP"],o);let a=l(e,["topK"]);a!=null&&u(i,["topK"],a);let d=l(e,["candidateCount"]);d!=null&&u(i,["candidateCount"],d);let c=l(e,["maxOutputTokens"]);c!=null&&u(i,["maxOutputTokens"],c);let f=l(e,["stopSequences"]);f!=null&&u(i,["stopSequences"],f);let p=l(e,["responseLogprobs"]);p!=null&&u(i,["responseLogprobs"],p);let h=l(e,["logprobs"]);h!=null&&u(i,["logprobs"],h);let g=l(e,["presencePenalty"]);g!=null&&u(i,["presencePenalty"],g);let v=l(e,["frequencyPenalty"]);v!=null&&u(i,["frequencyPenalty"],v);let w=l(e,["seed"]);w!=null&&u(i,["seed"],w);let S=l(e,["responseMimeType"]);S!=null&&u(i,["responseMimeType"],S);let x=l(e,["responseSchema"]);if(x!=null&&u(i,["responseSchema"],xh(n,cu(n,x))),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");let I=l(e,["safetySettings"]);t!==void 0&&I!=null&&(Array.isArray(I)?u(t,["safetySettings"],I.map(te=>Ph(n,te))):u(t,["safetySettings"],I));let L=l(e,["tools"]);t!==void 0&&L!=null&&(Array.isArray(L)?u(t,["tools"],be(n,be(n,L).map(te=>Nh(n,Ti(n,te))))):u(t,["tools"],be(n,L)));let C=l(e,["toolConfig"]);if(t!==void 0&&C!=null&&u(t,["toolConfig"],Lh(n,C)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let P=l(e,["cachedContent"]);t!==void 0&&P!=null&&u(t,["cachedContent"],lt(n,P));let O=l(e,["responseModalities"]);O!=null&&u(i,["responseModalities"],O);let T=l(e,["mediaResolution"]);T!=null&&u(i,["mediaResolution"],T);let N=l(e,["speechConfig"]);if(N!=null&&u(i,["speechConfig"],Vh(n,du(n,N))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");let $=l(e,["thinkingConfig"]);return $!=null&&u(i,["thinkingConfig"],Gh(n,$)),i}function Xa(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["contents"]);r!=null&&(Array.isArray(r)?u(t,["contents"],Q(n,Q(n,r).map(o=>Mi(n,o)))):u(t,["contents"],Q(n,r)));let s=l(e,["config"]);return s!=null&&u(t,["generationConfig"],Uh(n,s,t)),t}function Hh(n,e,t){let i={},r=l(e,["taskType"]);t!==void 0&&r!=null&&u(t,["requests[]","taskType"],r);let s=l(e,["title"]);t!==void 0&&s!=null&&u(t,["requests[]","title"],s);let o=l(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&u(t,["requests[]","outputDimensionality"],o),l(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return i}function qh(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["contents"]);r!=null&&u(t,["requests[]","content"],lu(n,r));let s=l(e,["config"]);s!=null&&u(t,["config"],Hh(n,s,t));let o=l(e,["model"]);return o!==void 0&&u(t,["requests[]","model"],ue(n,o)),t}function Wh(n,e,t){let i={};if(l(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");let r=l(e,["numberOfImages"]);t!==void 0&&r!=null&&u(t,["parameters","sampleCount"],r);let s=l(e,["aspectRatio"]);t!==void 0&&s!=null&&u(t,["parameters","aspectRatio"],s);let o=l(e,["guidanceScale"]);if(t!==void 0&&o!=null&&u(t,["parameters","guidanceScale"],o),l(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");let a=l(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&u(t,["parameters","safetySetting"],a);let d=l(e,["personGeneration"]);t!==void 0&&d!=null&&u(t,["parameters","personGeneration"],d);let c=l(e,["includeSafetyAttributes"]);t!==void 0&&c!=null&&u(t,["parameters","includeSafetyAttributes"],c);let f=l(e,["includeRaiReason"]);t!==void 0&&f!=null&&u(t,["parameters","includeRaiReason"],f);let p=l(e,["language"]);t!==void 0&&p!=null&&u(t,["parameters","language"],p);let h=l(e,["outputMimeType"]);t!==void 0&&h!=null&&u(t,["parameters","outputOptions","mimeType"],h);let g=l(e,["outputCompressionQuality"]);if(t!==void 0&&g!=null&&u(t,["parameters","outputOptions","compressionQuality"],g),l(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(l(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function $h(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["prompt"]);r!=null&&u(t,["instances[0]","prompt"],r);let s=l(e,["config"]);return s!=null&&u(t,["config"],Wh(n,s,t)),t}function zh(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","name"],ue(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function Yh(n,e){let t={};if(l(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(l(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(l(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function Kh(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["contents"]);r!=null&&(Array.isArray(r)?u(t,["contents"],Q(n,Q(n,r).map(o=>Mi(n,o)))):u(t,["contents"],Q(n,r)));let s=l(e,["config"]);return s!=null&&u(t,["config"],Yh(n,s)),t}function Jh(n,e){let t={};if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");let i=l(e,["imageBytes"]);i!=null&&u(t,["bytesBase64Encoded"],ct(n,i));let r=l(e,["mimeType"]);return r!=null&&u(t,["mimeType"],r),t}function Zh(n,e,t){let i={},r=l(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&u(t,["parameters","sampleCount"],r),l(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");let s=l(e,["durationSeconds"]);if(t!==void 0&&s!=null&&u(t,["parameters","durationSeconds"],s),l(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");let o=l(e,["aspectRatio"]);if(t!==void 0&&o!=null&&u(t,["parameters","aspectRatio"],o),l(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");let a=l(e,["personGeneration"]);if(t!==void 0&&a!=null&&u(t,["parameters","personGeneration"],a),l(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");let d=l(e,["negativePrompt"]);if(t!==void 0&&d!=null&&u(t,["parameters","negativePrompt"],d),l(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function Qh(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["prompt"]);r!=null&&u(t,["instances[0]","prompt"],r);let s=l(e,["image"]);s!=null&&u(t,["instances[0]","image"],Jh(n,s));let o=l(e,["config"]);return o!=null&&u(t,["config"],Zh(n,o,t)),t}function Xh(n,e){let t={},i=l(e,["videoMetadata"]);i!=null&&u(t,["videoMetadata"],i);let r=l(e,["thought"]);r!=null&&u(t,["thought"],r);let s=l(e,["codeExecutionResult"]);s!=null&&u(t,["codeExecutionResult"],s);let o=l(e,["executableCode"]);o!=null&&u(t,["executableCode"],o);let a=l(e,["fileData"]);a!=null&&u(t,["fileData"],a);let d=l(e,["functionCall"]);d!=null&&u(t,["functionCall"],d);let c=l(e,["functionResponse"]);c!=null&&u(t,["functionResponse"],c);let f=l(e,["inlineData"]);f!=null&&u(t,["inlineData"],f);let p=l(e,["text"]);return p!=null&&u(t,["text"],p),t}function qt(n,e){let t={},i=l(e,["parts"]);i!=null&&(Array.isArray(i)?u(t,["parts"],i.map(s=>Xh(n,s))):u(t,["parts"],i));let r=l(e,["role"]);return r!=null&&u(t,["role"],r),t}function hu(n,e){let t={},i=l(e,["example"]);i!=null&&u(t,["example"],i);let r=l(e,["pattern"]);r!=null&&u(t,["pattern"],r);let s=l(e,["default"]);s!=null&&u(t,["default"],s);let o=l(e,["maxLength"]);o!=null&&u(t,["maxLength"],o);let a=l(e,["minLength"]);a!=null&&u(t,["minLength"],a);let d=l(e,["minProperties"]);d!=null&&u(t,["minProperties"],d);let c=l(e,["maxProperties"]);c!=null&&u(t,["maxProperties"],c);let f=l(e,["anyOf"]);f!=null&&u(t,["anyOf"],f);let p=l(e,["description"]);p!=null&&u(t,["description"],p);let h=l(e,["enum"]);h!=null&&u(t,["enum"],h);let g=l(e,["format"]);g!=null&&u(t,["format"],g);let v=l(e,["items"]);v!=null&&u(t,["items"],v);let w=l(e,["maxItems"]);w!=null&&u(t,["maxItems"],w);let S=l(e,["maximum"]);S!=null&&u(t,["maximum"],S);let x=l(e,["minItems"]);x!=null&&u(t,["minItems"],x);let I=l(e,["minimum"]);I!=null&&u(t,["minimum"],I);let L=l(e,["nullable"]);L!=null&&u(t,["nullable"],L);let C=l(e,["properties"]);C!=null&&u(t,["properties"],C);let P=l(e,["propertyOrdering"]);P!=null&&u(t,["propertyOrdering"],P);let O=l(e,["required"]);O!=null&&u(t,["required"],O);let T=l(e,["title"]);T!=null&&u(t,["title"],T);let N=l(e,["type"]);return N!=null&&u(t,["type"],N),t}function jh(n,e){let t={},i=l(e,["featureSelectionPreference"]);return i!=null&&u(t,["featureSelectionPreference"],i),t}function em(n,e){let t={},i=l(e,["method"]);i!=null&&u(t,["method"],i);let r=l(e,["category"]);r!=null&&u(t,["category"],r);let s=l(e,["threshold"]);return s!=null&&u(t,["threshold"],s),t}function tm(n,e){let t={},i=l(e,["response"]);i!=null&&u(t,["response"],hu(n,i));let r=l(e,["description"]);r!=null&&u(t,["description"],r);let s=l(e,["name"]);s!=null&&u(t,["name"],s);let o=l(e,["parameters"]);return o!=null&&u(t,["parameters"],o),t}function nm(){return{}}function im(n,e){let t={},i=l(e,["mode"]);i!=null&&u(t,["mode"],i);let r=l(e,["dynamicThreshold"]);return r!=null&&u(t,["dynamicThreshold"],r),t}function rm(n,e){let t={},i=l(e,["dynamicRetrievalConfig"]);return i!=null&&u(t,["dynamicRetrievalConfig"],im(n,i)),t}function mu(n,e){let t={},i=l(e,["functionDeclarations"]);i!=null&&(Array.isArray(i)?u(t,["functionDeclarations"],i.map(d=>tm(n,d))):u(t,["functionDeclarations"],i));let r=l(e,["retrieval"]);r!=null&&u(t,["retrieval"],r),l(e,["googleSearch"])!=null&&u(t,["googleSearch"],nm());let o=l(e,["googleSearchRetrieval"]);o!=null&&u(t,["googleSearchRetrieval"],rm(n,o));let a=l(e,["codeExecution"]);return a!=null&&u(t,["codeExecution"],a),t}function sm(n,e){let t={},i=l(e,["mode"]);i!=null&&u(t,["mode"],i);let r=l(e,["allowedFunctionNames"]);return r!=null&&u(t,["allowedFunctionNames"],r),t}function om(n,e){let t={},i=l(e,["functionCallingConfig"]);return i!=null&&u(t,["functionCallingConfig"],sm(n,i)),t}function am(n,e){let t={},i=l(e,["voiceName"]);return i!=null&&u(t,["voiceName"],i),t}function um(n,e){let t={},i=l(e,["prebuiltVoiceConfig"]);return i!=null&&u(t,["prebuiltVoiceConfig"],am(n,i)),t}function lm(n,e){let t={},i=l(e,["voiceConfig"]);i!=null&&u(t,["voiceConfig"],um(n,i));let r=l(e,["languageCode"]);return r!=null&&u(t,["languageCode"],r),t}function cm(n,e){let t={},i=l(e,["includeThoughts"]);i!=null&&u(t,["includeThoughts"],i);let r=l(e,["thinkingBudget"]);return r!=null&&u(t,["thinkingBudget"],r),t}function dm(n,e,t){let i={},r=l(e,["systemInstruction"]);t!==void 0&&r!=null&&u(t,["systemInstruction"],qt(n,Ee(n,r)));let s=l(e,["temperature"]);s!=null&&u(i,["temperature"],s);let o=l(e,["topP"]);o!=null&&u(i,["topP"],o);let a=l(e,["topK"]);a!=null&&u(i,["topK"],a);let d=l(e,["candidateCount"]);d!=null&&u(i,["candidateCount"],d);let c=l(e,["maxOutputTokens"]);c!=null&&u(i,["maxOutputTokens"],c);let f=l(e,["stopSequences"]);f!=null&&u(i,["stopSequences"],f);let p=l(e,["responseLogprobs"]);p!=null&&u(i,["responseLogprobs"],p);let h=l(e,["logprobs"]);h!=null&&u(i,["logprobs"],h);let g=l(e,["presencePenalty"]);g!=null&&u(i,["presencePenalty"],g);let v=l(e,["frequencyPenalty"]);v!=null&&u(i,["frequencyPenalty"],v);let w=l(e,["seed"]);w!=null&&u(i,["seed"],w);let S=l(e,["responseMimeType"]);S!=null&&u(i,["responseMimeType"],S);let x=l(e,["responseSchema"]);x!=null&&u(i,["responseSchema"],hu(n,cu(n,x)));let I=l(e,["routingConfig"]);I!=null&&u(i,["routingConfig"],I);let L=l(e,["modelSelectionConfig"]);L!=null&&u(i,["modelConfig"],jh(n,L));let C=l(e,["safetySettings"]);t!==void 0&&C!=null&&(Array.isArray(C)?u(t,["safetySettings"],C.map(ae=>em(n,ae))):u(t,["safetySettings"],C));let P=l(e,["tools"]);t!==void 0&&P!=null&&(Array.isArray(P)?u(t,["tools"],be(n,be(n,P).map(ae=>mu(n,Ti(n,ae))))):u(t,["tools"],be(n,P)));let O=l(e,["toolConfig"]);t!==void 0&&O!=null&&u(t,["toolConfig"],om(n,O));let T=l(e,["labels"]);t!==void 0&&T!=null&&u(t,["labels"],T);let N=l(e,["cachedContent"]);t!==void 0&&N!=null&&u(t,["cachedContent"],lt(n,N));let $=l(e,["responseModalities"]);$!=null&&u(i,["responseModalities"],$);let te=l(e,["mediaResolution"]);te!=null&&u(i,["mediaResolution"],te);let le=l(e,["speechConfig"]);le!=null&&u(i,["speechConfig"],lm(n,du(n,le)));let K=l(e,["audioTimestamp"]);K!=null&&u(i,["audioTimestamp"],K);let Fe=l(e,["thinkingConfig"]);return Fe!=null&&u(i,["thinkingConfig"],cm(n,Fe)),i}function ja(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["contents"]);r!=null&&(Array.isArray(r)?u(t,["contents"],Q(n,Q(n,r).map(o=>qt(n,o)))):u(t,["contents"],Q(n,r)));let s=l(e,["config"]);return s!=null&&u(t,["generationConfig"],dm(n,s,t)),t}function fm(n,e,t){let i={},r=l(e,["taskType"]);t!==void 0&&r!=null&&u(t,["instances[]","task_type"],r);let s=l(e,["title"]);t!==void 0&&s!=null&&u(t,["instances[]","title"],s);let o=l(e,["outputDimensionality"]);t!==void 0&&o!=null&&u(t,["parameters","outputDimensionality"],o);let a=l(e,["mimeType"]);t!==void 0&&a!=null&&u(t,["instances[]","mimeType"],a);let d=l(e,["autoTruncate"]);return t!==void 0&&d!=null&&u(t,["parameters","autoTruncate"],d),i}function pm(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["contents"]);r!=null&&u(t,["instances[]","content"],lu(n,r));let s=l(e,["config"]);return s!=null&&u(t,["config"],fm(n,s,t)),t}function hm(n,e,t){let i={},r=l(e,["outputGcsUri"]);t!==void 0&&r!=null&&u(t,["parameters","storageUri"],r);let s=l(e,["negativePrompt"]);t!==void 0&&s!=null&&u(t,["parameters","negativePrompt"],s);let o=l(e,["numberOfImages"]);t!==void 0&&o!=null&&u(t,["parameters","sampleCount"],o);let a=l(e,["aspectRatio"]);t!==void 0&&a!=null&&u(t,["parameters","aspectRatio"],a);let d=l(e,["guidanceScale"]);t!==void 0&&d!=null&&u(t,["parameters","guidanceScale"],d);let c=l(e,["seed"]);t!==void 0&&c!=null&&u(t,["parameters","seed"],c);let f=l(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&u(t,["parameters","safetySetting"],f);let p=l(e,["personGeneration"]);t!==void 0&&p!=null&&u(t,["parameters","personGeneration"],p);let h=l(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&u(t,["parameters","includeSafetyAttributes"],h);let g=l(e,["includeRaiReason"]);t!==void 0&&g!=null&&u(t,["parameters","includeRaiReason"],g);let v=l(e,["language"]);t!==void 0&&v!=null&&u(t,["parameters","language"],v);let w=l(e,["outputMimeType"]);t!==void 0&&w!=null&&u(t,["parameters","outputOptions","mimeType"],w);let S=l(e,["outputCompressionQuality"]);t!==void 0&&S!=null&&u(t,["parameters","outputOptions","compressionQuality"],S);let x=l(e,["addWatermark"]);t!==void 0&&x!=null&&u(t,["parameters","addWatermark"],x);let I=l(e,["enhancePrompt"]);return t!==void 0&&I!=null&&u(t,["parameters","enhancePrompt"],I),i}function mm(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["prompt"]);r!=null&&u(t,["instances[0]","prompt"],r);let s=l(e,["config"]);return s!=null&&u(t,["config"],hm(n,s,t)),t}function gm(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","name"],ue(n,i));let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function ym(n,e,t){let i={},r=l(e,["systemInstruction"]);t!==void 0&&r!=null&&u(t,["systemInstruction"],qt(n,Ee(n,r)));let s=l(e,["tools"]);t!==void 0&&s!=null&&(Array.isArray(s)?u(t,["tools"],s.map(a=>mu(n,a))):u(t,["tools"],s));let o=l(e,["generationConfig"]);return t!==void 0&&o!=null&&u(t,["generationConfig"],o),i}function Dm(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["contents"]);r!=null&&(Array.isArray(r)?u(t,["contents"],Q(n,Q(n,r).map(o=>qt(n,o)))):u(t,["contents"],Q(n,r)));let s=l(e,["config"]);return s!=null&&u(t,["config"],ym(n,s,t)),t}function vm(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["contents"]);r!=null&&(Array.isArray(r)?u(t,["contents"],Q(n,Q(n,r).map(o=>qt(n,o)))):u(t,["contents"],Q(n,r)));let s=l(e,["config"]);return s!=null&&u(t,["config"],s),t}function Cm(n,e){let t={},i=l(e,["gcsUri"]);i!=null&&u(t,["gcsUri"],i);let r=l(e,["imageBytes"]);r!=null&&u(t,["bytesBase64Encoded"],ct(n,r));let s=l(e,["mimeType"]);return s!=null&&u(t,["mimeType"],s),t}function Em(n,e,t){let i={},r=l(e,["numberOfVideos"]);t!==void 0&&r!=null&&u(t,["parameters","sampleCount"],r);let s=l(e,["outputGcsUri"]);t!==void 0&&s!=null&&u(t,["parameters","storageUri"],s);let o=l(e,["fps"]);t!==void 0&&o!=null&&u(t,["parameters","fps"],o);let a=l(e,["durationSeconds"]);t!==void 0&&a!=null&&u(t,["parameters","durationSeconds"],a);let d=l(e,["seed"]);t!==void 0&&d!=null&&u(t,["parameters","seed"],d);let c=l(e,["aspectRatio"]);t!==void 0&&c!=null&&u(t,["parameters","aspectRatio"],c);let f=l(e,["resolution"]);t!==void 0&&f!=null&&u(t,["parameters","resolution"],f);let p=l(e,["personGeneration"]);t!==void 0&&p!=null&&u(t,["parameters","personGeneration"],p);let h=l(e,["pubsubTopic"]);t!==void 0&&h!=null&&u(t,["parameters","pubsubTopic"],h);let g=l(e,["negativePrompt"]);t!==void 0&&g!=null&&u(t,["parameters","negativePrompt"],g);let v=l(e,["enhancePrompt"]);return t!==void 0&&v!=null&&u(t,["parameters","enhancePrompt"],v),i}function wm(n,e){let t={},i=l(e,["model"]);i!=null&&u(t,["_url","model"],ue(n,i));let r=l(e,["prompt"]);r!=null&&u(t,["instances[0]","prompt"],r);let s=l(e,["image"]);s!=null&&u(t,["instances[0]","image"],Cm(n,s));let o=l(e,["config"]);return o!=null&&u(t,["config"],Em(n,o,t)),t}function Fm(n,e){let t={},i=l(e,["thought"]);i!=null&&u(t,["thought"],i);let r=l(e,["codeExecutionResult"]);r!=null&&u(t,["codeExecutionResult"],r);let s=l(e,["executableCode"]);s!=null&&u(t,["executableCode"],s);let o=l(e,["fileData"]);o!=null&&u(t,["fileData"],o);let a=l(e,["functionCall"]);a!=null&&u(t,["functionCall"],a);let d=l(e,["functionResponse"]);d!=null&&u(t,["functionResponse"],d);let c=l(e,["inlineData"]);c!=null&&u(t,["inlineData"],c);let f=l(e,["text"]);return f!=null&&u(t,["text"],f),t}function Sm(n,e){let t={},i=l(e,["parts"]);i!=null&&(Array.isArray(i)?u(t,["parts"],i.map(s=>Fm(n,s))):u(t,["parts"],i));let r=l(e,["role"]);return r!=null&&u(t,["role"],r),t}function Tm(n,e){let t={},i=l(e,["citationSources"]);return i!=null&&u(t,["citations"],i),t}function Mm(n,e){let t={},i=l(e,["content"]);i!=null&&u(t,["content"],Sm(n,i));let r=l(e,["citationMetadata"]);r!=null&&u(t,["citationMetadata"],Tm(n,r));let s=l(e,["tokenCount"]);s!=null&&u(t,["tokenCount"],s);let o=l(e,["finishReason"]);o!=null&&u(t,["finishReason"],o);let a=l(e,["avgLogprobs"]);a!=null&&u(t,["avgLogprobs"],a);let d=l(e,["groundingMetadata"]);d!=null&&u(t,["groundingMetadata"],d);let c=l(e,["index"]);c!=null&&u(t,["index"],c);let f=l(e,["logprobsResult"]);f!=null&&u(t,["logprobsResult"],f);let p=l(e,["safetyRatings"]);return p!=null&&u(t,["safetyRatings"],p),t}function eu(n,e){let t={},i=l(e,["candidates"]);i!=null&&(Array.isArray(i)?u(t,["candidates"],i.map(a=>Mm(n,a))):u(t,["candidates"],i));let r=l(e,["modelVersion"]);r!=null&&u(t,["modelVersion"],r);let s=l(e,["promptFeedback"]);s!=null&&u(t,["promptFeedback"],s);let o=l(e,["usageMetadata"]);return o!=null&&u(t,["usageMetadata"],o),t}function _m(n,e){let t={},i=l(e,["values"]);return i!=null&&u(t,["values"],i),t}function xm(){return{}}function Pm(n,e){let t={},i=l(e,["embeddings"]);return i!=null&&(Array.isArray(i)?u(t,["embeddings"],i.map(s=>_m(n,s))):u(t,["embeddings"],i)),l(e,["metadata"])!=null&&u(t,["metadata"],xm()),t}function km(n,e){let t={},i=l(e,["bytesBase64Encoded"]);i!=null&&u(t,["imageBytes"],ct(n,i));let r=l(e,["mimeType"]);return r!=null&&u(t,["mimeType"],r),t}function gu(n,e){let t={},i=l(e,["safetyAttributes","categories"]);i!=null&&u(t,["categories"],i);let r=l(e,["safetyAttributes","scores"]);r!=null&&u(t,["scores"],r);let s=l(e,["contentType"]);return s!=null&&u(t,["contentType"],s),t}function bm(n,e){let t={},i=l(e,["_self"]);i!=null&&u(t,["image"],km(n,i));let r=l(e,["raiFilteredReason"]);r!=null&&u(t,["raiFilteredReason"],r);let s=l(e,["_self"]);return s!=null&&u(t,["safetyAttributes"],gu(n,s)),t}function Im(n,e){let t={},i=l(e,["predictions"]);i!=null&&(Array.isArray(i)?u(t,["generatedImages"],i.map(s=>bm(n,s))):u(t,["generatedImages"],i));let r=l(e,["positivePromptSafetyAttributes"]);return r!=null&&u(t,["positivePromptSafetyAttributes"],gu(n,r)),t}function Am(n,e){let t={},i=l(e,["baseModel"]);i!=null&&u(t,["baseModel"],i);let r=l(e,["createTime"]);r!=null&&u(t,["createTime"],r);let s=l(e,["updateTime"]);return s!=null&&u(t,["updateTime"],s),t}function Nm(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["name"],i);let r=l(e,["displayName"]);r!=null&&u(t,["displayName"],r);let s=l(e,["description"]);s!=null&&u(t,["description"],s);let o=l(e,["version"]);o!=null&&u(t,["version"],o);let a=l(e,["_self"]);a!=null&&u(t,["tunedModelInfo"],Am(n,a));let d=l(e,["inputTokenLimit"]);d!=null&&u(t,["inputTokenLimit"],d);let c=l(e,["outputTokenLimit"]);c!=null&&u(t,["outputTokenLimit"],c);let f=l(e,["supportedGenerationMethods"]);return f!=null&&u(t,["supportedActions"],f),t}function Rm(n,e){let t={},i=l(e,["totalTokens"]);i!=null&&u(t,["totalTokens"],i);let r=l(e,["cachedContentTokenCount"]);return r!=null&&u(t,["cachedContentTokenCount"],r),t}function Lm(n,e){let t={},i=l(e,["video","uri"]);i!=null&&u(t,["uri"],i);let r=l(e,["video","encodedVideo"]);r!=null&&u(t,["videoBytes"],ct(n,r));let s=l(e,["encoding"]);return s!=null&&u(t,["mimeType"],s),t}function Om(n,e){let t={},i=l(e,["_self"]);return i!=null&&u(t,["video"],Lm(n,i)),t}function Bm(n,e){let t={},i=l(e,["generatedSamples"]);i!=null&&(Array.isArray(i)?u(t,["generatedVideos"],i.map(o=>Om(n,o))):u(t,["generatedVideos"],i));let r=l(e,["raiMediaFilteredCount"]);r!=null&&u(t,["raiMediaFilteredCount"],r);let s=l(e,["raiMediaFilteredReasons"]);return s!=null&&u(t,["raiMediaFilteredReasons"],s),t}function Vm(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["name"],i);let r=l(e,["metadata"]);r!=null&&u(t,["metadata"],r);let s=l(e,["done"]);s!=null&&u(t,["done"],s);let o=l(e,["error"]);o!=null&&u(t,["error"],o);let a=l(e,["response","generateVideoResponse"]);return a!=null&&u(t,["response"],Bm(n,a)),t}function Gm(n,e){let t={},i=l(e,["videoMetadata"]);i!=null&&u(t,["videoMetadata"],i);let r=l(e,["thought"]);r!=null&&u(t,["thought"],r);let s=l(e,["codeExecutionResult"]);s!=null&&u(t,["codeExecutionResult"],s);let o=l(e,["executableCode"]);o!=null&&u(t,["executableCode"],o);let a=l(e,["fileData"]);a!=null&&u(t,["fileData"],a);let d=l(e,["functionCall"]);d!=null&&u(t,["functionCall"],d);let c=l(e,["functionResponse"]);c!=null&&u(t,["functionResponse"],c);let f=l(e,["inlineData"]);f!=null&&u(t,["inlineData"],f);let p=l(e,["text"]);return p!=null&&u(t,["text"],p),t}function Um(n,e){let t={},i=l(e,["parts"]);i!=null&&(Array.isArray(i)?u(t,["parts"],i.map(s=>Gm(n,s))):u(t,["parts"],i));let r=l(e,["role"]);return r!=null&&u(t,["role"],r),t}function Hm(n,e){let t={},i=l(e,["citations"]);return i!=null&&u(t,["citations"],i),t}function qm(n,e){let t={},i=l(e,["content"]);i!=null&&u(t,["content"],Um(n,i));let r=l(e,["citationMetadata"]);r!=null&&u(t,["citationMetadata"],Hm(n,r));let s=l(e,["finishMessage"]);s!=null&&u(t,["finishMessage"],s);let o=l(e,["finishReason"]);o!=null&&u(t,["finishReason"],o);let a=l(e,["avgLogprobs"]);a!=null&&u(t,["avgLogprobs"],a);let d=l(e,["groundingMetadata"]);d!=null&&u(t,["groundingMetadata"],d);let c=l(e,["index"]);c!=null&&u(t,["index"],c);let f=l(e,["logprobsResult"]);f!=null&&u(t,["logprobsResult"],f);let p=l(e,["safetyRatings"]);return p!=null&&u(t,["safetyRatings"],p),t}function tu(n,e){let t={},i=l(e,["candidates"]);i!=null&&(Array.isArray(i)?u(t,["candidates"],i.map(c=>qm(n,c))):u(t,["candidates"],i));let r=l(e,["createTime"]);r!=null&&u(t,["createTime"],r);let s=l(e,["responseId"]);s!=null&&u(t,["responseId"],s);let o=l(e,["modelVersion"]);o!=null&&u(t,["modelVersion"],o);let a=l(e,["promptFeedback"]);a!=null&&u(t,["promptFeedback"],a);let d=l(e,["usageMetadata"]);return d!=null&&u(t,["usageMetadata"],d),t}function Wm(n,e){let t={},i=l(e,["truncated"]);i!=null&&u(t,["truncated"],i);let r=l(e,["token_count"]);return r!=null&&u(t,["tokenCount"],r),t}function $m(n,e){let t={},i=l(e,["values"]);i!=null&&u(t,["values"],i);let r=l(e,["statistics"]);return r!=null&&u(t,["statistics"],Wm(n,r)),t}function zm(n,e){let t={},i=l(e,["billableCharacterCount"]);return i!=null&&u(t,["billableCharacterCount"],i),t}function Ym(n,e){let t={},i=l(e,["predictions[]","embeddings"]);i!=null&&(Array.isArray(i)?u(t,["embeddings"],i.map(s=>$m(n,s))):u(t,["embeddings"],i));let r=l(e,["metadata"]);return r!=null&&u(t,["metadata"],zm(n,r)),t}function Km(n,e){let t={},i=l(e,["gcsUri"]);i!=null&&u(t,["gcsUri"],i);let r=l(e,["bytesBase64Encoded"]);r!=null&&u(t,["imageBytes"],ct(n,r));let s=l(e,["mimeType"]);return s!=null&&u(t,["mimeType"],s),t}function yu(n,e){let t={},i=l(e,["safetyAttributes","categories"]);i!=null&&u(t,["categories"],i);let r=l(e,["safetyAttributes","scores"]);r!=null&&u(t,["scores"],r);let s=l(e,["contentType"]);return s!=null&&u(t,["contentType"],s),t}function Jm(n,e){let t={},i=l(e,["_self"]);i!=null&&u(t,["image"],Km(n,i));let r=l(e,["raiFilteredReason"]);r!=null&&u(t,["raiFilteredReason"],r);let s=l(e,["_self"]);s!=null&&u(t,["safetyAttributes"],yu(n,s));let o=l(e,["prompt"]);return o!=null&&u(t,["enhancedPrompt"],o),t}function Zm(n,e){let t={},i=l(e,["predictions"]);i!=null&&(Array.isArray(i)?u(t,["generatedImages"],i.map(s=>Jm(n,s))):u(t,["generatedImages"],i));let r=l(e,["positivePromptSafetyAttributes"]);return r!=null&&u(t,["positivePromptSafetyAttributes"],yu(n,r)),t}function Qm(n,e){let t={},i=l(e,["endpoint"]);i!=null&&u(t,["name"],i);let r=l(e,["deployedModelId"]);return r!=null&&u(t,["deployedModelId"],r),t}function Xm(n,e){let t={},i=l(e,["labels","google-vertex-llm-tuning-base-model-id"]);i!=null&&u(t,["baseModel"],i);let r=l(e,["createTime"]);r!=null&&u(t,["createTime"],r);let s=l(e,["updateTime"]);return s!=null&&u(t,["updateTime"],s),t}function jm(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["name"],i);let r=l(e,["displayName"]);r!=null&&u(t,["displayName"],r);let s=l(e,["description"]);s!=null&&u(t,["description"],s);let o=l(e,["versionId"]);o!=null&&u(t,["version"],o);let a=l(e,["deployedModels"]);a!=null&&(Array.isArray(a)?u(t,["endpoints"],a.map(f=>Qm(n,f))):u(t,["endpoints"],a));let d=l(e,["labels"]);d!=null&&u(t,["labels"],d);let c=l(e,["_self"]);return c!=null&&u(t,["tunedModelInfo"],Xm(n,c)),t}function eg(n,e){let t={},i=l(e,["totalTokens"]);return i!=null&&u(t,["totalTokens"],i),t}function tg(n,e){let t={},i=l(e,["tokensInfo"]);return i!=null&&u(t,["tokensInfo"],i),t}function ng(n,e){let t={},i=l(e,["gcsUri"]);i!=null&&u(t,["uri"],i);let r=l(e,["bytesBase64Encoded"]);r!=null&&u(t,["videoBytes"],ct(n,r));let s=l(e,["mimeType"]);return s!=null&&u(t,["mimeType"],s),t}function ig(n,e){let t={},i=l(e,["_self"]);return i!=null&&u(t,["video"],ng(n,i)),t}function rg(n,e){let t={},i=l(e,["videos"]);i!=null&&(Array.isArray(i)?u(t,["generatedVideos"],i.map(o=>ig(n,o))):u(t,["generatedVideos"],i));let r=l(e,["raiMediaFilteredCount"]);r!=null&&u(t,["raiMediaFilteredCount"],r);let s=l(e,["raiMediaFilteredReasons"]);return s!=null&&u(t,["raiMediaFilteredReasons"],s),t}function sg(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["name"],i);let r=l(e,["metadata"]);r!=null&&u(t,["metadata"],r);let s=l(e,["done"]);s!=null&&u(t,["done"],s);let o=l(e,["error"]);o!=null&&u(t,["error"],o);let a=l(e,["response"]);return a!=null&&u(t,["response"],rg(n,a)),t}var og="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function ag(n,e,t){let i,r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),n.isVertexAI()?i=Mh(n,r):i=Th(n,r),e(i)}var as=class{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i,r,s;let o=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),d,c=cg(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())d=`${o}/ws/google.cloud.aiplatform.${a}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(c);else{let C=this.apiClient.getApiKey();d=`${o}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateContent?key=${C}`}let f=()=>{},p=new Promise(C=>{f=C}),h=e.callbacks,g=function(){var C;(C=h==null?void 0:h.onopen)===null||C===void 0||C.call(h),f({})},v=this.apiClient,w={onopen:g,onmessage:C=>{ag(v,h.onmessage,C)},onerror:(t=h==null?void 0:h.onerror)!==null&&t!==void 0?t:function(C){},onclose:(i=h==null?void 0:h.onclose)!==null&&i!==void 0?i:function(C){}},S=this.webSocketFactory.create(d,lg(c),w);S.connect(),await p;let x=ue(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&x.startsWith("publishers/")){let C=this.apiClient.getProject(),P=this.apiClient.getLocation();x=`projects/${C}/locations/${P}/`+x}let I={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[gi.AUDIO]}:e.config.responseModalities=[gi.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let L={model:x,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?I=Xp(this.apiClient,L):I=Qp(this.apiClient,L),delete I.config,S.send(JSON.stringify(I)),new us(S,this.apiClient)}},ug={turnComplete:!0},us=class{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Q(e,t.turns),e.isVertexAI()?i=i.map(r=>qt(e,r)):i=i.map(r=>Mi(e,r))}catch(r){throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(let s of i){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(og)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},ug),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:rh(this.apiClient,e)}:t={realtimeInput:ih(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}};function lg(n){let e={};return n.forEach((t,i)=>{e[i]=t}),e}function cg(n){let e=new Headers;for(let[t,i]of Object.entries(n))e.append(t,i);return e}var ls=class extends Ht{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let s,o=[];if(i!=null&&i.generatedImages)for(let d of i.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((r=d==null?void 0:d.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?s=d==null?void 0:d.safetyAttributes:o.push(d);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s}:a={generatedImages:o},a})}async generateContentInternal(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=ja(this.apiClient,e);return a=W("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{let p=tu(this.apiClient,f),h=new Ut;return Object.assign(h,p),h})}else{let c=Xa(this.apiClient,e);return a=W("{model}:generateContent",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{let p=eu(this.apiClient,f),h=new Ut;return Object.assign(h,p),h})}}async generateContentStreamInternal(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=ja(this.apiClient,e);a=W("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query;let f=this.apiClient;return o=f.requestStream({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(p){return wi(this,arguments,function*(){var h,g,v,w;try{for(var S=!0,x=ns(p),I;I=yield pe(x.next()),h=I.done,!h;S=!0){w=I.value,S=!1;let C=tu(f,yield pe(w.json())),P=new Ut;Object.assign(P,C),yield yield pe(P)}}catch(L){g={error:L}}finally{try{!S&&!h&&(v=x.return)&&(yield pe(v.call(x)))}finally{if(g)throw g.error}}})})}else{let c=Xa(this.apiClient,e);a=W("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c.config,delete c._url,delete c._query;let f=this.apiClient;return o=f.requestStream({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(p){return wi(this,arguments,function*(){var h,g,v,w;try{for(var S=!0,x=ns(p),I;I=yield pe(x.next()),h=I.done,!h;S=!0){w=I.value,S=!1;let C=eu(f,yield pe(w.json())),P=new Ut;Object.assign(P,C),yield yield pe(P)}}catch(L){g={error:L}}finally{try{!S&&!h&&(v=x.return)&&(yield pe(v.call(x)))}finally{if(g)throw g.error}}})})}}async embedContent(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=pm(this.apiClient,e);return a=W("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{let p=Ym(this.apiClient,f),h=new yi;return Object.assign(h,p),h})}else{let c=qh(this.apiClient,e);return a=W("{model}:batchEmbedContents",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{let p=Pm(this.apiClient,f),h=new yi;return Object.assign(h,p),h})}}async generateImagesInternal(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=mm(this.apiClient,e);return a=W("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{let p=Zm(this.apiClient,f),h=new Di;return Object.assign(h,p),h})}else{let c=$h(this.apiClient,e);return a=W("{model}:predict",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{let p=Im(this.apiClient,f),h=new Di;return Object.assign(h,p),h})}}async get(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=gm(this.apiClient,e);return a=W("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>jm(this.apiClient,f))}else{let c=zh(this.apiClient,e);return a=W("{name}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Nm(this.apiClient,f))}}async countTokens(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=Dm(this.apiClient,e);return a=W("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{let p=eg(this.apiClient,f),h=new vi;return Object.assign(h,p),h})}else{let c=Kh(this.apiClient,e);return a=W("{model}:countTokens",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{let p=Rm(this.apiClient,f),h=new vi;return Object.assign(h,p),h})}}async computeTokens(e){var t,i;let r,s="",o={};if(this.apiClient.isVertexAI()){let a=vm(this.apiClient,e);return s=W("{model}:computeTokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{let c=tg(this.apiClient,d),f=new Qr;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=wm(this.apiClient,e);return a=W("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>sg(this.apiClient,f))}else{let c=Qh(this.apiClient,e);return a=W("{model}:predictLongRunning",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>Vm(this.apiClient,f))}}};function dg(n,e){let t={},i=l(e,["operationName"]);i!=null&&u(t,["_url","operationName"],i);let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function fg(n,e){let t={},i=l(e,["operationName"]);i!=null&&u(t,["_url","operationName"],i);let r=l(e,["config"]);return r!=null&&u(t,["config"],r),t}function pg(n,e){let t={},i=l(e,["operationName"]);i!=null&&u(t,["operationName"],i);let r=l(e,["resourceName"]);r!=null&&u(t,["_url","resourceName"],r);let s=l(e,["config"]);return s!=null&&u(t,["config"],s),t}function hg(n,e){let t={},i=l(e,["video","uri"]);i!=null&&u(t,["uri"],i);let r=l(e,["video","encodedVideo"]);r!=null&&u(t,["videoBytes"],ct(n,r));let s=l(e,["encoding"]);return s!=null&&u(t,["mimeType"],s),t}function mg(n,e){let t={},i=l(e,["_self"]);return i!=null&&u(t,["video"],hg(n,i)),t}function gg(n,e){let t={},i=l(e,["generatedSamples"]);i!=null&&(Array.isArray(i)?u(t,["generatedVideos"],i.map(o=>mg(n,o))):u(t,["generatedVideos"],i));let r=l(e,["raiMediaFilteredCount"]);r!=null&&u(t,["raiMediaFilteredCount"],r);let s=l(e,["raiMediaFilteredReasons"]);return s!=null&&u(t,["raiMediaFilteredReasons"],s),t}function yg(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["name"],i);let r=l(e,["metadata"]);r!=null&&u(t,["metadata"],r);let s=l(e,["done"]);s!=null&&u(t,["done"],s);let o=l(e,["error"]);o!=null&&u(t,["error"],o);let a=l(e,["response","generateVideoResponse"]);return a!=null&&u(t,["response"],gg(n,a)),t}function Dg(n,e){let t={},i=l(e,["gcsUri"]);i!=null&&u(t,["uri"],i);let r=l(e,["bytesBase64Encoded"]);r!=null&&u(t,["videoBytes"],ct(n,r));let s=l(e,["mimeType"]);return s!=null&&u(t,["mimeType"],s),t}function vg(n,e){let t={},i=l(e,["_self"]);return i!=null&&u(t,["video"],Dg(n,i)),t}function Cg(n,e){let t={},i=l(e,["videos"]);i!=null&&(Array.isArray(i)?u(t,["generatedVideos"],i.map(o=>vg(n,o))):u(t,["generatedVideos"],i));let r=l(e,["raiMediaFilteredCount"]);r!=null&&u(t,["raiMediaFilteredCount"],r);let s=l(e,["raiMediaFilteredReasons"]);return s!=null&&u(t,["raiMediaFilteredReasons"],s),t}function nu(n,e){let t={},i=l(e,["name"]);i!=null&&u(t,["name"],i);let r=l(e,["metadata"]);r!=null&&u(t,["metadata"],r);let s=l(e,["done"]);s!=null&&u(t,["done"],s);let o=l(e,["error"]);o!=null&&u(t,["error"],o);let a=l(e,["response"]);return a!=null&&u(t,["response"],Cg(n,a)),t}var cs=class extends Ht{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){let r=t.name.split("/operations/")[0],s;return i&&"httpOptions"in i&&(s=i.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:s}})}else return this.getVideosOperationInternal({operationName:t.name,config:i})}async getVideosOperationInternal(e){var t,i,r,s;let o,a="",d={};if(this.apiClient.isVertexAI()){let c=fg(this.apiClient,e);return a=W("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>nu(this.apiClient,f))}else{let c=dg(this.apiClient,e);return a=W("{operationName}",c._url),d=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>yg(this.apiClient,f))}}async fetchPredictVideosOperationInternal(e){var t,i;let r,s="",o={};if(this.apiClient.isVertexAI()){let a=pg(this.apiClient,e);return s=W("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>nu(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}};var Eg="Content-Type",wg="X-Server-Timeout",Fg="User-Agent",Sg="x-goog-api-client",Tg="0.10.0",Mg=`google-genai-sdk/${Tg}`,_g="v1beta1",xg="v1beta",iu=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/,Fi=class extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}},Fn=class extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}},ds=class{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});let r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:_g,this.getProject()||this.getLocation()?(r.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`,this.clientOptions.apiKey=void 0):(r.baseUrl="https://aiplatform.googleapis.com/",this.clientOptions.project=void 0,this.clientOptions.location=void 0)):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:xg,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");let i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){let r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(let[o,a]of Object.entries(e.queryParams))r.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,e.abortSignal),this.unaryApiCall(r,s,e.httpMethod)}patchHttpOptions(e,t){let i=JSON.parse(JSON.stringify(e));for(let[r,s]of Object.entries(t))typeof s=="object"?i[r]=Object.assign(Object.assign({},i[r]),s):s!==void 0&&(i[r]=s);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,e.abortSignal),this.streamApiCall(r,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i){if(t&&t.timeout||i){let r=new AbortController,s=r.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>r.abort(),t.timeout),i&&i.addEventListener("abort",()=>{r.abort()}),e.signal=s}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await ru(r),new wn(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await ru(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return wi(this,arguments,function*(){let r=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),s=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let o="";for(;;){let{done:a,value:d}=yield pe(r.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}let c=s.decode(d);try{let p=JSON.parse(c);if("error"in p){let h=JSON.parse(JSON.stringify(p.error)),g=h.status,v=h.code,w=`got status: ${g}. ${JSON.stringify(p)}`;if(v>=400&&v<500)throw new Fi(w);if(v>=500&&v<600)throw new Fn(w)}}catch(p){let h=p;if(h.name==="ClientError"||h.name==="ServerError")throw p}o+=c;let f=o.match(iu);for(;f;){let p=f[1];try{let h=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield pe(new wn(h)),o=o.slice(f[0].length),f=o.match(iu)}catch(h){throw new Error(`exception parsing stream chunk ${p}. ${h}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){let e={},t=Mg+" "+this.clientOptions.userAgentExtra;return e[Fg]=t,e[Sg]=t,e[Eg]="application/json",e}async getHeadersInternal(e){let t=new Headers;if(e&&e.headers){for(let[i,r]of Object.entries(e.headers))t.append(i,r);e.timeout&&e.timeout>0&&t.append(wg,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var i;let r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);let s=this.clientOptions.uploader,o=await s.stat(e);r.sizeBytes=String(o.size);let a=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=a;let d=await this.fetchUploadUrl(r,t);return s.upload(e,d,this)}async fetchUploadUrl(e,t){var i;let r={};t!=null&&t.httpOptions?r=t.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};let s={file:e},o=await this.request({path:W("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:r});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let a=(i=o==null?void 0:o.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}};async function ru(n){var e;if(n===void 0)throw new Fn("response is undefined");if(!n.ok){let t=n.status,i=n.statusText,r;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await n.json():r={error:{message:await n.text(),code:n.status,status:n.statusText}};let s=`got status: ${t} ${i}. ${JSON.stringify(r)}`;throw t>=400&&t<500?new Fi(s):t>=500&&t<600?new Fn(s):new Error(s)}}var Pg=1024*1024*8;async function kg(n,e,t){var i,r;let s=0,o=0,a=new wn(new Response),d="upload";for(s=n.size;o<s;){let f=Math.min(Pg,s-o),p=n.slice(o,o+f);if(o+f>=s&&(d+=", finalize"),a=await t.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(o),"Content-Length":String(f)}}}),o+=f,((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i["x-goog-upload-status"])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}let c=await(a==null?void 0:a.json());if(((r=a==null?void 0:a.headers)===null||r===void 0?void 0:r["x-goog-upload-status"])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return c.file}async function bg(n){return{size:n.size,type:n.type}}var fs=class{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await kg(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await bg(e)}};var ps=class{create(e,t,i){return new hs(e,t,i)}},hs=class{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}};var su="x-goog-api-key",ms=class{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(su)===null&&e.append(su,this.apiKey)}};var Ig="gl-node/",Si=class{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;let i=wf(e,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;let r=new ms(this.apiKey);this.apiClient=new ds({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Ig+"web",uploader:new fs}),this.models=new ls(this.apiClient),this.live=new as(this.apiClient,r,new ps),this.chats=new is(this.models,this.apiClient),this.caches=new ts(this.apiClient),this.files=new os(this.apiClient),this.operations=new cs(this.apiClient)}};function _i(n,e=!0){if(!n||typeof n!="object")return n;if("path"in n&&"content"in n&&"wikilink"in n&&"links"in n){let t={...n,content:e?n.content:`[Linked file: ${n.wikilink||n.path}]`,links:{}},i=n.links instanceof Map?Object.fromEntries(n.links):n.links;for(let r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t.links[r]=_i(i[r],!1));return t}if(Array.isArray(n))return n.map(t=>_i(t,e));{let t={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=_i(n[i],e));return t}}function gs(n){if(n&&typeof n=="object"&&"path"in n&&"content"in n&&"wikilink"in n&&"links"in n)return _i(n,!0);if(Array.isArray(n))return n.map(gs);if(n&&typeof n=="object"){let e={};for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=gs(n[t]));return e}return n}function Ag(n){let e=/(=+\nFile Label: [^\n]+\nFile Name: [^\n]+\nWikiLink: [^\n]+\n=+\n\n)/g,t=n.split(e);if(t.length<=2)return n;let i="",r=0;for(let s=0;s<t.length;s++)if(s%2===0)i+=t[s];else if(i+=t[s],r++,r===1){let o=t[s+2]!==void 0?s+2:t.length;i+=t[s+1]||"",s++}else{let o=t[s].match(/WikiLink: \[\[(.*?)\]\]/),a=o?o[1]:"Unknown";i+=`[Linked file: [[${a}]]]

`,s++}return i}function Du(n){return!!(n&&typeof n=="object"&&typeof n.prompt=="string")}function Ng(n){return Du(n)&&Array.isArray(n.conversationHistory)&&typeof n.userMessage=="string"}function Rg(n){var e;return[`Model: ${(e=n.model)!=null?e:"[default]"}
`,`Prompt: ${JSON.stringify(n.prompt,null,2)}
`].join("")}function Lg(n){var e;return[`Model: ${(e=n.model)!=null?e:"[default]"}
`,`Prompt: ${JSON.stringify(n.prompt,null,2)}
`,`User Message: ${JSON.stringify(n.userMessage,null,2)}
`,"Conversation History:",JSON.stringify(n.conversationHistory,null,2),n.renderContent!==void 0?`
Render Content: ${n.renderContent}`:""].join(`
`)}function de(n,e,t){if(!n)return;if(Ng(t)){console.log(`[GeminiAPI Debug] ${e} (ExtendedModelRequest):
${Lg(t)}`);return}if(Du(t)){console.log(`[GeminiAPI Debug] ${e} (BaseModelRequest):
${Rg(t)}`);return}let i;typeof t=="string"&&t.includes("File Label:")?(i=Ag(t),console.log(`[GeminiAPI Debug] ${e}:
${i}`)):(i=gs(t),console.log(`[GeminiAPI Debug] ${e}:`,JSON.stringify(i,null,2)))}var _t=Yr(lo());var rc=`You are a note-taking and writing assistant embedded in my Obsidian note vault.
Your primary goal is to help me stay organized by surfacing information from my 
notes and any linked notes, and to assist me in drafting and refining my 
writing based on this context. 

Today's date is: {{date}}
The current time is: {{time}}

Assume that I am the author of all content unless specified otherwise, and you
can refer to me as {{userName}}.

Unless otherwise specified please respond to me in the same language I use with 
you. My user interface is set to the language code: {{language}}. Use that
language if you are uncertain about the language to use.


You should always respond with plain text. **Do not use HTML-escaped entities**  
like \`&quot;\`, \`&#x27;\`, or \`&amp;\`. Instead, always render characters as their unescaped  
equivalents (e.g., \`"\` for quotes, \`'\` for apostrophes, \`&\` for ampersands).  
Use Markdown formatting if necessary for clarity and style.

If a question cannot be answered from my notes, supplement your response with
external information as needed.`;var sc=`You are a markdown text completion assistant designed to help users write more effectively by generating contextually relevant, high-quality prose.

Your task is to produce the next **complete sentence or multi-word phrase** that fits naturally after the cursor position. Prioritize longer, flowing completions that build upon the surrounding context with clarity and originality.

Your completions should match the tone, voice, and purpose of the user's existing content. Avoid repeating exact phrases, but feel free to expand on or complement existing ideas. Emphasize vivid language, subtle details, and fresh perspectives when appropriate.

Do **not** respond with just a single word unless absolutely necessary. Always attempt a full sentence first, then a phrase, only falling back to a word as a last resort.

Use the entire file to understand context, but generate a continuation only at the cursor.

Do not include explanations, punctuation at the start, extra whitespace, or newlines in your output. Just output the completion text.

Here is the file content and the location of the cursor:
<file>
{{contentBeforeCursor}}<cursor>{{contentAfterCursor}}
</file>
`;var oc=`You are assisting me in exploring, clarifying, and discussing the content
within a file labeled \u2018Current File\u2019 and any linked files. Prioritize
information from these files when answering questions, providing explanations,
or engaging in brainstorming.

If additional context beyond the current and linked files is needed to answer a 
question, clearly indicate when you are drawing on general knowledge or external
information.

When referring to files, use [[WikiLink]] syntax. If it's provided in the context
use the Wikilink that is provided, otherwise use the file path but drop the .md 
extension.
`;var ac=`Using the context provided, create a single-sentence summary based on the
content of the file. Exclude any mention of dates, attendees, or my name, and
assume the notes are taken from my perspective unless specified otherwise. 

Respond with plain text only, do not use any markdown.

Please summarize the following content:
<file><content>{{content}}</content></file>`;var uc=`You are assisting me in drafting the document labeled \u2018Current File\u2019 using the
context of this chat and the contents of any files linked from the Current File,
which are labeled as linked files. Use this content to help draft the document.

Respond with plain text, using markdown only for formatting where needed.

Your response will replace the entire content below the Markdown \u2018Draft\u2019 heading,
preserving everything above it. It's very important that you preserve the text 
above the 'Draft' heading. If no \u2018Draft\u2019 heading exists, create one as '# Draft' 
and start your content below it.

Exclude any content that should not appear in the final draft, ensuring only
relevant information is incorporated.

{{userMessage}}`;var lc=`==============================
File Label: {{file_label}}
File Name: {{file_name}}
WikiLink: {{wikilink}}
==============================

{{file_contents}}

`;var me=class{constructor(e){this.plugin=e;this.completionsPromptTemplate=_t.compile(sc),this.systemPromptTemplate=_t.compile(rc),this.generalPromptTemplate=_t.compile(oc),this.summaryPromptTemplate=_t.compile(ac),this.rewritePromptTemplate=_t.compile(uc),this.contextPromptTemplate=_t.compile(lc)}completionsPrompt(e){return this.completionsPromptTemplate(e)}systemPrompt(e){return this.systemPromptTemplate(e)}generalPrompt(e){return this.generalPromptTemplate(e)}summaryPrompt(e){return this.summaryPromptTemplate(e)}rewritePrompt(e){return this.rewritePromptTemplate(e)}contextPrompt(e){return this.contextPromptTemplate(e)}getLanguageCode(){return window.localStorage.getItem("language")||"en"}async getSystemPromptWithCustom(e){var i;let t=this.systemPrompt({userName:((i=this.plugin)==null?void 0:i.settings.userName)||"User",language:this.getLanguageCode(),date:new Date().toLocaleDateString(),time:new Date().toLocaleTimeString()});return e?e.overrideSystemPrompt?(console.warn("System prompt override enabled. Base functionality may be affected."),e.content):`${t}

## Additional Instructions

${e.content}`:t}};var ar=class{constructor(e){this.plugin=e,this.ai=new Si({apiKey:this.plugin.settings.apiKey}),this.prompts=new me(e)}generateStreamingResponse(e,t){let i=!1;return{complete:(async()=>{var f,p,h,g,v;de(this.plugin.settings.debugMode,"Generating streaming response for request",e);let s="customPrompt"in e?e.customPrompt:void 0,o=await this.prompts.getSystemPromptWithCustom(s),a=(f=e.model)!=null?f:this.plugin.settings.chatModelName,d="",c="";try{if("conversationHistory"in e){let w=[];this.plugin.settings.searchGrounding&&w.push({googleSearch:{}});let S=await this.buildGeminiChatContents(e),x=await this.ai.models.generateContentStream({model:a,config:{systemInstruction:o,tools:w,temperature:(p=e.temperature)!=null?p:this.plugin.settings.temperature,topP:(h=e.topP)!=null?h:this.plugin.settings.topP},contents:S});for await(let I of x){if(i)break;let L=I.text;if(L){let C=this._decodeHtmlEntities(L);d+=C,t(C)}}de(this.plugin.settings.debugMode,"Streaming response complete",d)}else{let w=await this.ai.models.generateContentStream({model:a,contents:e.prompt,config:{temperature:(g=e.temperature)!=null?g:this.plugin.settings.temperature,topP:(v=e.topP)!=null?v:this.plugin.settings.topP}});for await(let S of w){if(i)break;let x=S.text;if(x){let I=this._decodeHtmlEntities(x);d+=I,t(I)}}}}catch(w){throw console.error("Error during streaming:",w),w}return{markdown:d,rendered:c}})(),cancel:()=>{i=!0}}}async generateModelResponse(e){var o,a,d,c,f;de(this.plugin.settings.debugMode,"Generating model response for request",e);let t="customPrompt"in e?e.customPrompt:void 0,i=await this.prompts.getSystemPromptWithCustom(t),r=(o=e.model)!=null?o:this.plugin.settings.chatModelName,s={markdown:"",rendered:""};if("conversationHistory"in e){let p=[];this.plugin.settings.searchGrounding&&p.push({googleSearch:{}});let h=await this.buildGeminiChatContents(e),g=await this.ai.models.generateContent({model:r,config:{systemInstruction:i,tools:p,temperature:(a=e.temperature)!=null?a:this.plugin.settings.temperature,topP:(d=e.topP)!=null?d:this.plugin.settings.topP},contents:h});de(this.plugin.settings.debugMode,"Model response",g),s=this.parseModelResult(g)}else{let p=await this.ai.models.generateContent({model:r,contents:e.prompt,config:{temperature:(c=e.temperature)!=null?c:this.plugin.settings.temperature,topP:(f=e.topP)!=null?f:this.plugin.settings.topP}});s=this.parseModelResult(p)}return s}async buildGeminiChatContents(e){var a,d;let t=[];e.prompt!=null&&t.push(e.prompt);let i=this.plugin.settings.maxContextDepth,r=(a=e.renderContent)!=null?a:!0,s=await this.plugin.gfile.getCurrentFileContent(i,r);return s!=null&&t.push(s),((d=e.conversationHistory)!=null?d:[]).forEach(c=>{t.push(c.message)}),t.push(e.userMessage),de(this.plugin.settings.debugMode,"Chat contents",t),t}parseModelResult(e){var i,r,s,o,a,d,c,f,p;let t={markdown:"",rendered:""};try{let h="";if(e.text&&typeof e.text=="string")h=e.text;else if(typeof e.text=="function"){let g=e.text();typeof g=="string"&&(h=g)}h?t.markdown=this._decodeHtmlEntities(h):t.markdown="",(s=(r=(i=e.candidates)==null?void 0:i[0])==null?void 0:r.groundingMetadata)!=null&&s.searchEntryPoint?t.rendered=(o=e.candidates[0].groundingMetadata.searchEntryPoint.renderedContent)!=null?o:"":(f=(c=(d=(a=e.response)==null?void 0:a.candidates)==null?void 0:d[0])==null?void 0:c.groundingMetadata)!=null&&f.searchEntryPoint&&(t.rendered=(p=e.response.candidates[0].groundingMetadata.searchEntryPoint.renderedContent)!=null?p:"")}catch(h){console.error("Error parsing model result:",h),console.log("Result:",JSON.stringify(e))}return t}_decodeHtmlEntities(e){if(typeof document!="undefined"){let t=document.createElement("textarea");return t.innerHTML=e,t.value}return console.warn("HTML entity decoding attempted in an environment without `document`. Returning original string."),e}};var cc=require("obsidian"),On=class{constructor(e){this.plugin=e}async generateModelResponse(e){return new cc.Notice("Ollama API not yet implemented"),{markdown:"Ollama API not yet implemented. Please check back later.",rendered:""}}};var jt=require("obsidian"),ur=class{constructor(e,t){this.decoratedApi=e,this.plugin=t}async generateModelResponse(e){var s,o;let t=0,i=(s=this.plugin.settings.maxRetries)!=null?s:3,r=(o=this.plugin.settings.initialBackoffDelay)!=null?o:1e3;for(;t<i;)try{if(t>0){let d=r*2**(t-1);new jt.Notice(`Model request failed. Retrying in ${d/1e3}s... (Attempt ${t+1}/${i})`),await new Promise(c=>setTimeout(c,d))}return await this.decoratedApi.generateModelResponse(e)}catch(a){if(t++,t>=i)throw new jt.Notice(`Model request failed after ${i} attempts. Please try again later.`),a}throw new Error("Retry loop finished without success or definitive error.")}generateStreamingResponse(e,t){var d,c;if(!this.decoratedApi.generateStreamingResponse)return{complete:this.generateModelResponse(e).then(p=>(t(p.markdown),p)),cancel:()=>{}};let i=0,r=null,s=(d=this.plugin.settings.maxRetries)!=null?d:3,o=(c=this.plugin.settings.initialBackoffDelay)!=null?c:1e3,a=()=>{i++;let f="",p=v=>{f+=v,t(v)},h=this.decoratedApi.generateStreamingResponse(e,p);return{complete:h.complete.catch(async v=>{if(i<s){let w=o*2**(i-1);return new jt.Notice(`Streaming request failed. Retrying in ${w/1e3}s... (Attempt ${i+1}/${s})`),await new Promise(S=>setTimeout(S,w)),f&&new jt.Notice("Restarting stream from beginning due to partial failure"),r=a(),r.complete}else throw new jt.Notice(`Streaming request failed after ${s} attempts. Please try again later.`),v}),cancel:()=>{h.cancel()}}};return r=a(),r}};var Bn=class{static createApi(e,t){let i=t||e.settings.apiProvider||"gemini",r;switch(i){case"ollama":r=new On(e);break;case"gemini":default:r=new ar(e);break}return new ur(r,e)}};var Vn=class extends H.PluginSettingTab{constructor(t,i){super(t,i);this.showDeveloperSettings=!1;this.temperatureDebounceTimer=null;this.topPDebounceTimer=null;this.plugin=i}async updateDiscoveryStatus(t){try{let i=await this.plugin.getModelManager().getDiscoveryStatus();if(!i.enabled){t.setDesc("Model discovery is disabled");return}if(i.working){let r=i.lastUpdate?new Date(i.lastUpdate).toLocaleString():"Never";t.setDesc(`\u2713 Working - Last update: ${r}`)}else t.setDesc(`\u2717 Not working - ${i.error||"Unknown error"}`)}catch(i){t.setDesc(`Error checking status: ${i instanceof Error?i.message:"Unknown"}`)}}async checkMigrationStatus(t){try{let i=`${this.plugin.settings.historyFolder}/.migration-completed`;if(await this.app.vault.adapter.exists(i)){let s=await this.app.vault.adapter.read(i);t.setDesc(`\u2713 Migration completed. ${s.split(`
`)[1]||""}`)}else{let s=this.plugin.settings.historyFolder;if(await this.app.vault.adapter.exists(s)){let d=(await this.app.vault.adapter.list(s)).files.filter(c=>c.endsWith(".md")&&!c.includes("/History/"));d.length>0?t.setDesc(`\u26A0\uFE0F Found ${d.length} history files that will be migrated to the new folder structure on next restart.`):t.setDesc("\u2713 No migration needed - using new folder structure.")}else t.setDesc("\u2713 No migration needed - no existing history files found.")}}catch(i){t.setDesc(`Error checking migration status: ${i instanceof Error?i.message:"Unknown"}`)}}async createTemperatureSetting(t){let i=this.plugin.getModelManager(),r=await i.getParameterRanges(),s=await i.getParameterDisplayInfo(),o=s.hasModelData?`Controls randomness. Lower values are more deterministic. ${s.temperature}`:"Controls randomness. Lower values are more deterministic. (Default: 0.7)";new H.Setting(t).setName("Temperature").setDesc(o).addSlider(a=>a.setLimits(r.temperature.min,r.temperature.max,r.temperature.step).setValue(this.plugin.settings.temperature).setDynamicTooltip().onChange(async d=>{this.temperatureDebounceTimer&&clearTimeout(this.temperatureDebounceTimer),this.plugin.settings.temperature=d,this.temperatureDebounceTimer=setTimeout(async()=>{let c=await i.validateParameters(d,this.plugin.settings.topP);!c.temperature.isValid&&c.temperature.adjustedValue!==void 0&&(a.setValue(c.temperature.adjustedValue),this.plugin.settings.temperature=c.temperature.adjustedValue,c.temperature.warning&&new H.Notice(c.temperature.warning)),await this.plugin.saveSettings()},300)}))}async createTopPSetting(t){let i=this.plugin.getModelManager(),r=await i.getParameterRanges(),s=await i.getParameterDisplayInfo(),o=s.hasModelData?`Controls diversity. Lower values are more focused. ${s.topP}`:"Controls diversity. Lower values are more focused. (Default: 1)";new H.Setting(t).setName("Top P").setDesc(o).addSlider(a=>a.setLimits(r.topP.min,r.topP.max,r.topP.step).setValue(this.plugin.settings.topP).setDynamicTooltip().onChange(async d=>{this.topPDebounceTimer&&clearTimeout(this.topPDebounceTimer),this.plugin.settings.topP=d,this.topPDebounceTimer=setTimeout(async()=>{let c=await i.validateParameters(this.plugin.settings.temperature,d);!c.topP.isValid&&c.topP.adjustedValue!==void 0&&(a.setValue(c.topP.adjustedValue),this.plugin.settings.topP=c.topP.adjustedValue,c.topP.warning&&new H.Notice(c.topP.warning)),await this.plugin.saveSettings()},300)}))}async display(){let{containerEl:t}=this;if(t.empty(),new H.Setting(t).setName("Documentation").setDesc("View the complete plugin documentation and guides").addButton(i=>i.setButtonText("View Documentation").onClick(()=>{window.open("https://github.com/allenhutchison/obsidian-gemini/tree/master/docs","_blank")})),new H.Setting(t).setName("API Key").setDesc("Gemini API Key").addText(i=>{i.setPlaceholder("Enter your API Key").setValue(this.plugin.settings.apiKey).onChange(async r=>{this.plugin.settings.apiKey=r,await this.plugin.saveSettings()}),i.inputEl.style.width="40ch"}),await oi(t,this.plugin,"chatModelName","Chat Model","The Gemini Model used in the chat interface."),await oi(t,this.plugin,"summaryModelName","Summary Model","The Gemini Model used for summarization."),await oi(t,this.plugin,"completionsModelName","Completion Model","The Gemini Model used for completions."),new H.Setting(t).setName("Context Depth").setDesc("Set to true to send the context of the current file to the model, and adjust the depth of links followed for the context.").addDropdown(i=>i.addOption("0","0").addOption("1","1").addOption("2","2").addOption("3","3").addOption("4","4").setValue(this.plugin.settings.maxContextDepth.toString()).onChange(async r=>{this.plugin.settings.maxContextDepth=parseInt(r),await this.plugin.saveSettings()})).addToggle(i=>i.setValue(this.plugin.settings.sendContext).onChange(async r=>{this.plugin.settings.sendContext=r,await this.plugin.saveSettings()})),new H.Setting(t).setName("Search Grounding").setDesc("Enable the model to use Google search results in its responses.").addToggle(i=>i.setValue(this.plugin.settings.searchGrounding).onChange(async r=>{this.plugin.settings.searchGrounding=r,await this.plugin.saveSettings()})),new H.Setting(t).setName("Summary Frontmatter Key").setDesc("Key to use for frontmatter summarization.").addText(i=>i.setPlaceholder("Enter your key").setValue(this.plugin.settings.summaryFrontmatterKey).onChange(async r=>{this.plugin.settings.summaryFrontmatterKey=r,await this.plugin.saveSettings()})),new H.Setting(t).setName("Your name.").setDesc("This will be used in the system instructions for the model.").addText(i=>i.setPlaceholder("Enter your name").setValue(this.plugin.settings.userName).onChange(async r=>{this.plugin.settings.userName=r,await this.plugin.saveSettings()})),new H.Setting(t).setName("Rewrite Files").setDesc("Whether to allow the model to rewrite files during chat.").addToggle(i=>i.setValue(this.plugin.settings.rewriteFiles).onChange(async r=>{this.plugin.settings.rewriteFiles=r,await this.plugin.saveSettings()})),new H.Setting(t).setName("Plugin State Folder").setDesc("The folder where chat history and custom prompts will be stored. History files go in a History subfolder, prompts in a Prompts subfolder.").addText(i=>{let r=new ai(this.app,i.inputEl,async s=>{this.plugin.settings.historyFolder=s,await this.plugin.saveSettings()});i.setValue(this.plugin.settings.historyFolder)}),new H.Setting(t).setName("Chat History").setHeading(),new H.Setting(t).setName("Enable Chat History").setDesc("Store chat history as markdown files in your vault. History files are automatically organized in the History subfolder.").addToggle(i=>i.setValue(this.plugin.settings.chatHistory).onChange(async r=>{this.plugin.settings.chatHistory=r,await this.plugin.saveSettings()})),this.plugin.settings.chatHistory){let i=new H.Setting(t).setName("Migration Status").setDesc("Checking migration status...");this.checkMigrationStatus(i)}if(new H.Setting(t).setName("Custom Prompts").setHeading(),new H.Setting(t).setName("Enable custom prompts").setDesc("Allow notes to specify custom AI instructions via frontmatter").addToggle(i=>{var r;return i.setValue((r=this.plugin.settings.enableCustomPrompts)!=null?r:!1).onChange(async s=>{this.plugin.settings.enableCustomPrompts=s,await this.plugin.saveSettings(),s&&(await this.plugin.promptManager.ensurePromptsDirectory(),await this.plugin.promptManager.createDefaultPrompts(),this.plugin.promptManager.setupPromptCommands())})}),new H.Setting(t).setName("Allow system prompt override").setDesc("WARNING: Allows custom prompts to completely replace the system prompt. This may break expected functionality.").addToggle(i=>{var r;return i.setValue((r=this.plugin.settings.allowSystemPromptOverride)!=null?r:!1).onChange(async s=>{this.plugin.settings.allowSystemPromptOverride=s,await this.plugin.saveSettings()})}),new H.Setting(t).setName("UI Settings").setHeading(),new H.Setting(t).setName("Show Model Picker").setDesc("Show the model picker in the chat interface.").addToggle(i=>i.setValue(this.plugin.settings.showModelPicker).onChange(async r=>{this.plugin.settings.showModelPicker=r,await this.plugin.saveSettings()})),new H.Setting(t).setName("Enable Streaming").setDesc("Enable streaming responses in the chat interface for a more interactive experience.").addToggle(i=>i.setValue(this.plugin.settings.streamingEnabled).onChange(async r=>{this.plugin.settings.streamingEnabled=r,await this.plugin.saveSettings()})),new H.Setting(t).setName("Developer Settings").setHeading(),new H.Setting(t).setName("Debug Mode").setDesc("Enable debug logging to the console. Useful for troubleshooting.").addToggle(i=>i.setValue(this.plugin.settings.debugMode).onChange(async r=>{this.plugin.settings.debugMode=r,await this.plugin.saveSettings()})),new H.Setting(t).setName("Show Developer Settings").setDesc("Reveal advanced settings for developers and power users.").addButton(i=>i.setButtonText(this.showDeveloperSettings?"Hide Advanced Settings":"Show Advanced Settings").setClass(this.showDeveloperSettings?"mod-warning":"mod-cta").onClick(()=>{this.showDeveloperSettings=!this.showDeveloperSettings,this.display()})),this.showDeveloperSettings&&(new H.Setting(t).setName("API Provider").setDesc("Select which AI provider to use").addDropdown(i=>i.addOption("gemini","Google Gemini (New SDK)").setValue(this.plugin.settings.apiProvider).onChange(async r=>{this.plugin.settings.apiProvider=r,await this.plugin.saveSettings()})),new H.Setting(t).setName("Maximum Retries").setDesc("Maximum number of retries when a model request fails.").addText(i=>i.setPlaceholder("e.g., 3").setValue(this.plugin.settings.maxRetries.toString()).onChange(async r=>{this.plugin.settings.maxRetries=parseInt(r),await this.plugin.saveSettings()})),new H.Setting(t).setName("Initial Backoff Delay (ms)").setDesc("Initial delay in milliseconds before the first retry. Subsequent retries will use exponential backoff.").addText(i=>i.setPlaceholder("e.g., 1000").setValue(this.plugin.settings.initialBackoffDelay.toString()).onChange(async r=>{this.plugin.settings.initialBackoffDelay=parseInt(r),await this.plugin.saveSettings()})),await this.createTemperatureSetting(t),await this.createTopPSetting(t),new H.Setting(t).setName("Model Discovery").setHeading(),new H.Setting(t).setName("Enable dynamic model discovery").setDesc("Automatically discover and update available Gemini models from Google's API").addToggle(i=>i.setValue(this.plugin.settings.modelDiscovery.enabled).onChange(async r=>{this.plugin.settings.modelDiscovery.enabled=r,await this.plugin.saveSettings(),this.display()})),this.plugin.settings.modelDiscovery.enabled)){new H.Setting(t).setName("Auto-update interval (hours)").setDesc("How often to check for new models (0 to disable auto-update)").addSlider(r=>r.setLimits(0,168,1).setValue(this.plugin.settings.modelDiscovery.autoUpdateInterval).setDynamicTooltip().onChange(async s=>{this.plugin.settings.modelDiscovery.autoUpdateInterval=s,await this.plugin.saveSettings()})),new H.Setting(t).setName("Fallback to static models").setDesc("Use built-in model list when API discovery fails").addToggle(r=>r.setValue(this.plugin.settings.modelDiscovery.fallbackToStatic).onChange(async s=>{this.plugin.settings.modelDiscovery.fallbackToStatic=s,await this.plugin.saveSettings()}));let i=new H.Setting(t).setName("Discovery status").setDesc("Current status of model discovery");i.addButton(r=>r.setButtonText("Refresh models").setTooltip("Manually refresh the model list from Google API").onClick(async()=>{r.setButtonText("Refreshing..."),r.setDisabled(!0);try{let s=await this.plugin.getModelManager().refreshModels();if(s.success){r.setButtonText("\u2713 Refreshed");let o=`Found ${s.modelsFound} models${s.changes?" (changes detected)":""}`;i.setDesc(`Last refresh: ${new Date().toLocaleTimeString()} - ${o}`)}else r.setButtonText("\u2717 Failed"),i.setDesc(`Refresh failed: ${s.error||"Unknown error"}`)}catch(s){r.setButtonText("\u2717 Error"),i.setDesc(`Error: ${s instanceof Error?s.message:"Unknown error"}`)}setTimeout(()=>{r.setButtonText("Refresh models"),r.setDisabled(!1)},2e3)})),this.updateDiscoveryStatus(i)}}};var oe=require("obsidian");var lr=class{constructor(e){this.plugin=e,this.prompts=new me(e)}async generateRewriteResponse(e,t){let i=this.prompts.rewritePrompt({userMessage:e});await this.plugin.history.appendHistory({role:"user",message:e});let r={prompt:i,conversationHistory:t,userMessage:e},s=await this.plugin.geminiApi.generateModelResponse(r);await this.plugin.gfile.replaceTextInActiveFile(s.markdown)}};Ct();var Gn="gemini-view",cr=class extends oe.ItemView{constructor(t,i){super(t);this.timerInterval=null;this.startTime=null;this.settingsUnsubscribe=null;this.currentStreamingResponse=null;this.scrollTimeout=null;this.plugin=i,this.rewriteMode=new lr(i),this.prompts=new me(i),this.registerLinkClickHandler(),this.registerSettingsListener(),this.fileOpenHandler=this.handleFileOpen.bind(this)}registerSettingsListener(){let t=this.plugin.saveSettings.bind(this.plugin);this.plugin.saveSettings=async()=>{await t(),await this._rebuildUIDueToSettingsChange()},this.settingsUnsubscribe=()=>{this.plugin.saveSettings=t}}async _rebuildUIDueToSettingsChange(){if(!this.contentEl){de(this.plugin.settings.debugMode,"GeminiView: contentEl not available for UI rebuild on settings change.",null);return}de(this.plugin.settings.debugMode,"GeminiView: Rebuilding UI due to settings change.",null),this._buildViewDOM(this.contentEl);let t=this.plugin.gfile.getActiveFile();t?await this.handleFileOpen(t):this.chatbox&&this.clearChat()}_buildViewDOM(t){t.empty(),t.createEl("h2",{text:"Gemini Chat"}),this.promptIndicator=t.createDiv({cls:"gemini-scribe-prompt-indicator"}),this.promptIndicator.style.display="none",this.chatbox=t.createDiv({cls:"gemini-scribe-chatbox"});let i=t.createDiv({cls:"gemini-scribe-input-area"}),r=i.createEl("textarea",{cls:"gemini-scribe-chat-input",attr:{placeholder:"Type your message here..."}}),s=i.createDiv({cls:"gemini-scribe-send-container"}),o=s.createEl("button",{text:"Send",cls:"gemini-scribe-send-button"});if((0,oe.setIcon)(o,"send-horizontal"),this.timerDisplay=s.createDiv({cls:"gemini-scribe-timer"}),this.plugin.settings.rewriteFiles){let a=t.createDiv({cls:"gemini-scribe-options-area"}),d=a.createEl("input",{type:"checkbox",cls:"gemini-scribe-rewrite-checkbox"});a.createEl("label",{text:"Rewrite file",cls:"gemini-scribe-rewrite-label"}).prepend(d),d.addEventListener("change",()=>{this.shoudRewriteFile=d.checked})}if(this.plugin.settings.showModelPicker){let a=t.createDiv({cls:"gemini-scribe-model-picker-area"});this.modelPicker=a.createEl("select",{cls:"gemini-scribe-model-picker"}),ke.forEach(d=>{this.modelPicker.createEl("option",{value:d.value,text:d.label})}),this.modelPicker.value=this.plugin.settings.chatModelName,this.modelPicker.addEventListener("change",async()=>{this.plugin.settings.chatModelName=this.modelPicker.value,await this.plugin.saveSettings()})}else this.modelPicker=null;r.addEventListener("keydown",async a=>{a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),o.click())}),o.addEventListener("click",async()=>{let a=r.value;if(a.trim()!==""){this.displayMessage(a,"user"),r.value="",this.startTimer();try{await this.sendMessage(a)}catch(d){console.error("Error during sendMessage call from button click:",d),new oe.Notice("An unexpected error occurred while sending the message.")}finally{this.stopTimer()}}}),this.observer&&this.observer.disconnect(),this.observer=new MutationObserver(a=>{for(let d of a)d.type==="childList"&&this.scrollToBottom()}),this.observer.observe(this.chatbox,{childList:!0,subtree:!0})}registerLinkClickHandler(){this.containerEl.addEventListener("click",t=>{let i=t.target;if(i.tagName==="A"&&i.classList.contains("internal-link")){t.preventDefault();let r=i.getAttribute("href");r&&this.app.workspace.openLinkText(r,"",!0)}})}getViewType(){return Gn}getDisplayText(){return"Gemini Scribe"}getIcon(){return"sparkles"}async onOpen(){this._buildViewDOM(this.contentEl),this.registerEvent(this.app.workspace.on("file-open",this.fileOpenHandler));let t=this.plugin.gfile.getActiveFile();t&&await this.handleFileOpen(t)}async onClose(){this.app.workspace.off("file-open",this.fileOpenHandler),this.observer&&(this.observer.disconnect(),this.observer=null),this.settingsUnsubscribe&&(this.settingsUnsubscribe(),this.settingsUnsubscribe=null),this.scrollTimeout&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=null)}async updatePromptIndicator(){if(!this.currentFile||!this.plugin.settings.enableCustomPrompts){this.promptIndicator.style.display="none";return}let t=await this.plugin.promptManager.getPromptFromNote(this.currentFile);t?(this.promptIndicator.setText(`Using prompt: ${t.name}`),this.promptIndicator.style.display="block"):this.promptIndicator.style.display="none"}async refreshPromptIndicator(){await this.updatePromptIndicator()}async forceRefreshPromptIndicator(){if(!this.currentFile||!this.plugin.settings.enableCustomPrompts){this.promptIndicator.style.display="none";return}let t=i=>{i===this.currentFile&&(this.app.metadataCache.off("changed",t),this.updatePromptIndicator())};this.app.metadataCache.on("changed",t),setTimeout(async()=>{this.app.metadataCache.off("changed",t),await this.updatePromptIndicator()},200)}async displayMessage(t,i,r,s=!0){var d,c;let o,a;if(r)o=r,a=o.querySelector(".gemini-scribe-message");else{o=this.chatbox.createDiv({cls:`gemini-scribe-message-container ${i}`});let f=o.createDiv({cls:"gemini-scribe-sender-indicator"});switch(a=o.createDiv({cls:`gemini-scribe-message ${i}`}),i){case"user":(0,oe.setIcon)(f,"square-user");break;case"model":(0,oe.setIcon)(f,"bot-message-square");break;case"grounding":(0,oe.setIcon)(f,"search");break}}if(i==="grounding")a.innerHTML=t;else{let f=(c=(d=this.plugin.gfile.getActiveFile())==null?void 0:d.path)!=null?c:"";await oe.MarkdownRenderer.render(this.app,t,a,f,this)}if(i==="model"&&!r){let f=a.createEl("button",{cls:"gemini-scribe-copy-button"});(0,oe.setIcon)(f,"copy"),f.addEventListener("click",()=>{let p=a.innerText||t;navigator.clipboard.writeText(p).then(()=>{new oe.Notice("Message copied to clipboard.")}).catch(h=>{new oe.Notice("Could not copy message to clipboard. Try selecting and copying manually.")})})}return s&&this.scrollToBottom(),o}async updateStreamingMessage(t,i){let r=t.querySelector(".gemini-scribe-message");if(r){let s=document.createTextNode(i);r.appendChild(s)}}async finalizeStreamingMessage(t,i){var s,o;let r=t.querySelector(".gemini-scribe-message");if(r){r.empty();let a=(o=(s=this.plugin.gfile.getActiveFile())==null?void 0:s.path)!=null?o:"";await oe.MarkdownRenderer.render(this.app,i,r,a,this);let d=r.createEl("button",{cls:"gemini-scribe-copy-button"});(0,oe.setIcon)(d,"copy"),d.addEventListener("click",()=>{let c=r.innerText||i;navigator.clipboard.writeText(c).then(()=>{new oe.Notice("Message copied to clipboard.")}).catch(f=>{new oe.Notice("Could not copy message to clipboard. Try selecting and copying manually.")})})}}async handleFileOpen(t){if(!t)return;let i=await this.plugin.app.vault.read(t);this.currentFile=t,await this.updatePromptIndicator();let r=await this.plugin.history.getHistoryForFile(t);this.updateChat(r)}async updateChat(t){var i;this.clearChat();for(let r of t)r.role==="model"&&((i=r.metadata)!=null&&i.rendered)?(this.displayMessage(r.message,"model"),this.displayMessage(r.metadata.rendered,"grounding")):this.displayMessage(r.message,r.role)}clearChat(){this.chatbox&&this.chatbox.empty()}async sendMessage(t){var i,r,s;if(t.trim()!==""){if(this.shoudRewriteFile){let o=(i=await this.plugin.history.getHistoryForFile(this.currentFile))!=null?i:[];await this.rewriteMode.generateRewriteResponse(t,o);return}try{let o=(r=await this.plugin.history.getHistoryForFile(this.currentFile))!=null?r:[],a=this.prompts.generalPrompt({userMessage:t}),d;this.plugin.settings.enableCustomPrompts&&this.currentFile&&(d=await this.plugin.promptManager.getPromptFromNote(this.currentFile)||void 0);let c={userMessage:t,conversationHistory:o,model:this.plugin.settings.chatModelName,prompt:a,renderContent:!0,customPrompt:d};if(de(this.plugin.settings.debugMode,"Sending message",c),this.plugin.geminiApi.generateStreamingResponse&&this.plugin.settings.streamingEnabled!==!1){let f=null,p="",h=this.plugin.geminiApi.generateStreamingResponse(c,g=>{p+=g,f?(this.updateStreamingMessage(f,g),this.debouncedScrollToBottom()):this.displayMessage("","model").then(v=>{f=v,this.updateStreamingMessage(v,g)})});this.currentStreamingResponse=h;try{let g=await h.complete;if(this.currentStreamingResponse=null,f&&await this.finalizeStreamingMessage(f,g.markdown),this.plugin.settings.chatHistory){await this.plugin.history.appendHistoryForFile(this.currentFile,{role:"user",message:t});let v;this.plugin.settings.enableCustomPrompts&&this.currentFile&&(v=await this.plugin.promptManager.getPromptHistoryInfo(this.currentFile)),await this.plugin.history.appendHistoryForFile(this.currentFile,{role:"model",message:g.markdown,userMessage:t,model:this.plugin.settings.chatModelName,metadata:{...v?{customPrompt:v}:{},temperature:this.plugin.settings.temperature,topP:this.plugin.settings.topP}})}g.rendered&&await this.displayMessage(g.rendered,"grounding"),this.scrollToBottom()}catch(g){throw this.currentStreamingResponse=null,g}}else{let f=await this.plugin.geminiApi.generateModelResponse(c);if(this.plugin.settings.chatHistory){await this.plugin.history.appendHistoryForFile(this.currentFile,{role:"user",message:t});let p;this.plugin.settings.enableCustomPrompts&&this.currentFile&&(p=await this.plugin.promptManager.getPromptHistoryInfo(this.currentFile)),await this.plugin.history.appendHistoryForFile(this.currentFile,{role:"model",message:f.markdown,userMessage:t,model:this.plugin.settings.chatModelName,metadata:{...p?{customPrompt:p}:{},temperature:this.plugin.settings.temperature,topP:this.plugin.settings.topP}}),this.clearChat(),await this.updateChat((s=await this.plugin.history.getHistoryForFile(this.currentFile))!=null?s:[]),f.rendered&&this.displayMessage(f.rendered,"grounding")}else this.displayMessage(f.markdown,"model"),f.rendered&&this.displayMessage(f.rendered,"grounding")}}catch(o){new oe.Notice("Error getting bot response.")}}}scrollToBottom(){let t=()=>{let i=this.containerEl.querySelector(".gemini-scribe-input-area");i&&i.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})};t(),setTimeout(t,50),setTimeout(t,150)}debouncedScrollToBottom(){this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.scrollToBottom(),this.scrollTimeout=null},50)}startTimer(){this.timerDisplay.style.display="block",this.startTime=Date.now(),this.timerDisplay.textContent="0.0s",this.timerInterval=setInterval(()=>{if(this.startTime){let t=(Date.now()-this.startTime)/1e3;this.timerDisplay.textContent=`${t.toFixed(1)}s`}},100)}stopTimer(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null),setTimeout(()=>{this.timerDisplay&&(this.timerDisplay.style.display="none")},2e3)}};var dr=class{constructor(e){this.plugin=e,this.prompts=new me(e)}async summarizeActiveFile(){let e=await this.plugin.gfile.getCurrentFileContent(0,!0);if(e){let t={model:this.plugin.settings.summaryModelName,prompt:this.prompts.summaryPrompt({content:e})},i=await this.plugin.geminiApi.generateModelResponse(t);this.plugin.gfile.addToFrontMatter(this.plugin.settings.summaryFrontmatterKey,i.markdown)}else console.error("Failed to get file content for summary.")}async setupSummarizaitonCommand(){this.plugin.addCommand({id:"gemini-scribe-summarize-active-file",name:"Summarize Active File",callback:()=>this.summarizeActiveFile()})}};var $d=require("obsidian");var Wd=Yr(qd()),Nr=class{constructor(e,t){this.scribeFile=e,this.dataViewAPI=this.getDataViewAPI(),this.plugin=t}getDataViewAPI(){let e=(0,Wd.getAPI)();return e||null}async getBacklinks(e){return await this.evaluateDataviewQuery("list where contains(file.outlinks, this.file.link)",e)}async getLinksFromDataviewBlocks(e){let t=new Set,i=[];return await this.iterateCodeblocksInFile(e,s=>{s.language==="dataview"&&i.push(this.evaluateDataviewQuery(s.text,e))}),(await Promise.all(i)).forEach(s=>{s.forEach(o=>t.add(o))}),t}async evaluateDataviewQuery(e,t){let i=new Set;try{let r=await this.dataViewAPI.query(e,t.path);if(!(r!=null&&r.value))return console.warn(`Invalid query result for "${e}" in file "${t.path}"`),i;let s=o=>{if(this.isFileLink(o)){let a=this.scribeFile.normalizePath(o.path,t);a?i.add(a):console.warn(`Link "${o}" in file "${t.path}" could not be normalized.`)}};if(r.value.type==="list")for(let o of r.value.values)s(o);else if(r.value.type==="table")for(let o of r.value.values)for(let a of o)s(a)}catch(r){console.error(`Error evaluating dataview query "${e}" in file "${t.path}":`,r)}return i}isFileLink(e){return e&&typeof e=="object"&&typeof e.path=="string"?!(e.subpath||e.path.includes("#")||e.path.includes("^")):!1}async iterateCodeblocksInFile(e,t){let r=(await this.plugin.app.vault.read(e)).split(`
`),s=null;for(let o=0;o<r.length;o++){let a=r[o];if(a.startsWith("```"))if(s)t(s),s=null;else{let d=a.substring(3).trim();s={start:o,end:-1,text:"",language:d}}else s&&(s.text+=a+`
`)}s&&(s.end=r.length-1,t(s))}};var Rr=class{constructor(e,t){this.root=null;this.visited=new Set;this.MAX_TOTAL_CHARS=5e5;this.plugin=e,this.plugin.settings.sendContext?this.maxDepth=t!=null?t:this.plugin.settings.maxContextDepth:this.maxDepth=0,this.fileHelper=new dn(e),this.dataViewHelper=new Nr(this.fileHelper,this.plugin),this.prompts=new me(e)}async buildStructure(e,t=0,i,r,s){if(!e||t>this.maxDepth||r.has(e.path)||e.path.startsWith(this.plugin.settings.historyFolder+"/"))return null;r.add(e.path);let o=this.fileHelper.getLinkText(e,s.path),a={path:e.path,content:await this.getFileContent(e,i),wikilink:o,links:new Map},d=this.fileHelper.getUniqueLinks(e),c=await this.dataViewHelper.getBacklinks(e)||new Set,f=await this.dataViewHelper.getLinksFromDataviewBlocks(e)||new Set,p=d;c.forEach(h=>p.add(h)),f.forEach(h=>p.add(h));for(let h of p){let g=await this.buildStructure(h,t+1,i,r,s);g&&a.links.set(h.path,g)}return a}async initialize(e,t){this.visited.clear(),this.root=await this.buildStructure(e,0,t,this.visited,e)}toString(e=5e4){return this.root?this.nodeToString(this.root,0,e,0).text:"No file structure built"}nodeToString(e,t,i,r){let s=e.content.length>i?e.content.substring(0,i)+`
[Remaining content truncated...]`:e.content,o=t==0?`This is the content of the current file and the files that it links to:
`:"",a=t==0?"Current File":"Linked File";o+=this.prompts.contextPrompt({file_label:a,file_name:e.path,wikilink:e.wikilink,file_contents:s});let d=r+o.length;if(e.links.size>0&&d<this.MAX_TOTAL_CHARS)for(let[c,f]of e.links){if(d>=this.MAX_TOTAL_CHARS){o+=`[Additional links truncated...]
`;break}let p=this.nodeToString(f,t+1,i,d);o+=p.text,d=p.total}return{text:o,total:d}}async getFileContent(e,t){let i=await this.plugin.app.vault.read(e)||"";if(t){let r=document.createElement("div");return await $d.MarkdownRenderer.render(this.plugin.app,i,r,e.path,this.plugin),r.innerHTML}else return i}};var zd=require("obsidian");var dn=class{constructor(e){this.plugin=e}async getCurrentFileContent(e=this.plugin.settings.maxContextDepth,t=!1){if(!this.plugin.settings.sendContext)return null;let i=this.getActiveFile();if(i){let r=new Rr(this.plugin,e);return await r.initialize(i,t),r.toString()}else return null}async addToFrontMatter(e,t){let i=this.getActiveFile();i&&this.plugin.app.fileManager.processFrontMatter(i,r=>{r[e]=t})}async replaceTextInActiveFile(e){let t=this.getActiveFile(),i=this.plugin.app.vault;t&&i.modify(t,e)}getActiveFile(){let e=this.plugin.app.workspace.getActiveFile();return this.isFile(e)?e:(de(this.plugin.settings.debugMode,"File System","No active file found."),null)}isFile(e){return!!(e&&e instanceof zd.TFile)}isMarkdownFile(e){return!!(e&&this.isFile(e)&&e.extension==="md")}getLinkText(e,t){return`[[${this.plugin.app.metadataCache.fileToLinktext(e,t,!0)}]]`}normalizePath(e,t){let i=this.plugin.app.metadataCache.getFirstLinkpathDest(e,t.path);return this.isMarkdownFile(i)?i:null}normalizeLinkPathsFromMetadata(e){let t=this.plugin.app.metadataCache.getFileCache(e),i=[],r=[],s=[];if(t){if(t.links)for(let o of t.links){let a=this.normalizePath(o.link,e);a?i.push(a):de(this.plugin.settings.debugMode,"Link Normalization Warning",`Link "${o.link}" in file "${e.path}" could not be normalized.`)}if(t.embeds)for(let o of t.embeds){let a=this.normalizePath(o.link,e);a?r.push(a):de(this.plugin.settings.debugMode,"Link Normalization Warning",`Embed "${o.link}" in file "${e.path}" could not be normalized.`)}if(t.frontmatterLinks)for(let o of t.frontmatterLinks){let a=this.normalizePath(o.link,e);a?s.push(a):de(this.plugin.settings.debugMode,"Link Normalization Warning",`Frontmatter link "${o.link}" in file "${e.path}" could not be normalized.`)}if(t.frontmatter&&t.frontmatter.links){if(Array.isArray(t.frontmatter.links))t.frontmatter.links.forEach(o=>{let a=this.normalizePath.call(this,o);a?s.push(a):de(this.plugin.settings.debugMode,"Link Normalization Warning",`Frontmatter link "${o}" in file "${e.path}" could not be normalized.`)});else if(typeof t.frontmatter.links=="string"){let o=this.normalizePath.call(this,t.frontmatter.links);o?s.push(o):de(this.plugin.settings.debugMode,"Link Normalization Warning",`Frontmatter link "${t.frontmatter.links}" in file "${e.path}" could not be normalized.`)}}}return{links:i,embeds:r,frontmatterLinks:s}}getUniqueLinks(e){let{links:t,embeds:i,frontmatterLinks:r}=this.normalizeLinkPathsFromMetadata(e);return new Set([...t,...i,...r])}};var Nt=require("obsidian");var Y=require("obsidian"),Xn=Yr(lo());var Yd=`{{#if isFirstEntry}}
# Chat History
*Started: {{timestamp}}*
*Plugin Version: {{pluginVersion}}*

---

{{/if}}
## {{role}}

> [!metadata]- Message Info
> | Property | Value |
> | -------- | ----- |
> | Time | {{timestamp}} |
> | File Version | {{fileVersion}} |
{{#if model}}
> | Model | {{model}} |
{{#if (isDefined temperature)}}
> | Temperature | {{temperature}} |
{{/if}}
{{#if (isDefined topP)}}
> | Top P | {{topP}} |
{{/if}}
{{/if}}
{{#if customPrompt}}
> | Custom Prompt | {{customPrompt}} |
{{/if}}
{{#if context}}
> | Context | {{context}} |
{{/if}}

{{#if (eq role "User")}}
> [!user]+
{{else}}
> [!assistant]+
{{/if}}
{{#each messageLines}}
> {{this}}
{{/each}}

--- `;var Lr=class{constructor(e){this.plugin=e,Xn.registerHelper("eq",function(t,i){return t===i}),Xn.registerHelper("isDefined",function(t){return t!==void 0}),this.entryTemplate=Xn.compile(Yd)}async migrateAllLegacyFiles(){if(!this.plugin.settings.chatHistory)return;let e=this.plugin.settings.historyFolder,t=(0,Y.normalizePath)(`${e}/History`);try{let i=(0,Y.normalizePath)(`${e}/.migration-completed`);if(await this.plugin.app.vault.adapter.exists(i))return;await this.plugin.app.vault.createFolder(e).catch(()=>{}),await this.plugin.app.vault.createFolder(t).catch(()=>{});let o=(await this.plugin.app.vault.adapter.list(e)).files.filter(d=>d.endsWith(".md")&&!d.includes("/History/")&&!d.endsWith("/.migration-completed")),a=0;for(let d of o){let c=this.plugin.app.vault.getAbstractFileByPath(d);if(c instanceof Y.TFile)try{let f=c.name,p=(0,Y.normalizePath)(`${t}/${f}`);await this.plugin.app.vault.adapter.exists(p)?await this.plugin.app.vault.delete(c):(await this.plugin.app.vault.rename(c,p),a++)}catch(f){console.error(`Failed to migrate history file ${d}:`,f)}}await this.plugin.app.vault.adapter.write(i,`Migration completed at ${new Date().toISOString()}
Migrated ${a} files`),a>0&&console.log(`Migrated ${a} chat history files to new folder structure`)}catch(i){console.error("Error during history migration:",i)}}getHistoryFilePath(e){let t=this.plugin.settings.historyFolder,i=e.replace(/\.md$/,""),r=!i.includes("/")&&!i.includes("\\"),s=i.replace(/[\\/]/g,"_");return r&&(s=`root_${s}`),(0,Y.normalizePath)(`${t}/History/${s}.md`)}async appendHistoryForFile(e,t){if(!this.plugin.gfile.isFile(e)||!this.plugin.settings.chatHistory)return;let i=this.getHistoryFilePath(e.path),r={notePath:e.path,created_at:new Date,role:t.role,message:t.message,model:t.model,metadata:t.metadata};try{await this.plugin.app.vault.createFolder(this.plugin.settings.historyFolder).catch(()=>{}),await this.plugin.app.vault.createFolder((0,Y.normalizePath)(`${this.plugin.settings.historyFolder}/History`)).catch(()=>{});let s=this.plugin.app.vault.getAbstractFileByPath(i);if(s&&s instanceof Y.TFile){let o=await this.plugin.app.vault.read(s);o=o.replace(/\n---\s*$/,""),await this.plugin.app.vault.modify(s,o+`

`+this.formatEntryAsMarkdown(r))}else{let o="";if(t.role==="model"&&t.userMessage){let d={notePath:e.path,created_at:new Date(r.created_at.getTime()-1e3),role:"user",message:t.userMessage};o=this.formatEntryAsMarkdown(d,!0)+`

`+this.formatEntryAsMarkdown(r)}else o=this.formatEntryAsMarkdown(r,!0);let a=await this.plugin.app.vault.create(i,o);await this.plugin.app.fileManager.processFrontMatter(a,d=>{d.source_file=this.plugin.gfile.getLinkText(e,e.path)})}}catch(s){console.error("Failed to append history",s),new Y.Notice("Failed to save chat history")}}async getHistoryForFile(e){if(!this.plugin.gfile.isFile(e))return[];if(!this.plugin.settings.chatHistory)return[];let t=this.getHistoryFilePath(e.path),i=t,r=null,s=null;try{let o=this.plugin.app.vault.getAbstractFileByPath(t);if(o instanceof Y.TFile)r=await this.plugin.app.vault.read(o);else if(s=await this.findLegacyHistoryFile(e),s){console.log(`Found legacy history file for ${e.path}: ${s.path}`),i=s.path,r=await this.plugin.app.vault.read(s);try{await this.migrateLegacyHistoryFile(s,e)}catch(a){console.error(`[History] Failed to migrate legacy history file ${s==null?void 0:s.path} during load:`,a),new Y.Notice(`Error updating history file format for ${e.basename}. History may load from old format.`)}}return r!==null?this.parseHistoryFile(r,e.path):[]}catch(o){return console.error(`Failed to read history for ${e.path} (checked path: ${i}):`,o),[]}}async clearHistoryForFile(e){if(!this.plugin.gfile.isFile(e))return;let t=this.getHistoryFilePath(e.path);try{let i=this.plugin.app.vault.getAbstractFileByPath(t);if(i instanceof Y.TFile)return await this.plugin.app.vault.delete(i),1;let r=await this.findLegacyHistoryFile(e);return r?(await this.plugin.app.vault.delete(r),console.log(`Cleared legacy history file: ${r.path}`),1):0}catch(i){if(i.message.includes("does not exist")){try{let r=await this.findLegacyHistoryFile(e);if(r)return await this.plugin.app.vault.delete(r),console.log(`Cleared legacy history file after initial miss: ${r.path}`),1}catch(r){console.error("Error checking/deleting legacy history during clear error handling:",r)}return 0}console.error("Failed to clear history for file:",t,i),new Y.Notice(`Failed to clear history for ${e.basename}`);return}}async findLegacyHistoryFile(e){let t=this.plugin.settings.historyFolder;try{let r=(await this.plugin.app.vault.adapter.list(t)).files.filter(s=>s.endsWith(".md")&&(0,Y.normalizePath)(s)!==this.getHistoryFilePath(e.path));for(let s of r){let o=this.plugin.app.vault.getAbstractFileByPath(s);if(o instanceof Y.TFile){let a=this.plugin.app.metadataCache.getFileCache(o),d=a==null?void 0:a.frontmatter;if(d&&d.source_file){let f=d.source_file.match(/\[\[([^|#\]]+)/),p=f?f[1].trim().replace(/\.md$/,""):null,h=e.basename.replace(/\.md$/,"");if(p&&p===h)return o}}}}catch(i){i.message.includes("no such file or directory")||console.error(`Error searching for legacy history files in ${t}:`,i)}return null}async migrateLegacyHistoryFile(e,t){let i=this.getHistoryFilePath(t.path);console.log(`Attempting migration for legacy file ${e.path} to ${i}`);try{if(await this.plugin.app.vault.createFolder(this.plugin.settings.historyFolder).catch(()=>{}),await this.plugin.app.vault.createFolder((0,Y.normalizePath)(`${this.plugin.settings.historyFolder}/History`)).catch(()=>{}),await this.plugin.app.vault.adapter.exists(i)){console.warn(`Migration target ${i} already exists. Deleting original legacy file ${e.path}.`),await this.plugin.app.vault.delete(e).catch(o=>{console.error(`Failed to delete original legacy file ${e.path} when target existed:`,o)});return}await this.plugin.app.vault.rename(e,i),console.log(`Successfully renamed ${e.path} to ${i}`);let s=this.plugin.app.vault.getAbstractFileByPath(i);if(!(s instanceof Y.TFile)){console.error(`Failed to get TFile for newly renamed history file: ${i}. Cannot update frontmatter.`);return}await this.plugin.app.fileManager.processFrontMatter(s,o=>{o.source_file=this.plugin.gfile.getLinkText(t,t.path)}),console.log(`Successfully updated frontmatter for ${i}`)}catch(r){if(r.message.includes("already exists"))console.warn(`Rename failed, target ${i} already exists (race condition?). Attempting to delete original legacy file ${e.path}.`),await this.plugin.app.vault.delete(e).catch(s=>{console.error(`Failed to delete original legacy file ${e.path} after rename error:`,s)});else if(r.message.includes("does not exist"))console.warn(`Cannot migrate legacy history file, source no longer exists: ${e.path}`);else throw console.error(`Error during migration of ${e.path} to ${i}:`,r),r}}async clearHistory(){if(!this.plugin.settings.chatHistory)return;let e=this.plugin.settings.historyFolder,t=(0,Y.normalizePath)(`${e}/History`);try{await this.plugin.app.vault.adapter.exists(t)&&await this.plugin.app.vault.adapter.rmdir(t,!0),await this.plugin.app.vault.createFolder(e).catch(()=>{}),await this.plugin.app.vault.createFolder(t).catch(()=>{}),new Y.Notice("Chat history cleared.")}catch(i){console.error("Failed to clear all history",i),new Y.Notice("Failed to clear chat history")}}formatEntryAsMarkdown(e,t=!1){var d,c,f,p;let i=e.created_at.toISOString(),r=e.role.charAt(0).toUpperCase()+e.role.slice(1),s=e.message.split(`
`),o=this.plugin.app.vault.getAbstractFileByPath(e.notePath),a="unknown";return o instanceof Y.TFile?a=o.stat.mtime.toString(16).slice(0,8):console.warn(`Could not find TFile for path ${e.notePath} when formatting history entry.`),this.entryTemplate({isFirstEntry:t,role:r,timestamp:i,model:e.model,messageLines:s,pluginVersion:this.plugin.manifest.version,fileVersion:a,temperature:(d=e.metadata)==null?void 0:d.temperature,topP:(c=e.metadata)==null?void 0:c.topP,customPrompt:(f=e.metadata)==null?void 0:f.customPrompt,context:(p=e.metadata)==null?void 0:p.context})}async parseHistoryFile(e,t){var c;let i=[],r=this.getHistoryFilePath(t),s=this.plugin.app.vault.getAbstractFileByPath(r),o=t;if(s instanceof Y.TFile){let f=(c=this.plugin.app.metadataCache.getFileCache(s))==null?void 0:c.frontmatter;if(f&&f.source_file){let p=this.plugin.app.metadataCache.getFirstLinkpathDest(f.source_file,s.path);p instanceof Y.TFile&&(o=p.path)}}else console.warn(`Could not find history file TFile object for path: ${r}`);let d=e.replace(/^---\n[\s\S]*?\n---\n/,"").trim().split(/\n\n(?=## )/);for(let f of d){if(!f.trim())continue;let p=f.match(/^## (User|Model)/m);if(p){let h=p[1].toLowerCase(),g=f.match(/\|\s*Time\s*\|\s*(.*?)\s*\|/m),v=f.match(/\|\s*Model\s*\|\s*(.*?)\s*\|/m),w=f.match(/\|\s*Temperature\s*\|\s*(.*?)\s*\|/m),S=f.match(/\|\s*Top P\s*\|\s*(.*?)\s*\|/m),x=f.match(/\|\s*Custom Prompt\s*\|\s*(.*?)\s*\|/m),I=g?new Date(g[1].trim()):new Date,L=f.match(/>\s*\[!(user|assistant)\]\+\n([\s\S]*?)(?=\n\s*---|\n\s*$)/m);if(L){let C=L[2].split(`
`).map(P=>P.startsWith("> ")?P.slice(2):P).join(`
`).trim();if(C){let P={};x&&(P.customPrompt=x[1].trim()),w&&(P.temperature=parseFloat(w[1].trim())),S&&(P.topP=parseFloat(S[1].trim())),i.push({notePath:o,created_at:I,role:h,message:C,model:v?v[1].trim():void 0,metadata:Object.keys(P).length>0?P:void 0})}}}}return i}async renameHistoryFile(e,t){let i=this.getHistoryFilePath(t),r=this.getHistoryFilePath(e.path);try{let s=this.plugin.app.vault.getAbstractFileByPath(i);s instanceof Y.TFile?(await this.plugin.app.fileManager.processFrontMatter(s,o=>{o.source_file=this.plugin.gfile.getLinkText(e,e.path)}),await this.plugin.app.vault.rename(s,r)):(console.log("Could not find history file TFile to rename:",i),await this.plugin.app.vault.adapter.exists(i)||console.log(`Adapter confirms ${i} does not exist.`))}catch(s){s.message.includes("already exists")?(console.warn(`Cannot rename history file, target already exists: ${r}`),new Y.Notice(`History file for ${e.basename} might be duplicated.`)):s.message.includes("does not exist")?console.warn(`Cannot rename history file, source does not exist: ${i}`):(console.error("Failed to rename history file:",{from:i,to:r},s),new Y.Notice(`Failed to update history for renamed file ${e.basename}`))}}async deleteHistoryFile(e){let t=this.getHistoryFilePath(e);try{let i=this.plugin.app.vault.getAbstractFileByPath(t);i instanceof Y.TFile?await this.plugin.app.vault.delete(i):await this.plugin.app.vault.adapter.exists(t)&&(await this.plugin.app.vault.adapter.remove(t),console.log(`Removed history file via adapter: ${t}`))}catch(i){i.message.includes("does not exist")||console.error("Failed to delete history file:",t,i)}}};var Or=class{constructor(e){this.plugin=e,this.markdownHistory=new Lr(e)}async setupHistoryCommands(){if(this.plugin.settings.chatHistory)try{this.plugin.addCommand({id:"gemini-scribe-clear-conversations",name:"Clear All Chat History",callback:async()=>{await this.clearHistory()}})}catch(e){console.error("Failed to add commands",e)}}async onLayoutReady(){await this.setupHistory(),await this.markdownHistory.migrateAllLegacyFiles()}async setupHistory(){this.plugin.app.vault.on("rename",this.renameHistoryFile.bind(this)),this.plugin.app.vault.on("delete",this.handleFileDelete.bind(this))}async onUnload(){this.plugin.app.vault.off("rename",this.renameHistoryFile.bind(this)),this.plugin.app.vault.off("delete",this.handleFileDelete.bind(this))}async renameHistoryFile(e,t){let i=this.plugin.settings.historyFolder,r=(0,Nt.normalizePath)(e.path),s=(0,Nt.normalizePath)(t),o=(0,Nt.normalizePath)(i+"/");r.startsWith(o)||s.startsWith(o)||e instanceof Nt.TFile&&await this.markdownHistory.renameHistoryFile(e,t)}async handleFileDelete(e){e instanceof Nt.TFile&&await this.markdownHistory.deleteHistoryFile(e.path)}async appendHistoryForFile(e,t){await this.markdownHistory.appendHistoryForFile(e,t)}async getHistoryForFile(e){return await this.markdownHistory.getHistoryForFile(e)}async clearHistoryForFile(e){return await this.markdownHistory.clearHistoryForFile(e)}async appendHistory(e){let t=this.plugin.app.workspace.getActiveFile();t&&await this.appendHistoryForFile(t,e)}async clearHistory(){await this.markdownHistory.clearHistory()}};var pn=require("obsidian");var Be=require("@codemirror/view"),at=require("@codemirror/state");function Kd(n,e,t=void 0){let i={force:()=>{}},r=null;async function*s(...o){r&&clearTimeout(r);let a=null;try{await new Promise(d=>{a=r=setTimeout(()=>d(),e),i.force=()=>{r&&clearTimeout(r),d()}})}catch(d){if(t!==void 0)throw t}for await(let d of n(...o)){if(a!==r)break;yield d}}return{debounced:s,force:()=>i.force()}}var AC=Object.defineProperty,NC=(n,e,t)=>e in n?AC(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,fn=(n,e,t)=>(NC(n,typeof e!="symbol"?e+"":e,t),t),Br=at.StateField.define({create(){return{suggestion:null}},update(n,e){let t=e.effects.find(i=>i.is(Qo));return e.state.doc&&t&&(t.value.doc==null||e.state.doc==t.value.doc)?{suggestion:t.value.suggestion}:{suggestion:null}}}),Qo=at.StateEffect.define();function RC(n,e){let t=n.state.selection.main.head,i=[],r=Be.Decoration.widget({widget:new Yo(e),side:1});return i.push(r.range(t)),Be.Decoration.set(i)}var Yo=class extends Be.WidgetType{constructor(e){super(),fn(this,"suggestion"),this.suggestion=e}toDOM(){let e=document.createElement("span");return e.style.opacity="0.4",e.className="cm-inline-suggestion",e.textContent=this.suggestion,e}},Ko=n=>{let e=0;return Be.ViewPlugin.fromClass(class{async update(t){let i=t.state.doc;if(!t.docChanged)return;let r=++e;for await(let s of n(t.state)){if(r!=e)return;t.view.dispatch({effects:Qo.of({suggestion:s,doc:i})})}}})},Jo=class{constructor(){fn(this,"decorations"),this.decorations=Be.Decoration.none}update(e){var t;let i=(t=e.state.field(Br))==null?void 0:t.suggestion;if(!i){this.decorations=Be.Decoration.none;return}this.decorations=RC(e.view,i.display_suggestion)}},Jd=Be.ViewPlugin.fromClass(Jo,{decorations:n=>n.decorations}),Zo=class{constructor(e,t){fn(this,"suggestFn"),fn(this,"keymap"),fn(this,"completionId"),fn(this,"run",i=>{var r,s;let o=(r=i.state.field(Br))==null?void 0:r.suggestion;return o?(i.dispatch({...LC(i.state,o.complete_suggestion,i.state.selection.main.head,i.state.selection.main.head)}),(s=o.accept_hook)==null||s.call(o),(async()=>{if(this.suggestFn==null)return;let a=++this.completionId;for await(let d of this.suggestFn(i.state)){if(a!=this.completionId)return;i.dispatch({effects:Qo.of({suggestion:{complete_suggestion:d.complete_suggestion,display_suggestion:d.display_suggestion,accept_hook:d.accept_hook},doc:null})})}})(),!0):!1}),this.suggestFn=e,this.keymap=at.Prec.highest(Be.keymap.of([{key:t,run:i=>this.run(i)}])),this.completionId=0}};function LC(n,e,t,i){return{...n.changeByRange(r=>{if(r==n.selection.main)return{changes:{from:t,to:i,insert:e},range:at.EditorSelection.cursor(t+e.length)};let s=i-t;return!r.empty||s&&n.sliceDoc(r.from-s,r.from)!=n.sliceDoc(t,i)?{range:r}:{changes:{from:r.from-s,to:r.from,insert:e},range:at.EditorSelection.cursor(r.from-s+e.length)}}),userEvent:"input.complete"}}function Zd(n){return typeof n=="string"?{complete_suggestion:n,display_suggestion:n}:n}function OC(n){return async function*(e){let t=await n(e);if(typeof t=="string"||"complete_suggestion"in t){yield Zd(t);return}for await(let i of t)yield Zd(i)}}function Xo(n){let{delay:e=500,accept_shortcut:t="Tab"}=n,i=OC(n.fetchFn),{debounced:r,force:s}=Kd(i,e);return{extension:t?[Br,Ko(r),Jd,new Zo(n.continue_suggesting?i:null,t).keymap]:[Br,Ko(r),Jd],force_fetch:s}}var Vr=class{constructor(e){this.force_fetch=()=>{};this.TYPING_DELAY=750;this.completionsOn=!1;this.plugin=e,this.prompts=new me(e),this.debouncedComplete=(0,pn.debounce)(()=>this.force_fetch(),this.TYPING_DELAY,!0)}async*complete(){if(!this.completionsOn)return;let e=this.plugin.app.workspace.getActiveViewOfType(pn.MarkdownView);if(!e)return;let t=e.editor,i=t.getCursor(),s=t.getLine(i.line).substring(0,i.ch),o=s.length>0&&!s.endsWith(" "),a=t.getRange({line:0,ch:0},i),d=t.getRange(i,{line:t.lastLine(),ch:t.getLine(t.lastLine()).length}),c=await this.generateNextSentence(a,d),f=o?" "+c:c;yield{display_suggestion:f,complete_suggestion:f}}async generateNextSentence(e,t){let i={model:this.plugin.settings.completionsModelName,prompt:this.prompts.completionsPrompt({contentBeforeCursor:e,contentAfterCursor:t})};return(await this.plugin.geminiApi.generateModelResponse(i)).markdown.replace(/\n$/,"")}async setupCompletions(){let{extension:e,force_fetch:t}=Xo({fetchFn:()=>this.complete()});this.force_fetch=t,this.plugin.registerEditorExtension(e)}async setupCompletionsCommands(){try{this.plugin.addCommand({id:"gemini-scribe-toggle-completions",name:"Toggle completions",callback:()=>{this.completionsOn=!this.completionsOn,new pn.Notice(`Gemini Scribe Completions are now ${this.completionsOn?"enabled":"disabled"}.`),this.completionsOn&&this.force_fetch()}})}catch(e){console.error("Error setting up completion commands:",e)}}};var Xd=require("obsidian");Ct();Ct();var Gr=class{constructor(e){this.cache=null;this.CACHE_DURATION=24*60*60*1e3;this.API_BASE="https://generativelanguage.googleapis.com/v1beta";this.plugin=e}async discoverModels(e=!1){if(!e&&this.cache&&this.isCacheValid())return this.cache;try{let i={models:await this.fetchModelsFromAPI(),lastUpdated:Date.now(),success:!0};return this.cache=i,await this.persistCache(i),i}catch(t){let i={models:[],lastUpdated:Date.now(),success:!1,error:t instanceof Error?t.message:"Unknown error"};return this.cache||i}}async fetchModelsFromAPI(){let e=this.plugin.settings.apiKey;if(!e)throw new Error("API key not configured");let t=[],i;do{let d=new URL(`${this.API_BASE}/models`);d.searchParams.set("key",e),i&&d.searchParams.set("pageToken",i),d.searchParams.set("pageSize","50");let c=await fetch(d.toString());if(!c.ok)throw new Error(`API request failed: ${c.status} ${c.statusText}`);let f=await c.json();t=t.concat(f.models||[]),i=f.nextPageToken}while(i);let r=t.filter(d=>this.isGenerativeModel(d)),s=await Promise.allSettled(r.map(d=>this.fetchModelDetails(d,e))),o=s.filter(d=>d.status==="fulfilled"&&d.value!==null).map(d=>d.value),a=s.length-o.length;return a>0&&console.warn(`Failed to fetch detailed information for ${a} models`),o}async fetchModelDetails(e,t){try{let i=new URL(`${this.API_BASE}/${e.name}`);i.searchParams.set("key",t);let r=await fetch(i.toString());if(!r.ok)return console.warn(`Failed to fetch details for model ${e.name}: ${r.status}`),e;let s=await r.json();return{...e,maxTemperature:s==null?void 0:s.maxTemperature,topP:s==null?void 0:s.topP,topK:s==null?void 0:s.topK}}catch(i){return console.warn(`Error fetching model details for ${e.name}:`,i),e}}isGenerativeModel(e){var t;return((t=e.supportedGenerationMethods)==null?void 0:t.includes("generateContent"))&&e.name.includes("gemini")&&!e.name.includes("vision")}isCacheValid(){return!!(this.cache&&Date.now()-this.cache.lastUpdated<this.CACHE_DURATION)}async persistCache(e){let t=await this.plugin.loadData()||{};t.modelDiscoveryCache=e,await this.plugin.saveData(t)}async loadCache(){let e=await this.plugin.loadData()||{};this.cache=e.modelDiscoveryCache||null}clearCache(){this.cache=null}getCacheInfo(){var e;return{hasCache:!!this.cache,isValid:this.isCacheValid(),lastUpdated:(e=this.cache)==null?void 0:e.lastUpdated}}};var hn=class{static mapToGeminiModels(e){let t=e.map(i=>({value:this.extractModelId(i.name),label:this.generateLabel(i),defaultForRoles:this.inferDefaultRoles(i)}));return this.deduplicateModels(t)}static extractModelId(e){return e.replace(/^models\//,"")}static generateLabel(e){return e.displayName?e.displayName:this.extractModelId(e.name).split("-").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" ")}static inferDefaultRoles(e){let t=this.extractModelId(e.name).toLowerCase(),i=[];return t.includes("pro")?i.push("chat"):t.includes("flash")?i.push("summary"):t.includes("lite")&&i.push("completions"),(t.includes("experimental")||t.includes("thinking"))&&(i.includes("chat")||i.push("chat")),i.length===0&&i.push("chat"),i}static mergeWithExistingModels(e,t){let i=new Map(t.map(o=>[o.value,o])),r=this.getCurrentDefaultModels(t),s=e.map(o=>{let a=i.get(o.value);return a?{...o,defaultForRoles:a.defaultForRoles,label:this.shouldUpdateLabel(a.label,o.label)?o.label:a.label}:o});return this.ensureRoleDefaults(s,r)}static getCurrentDefaultModels(e){let t={};for(let i of["chat","summary","completions"]){let r=e.find(s=>{var o;return(o=s.defaultForRoles)==null?void 0:o.includes(i)});r&&(t[i]=r.value)}return t}static ensureRoleDefaults(e,t){var r;let i=new Map(e.map(s=>[s.value,s]));for(let s of["chat","summary","completions"]){let o=t[s];if(!e.some(d=>{var c;return(c=d.defaultForRoles)==null?void 0:c.includes(s)}))if(o&&i.has(o)){let d=i.get(o);d.defaultForRoles=[...d.defaultForRoles||[],s]}else{let d=this.findBestModelForRole(e,s);d&&!((r=d.defaultForRoles)!=null&&r.includes(s))&&(d.defaultForRoles=[...d.defaultForRoles||[],s])}}return e}static findBestModelForRole(e,t){let i=this.sortModelsByPreference(e);for(let r of i){let s=r.value.toLowerCase();switch(t){case"chat":if(s.includes("pro"))return r;break;case"summary":if(s.includes("flash"))return r;break;case"completions":if(s.includes("lite")||s.includes("flash"))return r;break}}return i[0]}static shouldUpdateLabel(e,t){let i=o=>o.toLowerCase().replace(/[^a-z0-9]/g,""),r=i(e),s=i(t);return r!==s}static filterModels(e,t={}){return e.filter(i=>!(t.excludeExperimental&&i.value.includes("experimental")||t.minNameLength&&i.value.length<t.minNameLength))}static deduplicateModels(e){let t=new Map;for(let i of e){let r=t.get(i.value);r?this.shouldPreferModel(i,r)&&t.set(i.value,i):t.set(i.value,i)}return Array.from(t.values())}static shouldPreferModel(e,t){let i=!e.label.includes("-"),r=!t.label.includes("-");if(i!==r)return i;if(e.label.length!==t.label.length)return e.label.length<t.label.length;let s=e.value.match(/\d{2}-\d{2}$/),o=t.value.match(/\d{2}-\d{2}$/);return s&&o?s[0]>o[0]:!1}static sortModelsByPreference(e){return[...e].sort((t,i)=>{let r=w=>{let S=w.match(/gemini-(\d+(?:\.\d+)?)/i);return S?parseFloat(S[1]):0},s=r(t.value),o=r(i.value);if(s!==o)return o-s;let a=w=>w.includes("pro")?3:w.includes("flash")?2:w.includes("lite")?1:0,d=a(t.value),c=a(i.value);if(d!==c)return c-d;let f=w=>{let S=w.match(/(\d{2})-(\d{2})$/);if(S){let x=parseInt(S[1]),I=parseInt(S[2]);return x*100+I}return 0},p=f(t.value),h=f(i.value);if(p>0&&h>0)return h-p;if(p>0&&h===0)return-1;if(h>0&&p===0)return 1;let g=!t.value.includes("experimental")&&!t.value.includes("preview"),v=!i.value.includes("experimental")&&!i.value.includes("preview");return g!==v?g?-1:1:t.value.localeCompare(i.value)})}};var Qe=class{static getParameterRanges(e){if(!e||e.length===0)return this.DEFAULT_RANGES;let t=e.map(r=>r.maxTemperature).filter(r=>r!=null),i=t.length>0?t.reduce((r,s)=>Math.max(r,s),0):this.DEFAULT_RANGES.temperature.max;return{temperature:{min:0,max:Math.max(i,1),step:.1},topP:{min:0,max:1,step:.01}}}static getModelParameterInfo(e){return e.map(t=>({modelName:t.name,maxTemperature:t.maxTemperature,topP:t.topP,topK:t.topK}))}static validateTemperature(e,t,i=[]){if(t){let s=i.find(o=>o.name===t||o.displayName===t);if((s==null?void 0:s.maxTemperature)!==void 0&&e>s.maxTemperature)return{isValid:!1,adjustedValue:s.maxTemperature,warning:`Temperature ${e} exceeds ${t} limit of ${s.maxTemperature}. Adjusted to ${s.maxTemperature}.`}}let r=this.getParameterRanges(i);if(e<r.temperature.min||e>r.temperature.max){let s=Math.max(r.temperature.min,Math.min(r.temperature.max,e));return{isValid:!1,adjustedValue:s,warning:`Temperature ${e} is outside valid range [${r.temperature.min}, ${r.temperature.max}]. Adjusted to ${s}.`}}return{isValid:!0}}static validateTopP(e,t,i=[]){let r=this.getParameterRanges(i);if(e<r.topP.min||e>r.topP.max){let s=Math.max(r.topP.min,Math.min(r.topP.max,e));return{isValid:!1,adjustedValue:s,warning:`Top P ${e} is outside valid range [${r.topP.min}, ${r.topP.max}]. Adjusted to ${s}.`}}return{isValid:!0}}static getParameterDisplayInfo(e){let t=this.getParameterRanges(e),i=e&&e.length>0,r=e.map(a=>a.topP).filter(a=>a!=null),s=[...new Set(r)].sort((a,d)=>a-d),o=s.length>0?`Range: ${t.topP.min} to ${t.topP.max} (model defaults: ${s.join(", ")})`:`Range: ${t.topP.min} to ${t.topP.max}`;return{temperature:`Range: ${t.temperature.min} to ${t.temperature.max}`,topP:o,hasModelData:i}}};Qe.DEFAULT_RANGES={temperature:{min:0,max:2,step:.1},topP:{min:0,max:1,step:.01}};var Rt=class Rt{constructor(e){this.plugin=e,this.discoveryService=new Gr(e)}async getAvailableModels(e={}){var t;if(!((t=this.plugin.settings.modelDiscovery)!=null&&t.enabled))return Rt.staticModels;try{let i=await this.discoveryService.discoverModels(e.forceRefresh);if(i.success&&i.models.length>0){let r=hn.mapToGeminiModels(i.models);return r=hn.sortModelsByPreference(r),e.preserveUserCustomizations&&(r=hn.mergeWithExistingModels(r,Rt.staticModels)),r}}catch(i){console.warn("Model discovery failed, falling back to static models:",i)}return Rt.staticModels}async updateModels(e={}){let t=await this.getAvailableModels(e),i=this.getCurrentGeminiModels();return this.detectModelChanges(t,i)?(this.updateGlobalModelsList(t),En(this.plugin.settings)):{updatedSettings:this.plugin.settings,settingsChanged:!1,changedSettingsInfo:[]}}getCurrentGeminiModels(){return(Ct(),Kr(Jr)).GEMINI_MODELS||[]}updateGlobalModelsList(e){let t=(Ct(),Kr(Jr));t.setGeminiModels&&t.setGeminiModels(e)}detectModelChanges(e,t){if(e.length!==t.length)return!0;let i=new Set(e.map(s=>s.value)),r=new Set(t.map(s=>s.value));return!this.areSetsEqual(i,r)}areSetsEqual(e,t){return e.size===t.size&&[...e].every(i=>t.has(i))}async initialize(){await this.discoveryService.loadCache()}getDiscoveryService(){return this.discoveryService}static getStaticModels(){return[...Rt.staticModels]}async getDiscoveryStatus(){var t;if(!(((t=this.plugin.settings.modelDiscovery)==null?void 0:t.enabled)||!1))return{enabled:!1,working:!1};try{let i=await this.discoveryService.discoverModels(!1);return{enabled:!0,working:i.success,lastUpdate:i.lastUpdated,error:i.error}}catch(i){return{enabled:!0,working:!1,error:i instanceof Error?i.message:"Unknown error"}}}async refreshModels(){try{let e=await this.updateModels({forceRefresh:!0,preserveUserCustomizations:!0});return{success:!0,modelsFound:(await this.getAvailableModels({forceRefresh:!0})).length,changes:e.settingsChanged}}catch(e){return{success:!1,modelsFound:0,changes:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getParameterRanges(){var e;if(!((e=this.plugin.settings.modelDiscovery)!=null&&e.enabled))return Qe.getParameterRanges([]);try{let t=await this.discoveryService.discoverModels(!1),i=t.success?t.models:[];return Qe.getParameterRanges(i)}catch(t){return console.warn("Failed to get parameter ranges from discovered models:",t),Qe.getParameterRanges([])}}async getDiscoveredModels(){var e;if(!((e=this.plugin.settings.modelDiscovery)!=null&&e.enabled))return[];try{let t=await this.discoveryService.discoverModels(!1);return t.success?t.models:[]}catch(t){return console.warn("Failed to get discovered models:",t),[]}}async validateParameters(e,t,i){let r=await this.getDiscoveredModels();return{temperature:Qe.validateTemperature(e,i,r),topP:Qe.validateTopP(t,i,r)}}async getParameterDisplayInfo(){let e=await this.getDiscoveredModels();return Qe.getParameterDisplayInfo(e)}};Rt.staticModels=[{value:"gemini-2.5-pro-preview-06-05",label:"Gemini 2.5 Pro",defaultForRoles:["chat"]},{value:"gemini-2.5-flash-preview-05-20",label:"Gemini 2.5 Flash",defaultForRoles:["summary"]},{value:"gemini-2.0-flash-lite",label:"Gemini 2.0 Flash Lite",defaultForRoles:["completions"]}];var Ur=Rt;var U=require("obsidian"),Hr=class{constructor(e,t){this.plugin=e;this.vault=t}getPromptsDirectory(){return(0,U.normalizePath)(`${this.plugin.settings.historyFolder}/Prompts`)}async ensurePromptsDirectory(){await this.vault.createFolder(this.plugin.settings.historyFolder).catch(()=>{});let e=this.getPromptsDirectory(),t=this.vault.getAbstractFileByPath(e);(!t||!(t instanceof U.TFolder))&&await this.vault.createFolder(e)}async loadPromptFromFile(e){try{let t=this.vault.getAbstractFileByPath(e);if(!(t instanceof U.TFile))return null;let i=this.plugin.app.metadataCache.getFileCache(t),r=(i==null?void 0:i.frontmatter)||{},s="";if(i!=null&&i.sections){let d=(await this.vault.read(t)).split(`
`);for(let c of i.sections){if(c.type==="yaml")continue;let f=c.position.start.line,p=c.position.end.line;for(let h=f;h<=p&&h<d.length;h++)s+=d[h]+`
`}}else{let a=await this.vault.read(t);s=this.extractContentWithoutFrontmatter(a)}let o=Array.isArray(r.tags)?r.tags:[];return{name:r.name||"Unnamed Prompt",description:r.description||"",version:r.version||1,overrideSystemPrompt:r.override_system_prompt||!1,tags:o,content:s.trim()}}catch(t){return console.error("Error loading prompt file:",t),null}}extractContentWithoutFrontmatter(e){let t=/^---\n([\s\S]*?)\n---\n([\s\S]*)$/,i=e.match(t);return i?i[2]:e}async getPromptFromNote(e){var o;let t=this.plugin.app.metadataCache.getFileCache(e),i=(o=t==null?void 0:t.frontmatter)==null?void 0:o["gemini-scribe-prompt"];if(!i)return null;let r=this.extractPathFromWikilink(i);if(!r)return null;let s=this.plugin.app.metadataCache.getFirstLinkpathDest(r,e.path);return!s||!(s instanceof U.TFile)?null:await this.loadPromptFromFile(s.path)}async getPromptHistoryInfo(e){var a;let t=this.plugin.app.metadataCache.getFileCache(e),i=(a=t==null?void 0:t.frontmatter)==null?void 0:a["gemini-scribe-prompt"];if(!i)return null;let r=this.extractPathFromWikilink(i);if(!r)return null;let s=this.plugin.app.metadataCache.getFirstLinkpathDest(r,e.path);if(!s||!(s instanceof U.TFile))return null;let o=await this.loadPromptFromFile(s.path);return o?`[[${s.basename}\\|${o.name}]]`:null}extractPathFromWikilink(e){let t=e;return t.startsWith("[[")&&t.endsWith("]]")&&(t=t.slice(2,-2)),t.split("|")[0].split("#")[0].split("^")[0].trim()||null}async listAvailablePrompts(){let e=this.getPromptsDirectory();if(!(this.vault.getAbstractFileByPath(e)instanceof U.TFolder))return[];let i=[],r=this.vault.getMarkdownFiles().filter(s=>s.path.startsWith(e));for(let s of r){let o=await this.loadPromptFromFile(s.path);o&&i.push({path:s.path,name:o.name,description:o.description,tags:o.tags})}return i}async createDefaultPrompts(){let e=this.getPromptsDirectory(),t=(0,U.normalizePath)(`${e}/example-expert.md`);if(this.vault.getAbstractFileByPath(t))return;await this.vault.create(t,`---
name: "Subject Matter Expert"
description: "A knowledgeable expert who provides detailed, accurate information"
version: 1
override_system_prompt: false
tags: ["general", "expert"]
---

You are a subject matter expert with comprehensive knowledge across multiple domains. When answering questions:

- Provide accurate, well-researched information
- Cite relevant sources when possible
- Explain complex concepts clearly
- Acknowledge limitations in your knowledge
- Offer multiple perspectives when appropriate

Focus on being helpful while maintaining intellectual honesty.`)}setupPromptCommands(){this.plugin.settings.enableCustomPrompts&&(this.plugin.addCommand({id:"gemini-scribe-apply-custom-prompt",name:"Apply Custom Prompt to Current Note",callback:()=>this.applyCustomPromptToCurrentNote()}),this.plugin.addCommand({id:"gemini-scribe-remove-custom-prompt",name:"Remove Custom Prompt from Current Note",callback:()=>this.removeCustomPromptFromCurrentNote()}),this.plugin.addCommand({id:"gemini-scribe-create-custom-prompt",name:"Create New Custom Prompt",callback:()=>this.createNewCustomPrompt()}))}async applyCustomPromptToCurrentNote(){try{if(!this.plugin.settings.enableCustomPrompts){new U.Notice("Custom prompts are disabled. Enable them in plugin settings.");return}let e=this.plugin.gfile.getActiveFile();if(!e){new U.Notice("No active file to apply prompt to");return}if(!this.plugin.gfile.isMarkdownFile(e)){new U.Notice("Custom prompts can only be applied to markdown files");return}let t=await this.listAvailablePrompts();if(t.length===0){new U.Notice("No custom prompts found. Create prompts in the Prompts folder first.");return}this.showPromptSelectionModal(e,t)}catch(e){console.error("Error applying custom prompt:",e),new U.Notice("Failed to apply custom prompt")}}showPromptSelectionModal(e,t){new jo(this.plugin.app,this,e,t).open()}async applyPromptToFile(e,t){try{let r=`[[${this.extractPromptNameFromPath(t.path)}]]`;await this.plugin.app.fileManager.processFrontMatter(e,s=>{s["gemini-scribe-prompt"]=r}),new U.Notice(`Applied custom prompt: ${t.name}`),this.plugin.geminiView&&await this.plugin.geminiView.forceRefreshPromptIndicator()}catch(i){console.error("Error applying prompt to file:",i),new U.Notice("Failed to apply custom prompt to note")}}async removeCustomPromptFromCurrentNote(){var e;try{if(!this.plugin.settings.enableCustomPrompts){new U.Notice("Custom prompts are disabled. Enable them in plugin settings.");return}let t=this.plugin.gfile.getActiveFile();if(!t){new U.Notice("No active file to remove prompt from");return}if(!this.plugin.gfile.isMarkdownFile(t)){new U.Notice("Custom prompts can only be removed from markdown files");return}let i=this.plugin.app.metadataCache.getFileCache(t);if(!((e=i==null?void 0:i.frontmatter)==null?void 0:e["gemini-scribe-prompt"])){new U.Notice("No custom prompt is applied to this note");return}await this.plugin.app.fileManager.processFrontMatter(t,s=>{delete s["gemini-scribe-prompt"]}),new U.Notice("Removed custom prompt from note"),this.plugin.geminiView&&await this.plugin.geminiView.forceRefreshPromptIndicator()}catch(t){console.error("Error removing custom prompt:",t),new U.Notice("Failed to remove custom prompt from note")}}extractPromptNameFromPath(e){let t=this.vault.getAbstractFileByPath(e);return t instanceof U.TFile?t.basename:(e.split("/").pop()||"").replace(".md","")}async createNewCustomPrompt(){try{if(!this.plugin.settings.enableCustomPrompts){new U.Notice("Custom prompts are disabled. Enable them in plugin settings.");return}await this.ensurePromptsDirectory(),new ea(this.plugin.app,async t=>{if(!t||t.trim()===""){new U.Notice("Prompt name cannot be empty");return}let i=t.trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-");if(!i){new U.Notice("Invalid prompt name. Please use alphanumeric characters, spaces, hyphens, or underscores.");return}let r=this.getPromptsDirectory(),s=`${i.toLowerCase()}.md`,o=(0,U.normalizePath)(`${r}/${s}`);if(this.vault.getAbstractFileByPath(o)){new U.Notice(`A prompt file named "${s}" already exists.`);return}let d=`---
name: "${t}"
description: "Brief description of what this prompt does"
version: 1
override_system_prompt: false
tags: ["category", "type"]
---

# Instructions for the AI

Your custom prompt content goes here. This will modify how the AI behaves when applied to notes.

## Tips:
- Be specific about the desired behavior
- Include examples if helpful
- Consider the context this will be used in

## Example Usage:
This prompt will be applied to notes and will supplement the default system prompt unless override_system_prompt is set to true.`;try{let c=await this.vault.create(o,d);await this.plugin.app.workspace.openLinkText(c.path,"",!0),new U.Notice(`Created new custom prompt: ${t}`)}catch(c){console.error("Error creating prompt file:",c),new U.Notice("Failed to create prompt file")}}).open()}catch(e){console.error("Error creating new custom prompt:",e),new U.Notice("Failed to create new custom prompt")}}},jo=class extends U.SuggestModal{constructor(t,i,r,s){super(t);this.promptManager=i;this.targetFile=r;this.prompts=s;this.setPlaceholder("Select a custom prompt to apply...")}getSuggestions(t){let i=t.toLowerCase();return t?this.prompts.filter(r=>r.name.toLowerCase().includes(i)||r.description.toLowerCase().includes(i)||r.tags.some(s=>s.toLowerCase().includes(i))):this.prompts}renderSuggestion(t,i){let r=i.createDiv({cls:"suggestion-content"});r.createDiv({text:t.name,cls:"suggestion-title"}),t.description&&r.createDiv({text:t.description,cls:"suggestion-note"}),t.tags.length>0&&r.createDiv({cls:"suggestion-aux"}).setText(`Tags: ${t.tags.join(", ")}`)}onChooseSuggestion(t,i){setTimeout(async()=>{try{await this.promptManager.applyPromptToFile(this.targetFile,t)}catch(r){console.error("Error applying prompt:",r),new U.Notice("Failed to apply custom prompt")}},0)}},ea=class extends U.Modal{constructor(e,t){super(e),this.onSubmit=t}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:"Create New Custom Prompt"});let t=e.createDiv({cls:"prompt-input-container"});t.createEl("label",{text:"Prompt Name:"}),this.inputEl=t.createEl("input",{type:"text",placeholder:"Enter a name for your custom prompt..."}),this.inputEl.style.width="100%",this.inputEl.style.marginTop="8px",this.inputEl.style.padding="8px",this.inputEl.style.border="1px solid var(--background-modifier-border)",this.inputEl.style.borderRadius="4px",this.inputEl.addEventListener("keydown",o=>{o.key==="Enter"?(o.preventDefault(),this.submit()):o.key==="Escape"&&this.close()});let i=e.createDiv({cls:"prompt-button-container"});i.style.marginTop="16px",i.style.display="flex",i.style.gap="8px",i.style.justifyContent="flex-end";let r=i.createEl("button",{text:"Cancel"});r.style.padding="8px 16px",r.addEventListener("click",()=>this.close());let s=i.createEl("button",{text:"Create"});s.style.padding="8px 16px",s.style.backgroundColor="var(--interactive-accent)",s.style.color="var(--text-on-accent)",s.style.border="none",s.style.borderRadius="4px",s.addEventListener("click",()=>this.submit()),setTimeout(()=>this.inputEl.focus(),100)}submit(){let e=this.inputEl.value.trim();e&&(this.close(),this.onSubmit(e))}onClose(){let{contentEl:e}=this;e.empty()}};var BC={apiKey:"",apiProvider:"gemini",chatModelName:ut("chat"),summaryModelName:ut("summary"),completionsModelName:ut("completions"),sendContext:!1,maxContextDepth:2,searchGrounding:!1,summaryFrontmatterKey:"summary",userName:"User",rewriteFiles:!1,chatHistory:!1,historyFolder:"gemini-scribe",showModelPicker:!1,debugMode:!1,maxRetries:3,initialBackoffDelay:1e3,streamingEnabled:!0,modelDiscovery:{enabled:!1,autoUpdateInterval:24,lastUpdate:0,fallbackToStatic:!0},enableCustomPrompts:!1,allowSystemPromptOverride:!1,temperature:.7,topP:1},qr=class extends Qd.Plugin{async onload(){await this.setupGeminiScribe(),this.ribbonIcon=this.addRibbonIcon("sparkles","Open Gemini Chat",()=>{this.activateView()}),this.registerView(Gn,e=>this.geminiView=new cr(e,this)),this.addCommand({id:"gemini-scribe-open-view",name:"Open Gemini Chat",callback:()=>this.activateView()}),this.addSettingTab(new Vn(this.app,this)),this.app.workspace.onLayoutReady(()=>this.onLayoutReady())}async setupGeminiScribe(){await this.loadSettings(),this.prompts=new me(this),this.promptManager=new Hr(this,this.app.vault),this.geminiApi=Bn.createApi(this),this.gfile=new dn(this),this.modelManager=new Ur(this),await this.modelManager.initialize(),this.settings.modelDiscovery.enabled&&this.updateModelsIfNeeded(),this.history=new Or(this),await this.history.setupHistoryCommands(),this.app.workspace.layoutReady&&await this.history.onLayoutReady,this.completions=new Vr(this),await this.completions.setupCompletions(),await this.completions.setupCompletionsCommands(),this.summarizer=new dr(this),await this.summarizer.setupSummarizaitonCommand()}async activateView(){let{workspace:e}=this.app,t=null,i=e.getLeavesOfType(Gn);i.length>0?(t=i[0],await e.revealLeaf(t)):(t=e.getLeftLeaf(!1),t?(await t.setViewState({type:Gn,active:!0}),await e.revealLeaf(t)):console.error("Could not find a leaf to open the view"))}async onLayoutReady(){this.settings.enableCustomPrompts&&this.promptManager&&(await this.promptManager.ensurePromptsDirectory(),await this.promptManager.createDefaultPrompts(),this.promptManager.setupPromptCommands()),await this.history.onLayoutReady()}async loadSettings(){var e;this.settings=Object.assign({},BC,await this.loadData()),(e=this.settings.modelDiscovery)!=null&&e.enabled||await this.updateModelVersions()}async updateModelVersions(){let{updatedSettings:e,settingsChanged:t,changedSettingsInfo:i}=En(this.settings);t&&(this.settings=e,console.log("ObsidianGemini: Updating model versions in settings..."),i.forEach(r=>console.log(`- ${r}`)),await this.saveData(this.settings),new Xd.Notice("Gemini model settings updated to current defaults."))}async saveSettings(){await this.saveData(this.settings),await this.setupGeminiScribe(),this.settings.modelDiscovery.enabled&&this.modelManager&&this.updateModelsIfNeeded()}async updateModelsIfNeeded(){if(!this.settings.modelDiscovery.enabled||!this.modelManager)return;let e=Date.now(),t=this.settings.modelDiscovery.lastUpdate,i=this.settings.modelDiscovery.autoUpdateInterval*60*60*1e3;if(e-t>i)try{let r=await this.modelManager.updateModels({preserveUserCustomizations:!0});r.settingsChanged&&(this.settings=r.updatedSettings,await this.saveData(this.settings),r.changedSettingsInfo.length>0&&console.log("Model settings updated:",r.changedSettingsInfo.join(", "))),this.settings.modelDiscovery.lastUpdate=e,await this.saveData(this.settings)}catch(r){console.warn("Failed to update models during auto-update:",r)}}getModelManager(){return this.modelManager}onunload(){var e,t;console.debug("Unloading Gemini Scribe"),(e=this.history)==null||e.onUnload(),(t=this.ribbonIcon)==null||t.remove()}};
/*! Bundled license information:

@google/genai/dist/web/index.mjs:
  (**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   *)

@google/genai/dist/web/index.mjs:
  (**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   *)

@google/genai/dist/web/index.mjs:
  (**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   *)

@google/genai/dist/web/index.mjs:
  (**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   *)
*/


/* nosourcemap */